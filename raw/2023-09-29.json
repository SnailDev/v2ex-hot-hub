[{"node": {"avatar_large": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1692078075", "name": "programmer", "avatar_normal": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1692078075", "title": "程序员", "url": "https://www.v2ex.com/go/programmer", "topics": 59190, "footer": "", "header": "While code monkeys are not eating bananas, they're coding.", "title_alternative": "Programmer", "avatar_mini": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1692078075", "stars": 8645, "aliases": [], "root": false, "id": 300, "parent_node_name": "computer"}, "member": {"id": 275011, "username": "ivslyyy", "url": "https://www.v2ex.com/u/ivslyyy", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/a3a459ce8353e3d350ff2f75813ad95e?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/a3a459ce8353e3d350ff2f75813ad95e?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/a3a459ce8353e3d350ff2f75813ad95e?s=73&d=retro", "created": 1513450049, "last_modified": 1513450049}, "last_reply_by": "ivslyyy", "last_touched": 1695952054, "title": "倒贴钱上班写代码还有前途吗？ 30 多岁了", "url": "https://www.v2ex.com/t/977938", "created": 1695883719, "deleted": 0, "content": "倒贴钱上班写代码还有前途吗？ 30 多岁了\r\n找不到工作\r\n现在倒贴钱上班\r\n工作内容其实没有硬性安排\r\n就是有时候教刚毕业的小孩子写代码，调试 bug\r\n\r\n自己长期在 QQ 群免费教新手\r\n免费给群友解决问题代写部分功能，修复 bug\r\n所以不觉得免费写代码是非常不好的事情。", "content_rendered": "<p>倒贴钱上班写代码还有前途吗？ 30 多岁了\n找不到工作\n现在倒贴钱上班\n工作内容其实没有硬性安排\n就是有时候教刚毕业的小孩子写代码，调试 bug</p>\n<p>自己长期在 QQ 群免费教新手\n免费给群友解决问题代写部分功能，修复 bug\n所以不觉得免费写代码是非常不好的事情。</p>\n", "last_modified": 1695883719, "replies": 145, "id": 977938}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1692078075", "name": "programmer", "avatar_normal": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1692078075", "title": "程序员", "url": "https://www.v2ex.com/go/programmer", "topics": 59190, "footer": "", "header": "While code monkeys are not eating bananas, they're coding.", "title_alternative": "Programmer", "avatar_mini": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1692078075", "stars": 8645, "aliases": [], "root": false, "id": 300, "parent_node_name": "computer"}, "member": {"id": 626874, "username": "AoEiuV020JP", "url": "https://www.v2ex.com/u/AoEiuV020JP", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "小号降权换这小小号，", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/0ad7/2c6c/626874_mini.png?m=1695890250", "avatar_normal": "https://cdn.v2ex.com/avatar/0ad7/2c6c/626874_normal.png?m=1695890250", "avatar_large": "https://cdn.v2ex.com/avatar/0ad7/2c6c/626874_large.png?m=1695890250", "created": 1683170981, "last_modified": 1695890250}, "last_reply_by": "subframe75361", "last_touched": 1695961682, "title": "鸿蒙原生开发现在行情如何？", "url": "https://www.v2ex.com/t/977996", "created": 1695890458, "deleted": 0, "content": "前阵子老大提了一下我就去研究了一下，这里是我收集到的情况，\r\n1. 鸿蒙 4.0 依然兼容安卓，**已经发布的所有鸿蒙手机系统都支持安卓应用**，\r\n2. HarmonyOS NEXT 不兼容安卓，但还没有开放，具体情况不明，目前向少数合作企业开放，2024 年才对开发者开放，什么时候能买到手机还不一定，\r\n3. 所有鸿蒙底层都有一套 OpenHarmony, OpenHarmony 无法使用安卓和 java 的代码，要使用 OpenHarmony 专用的开发工具从零开发，\r\n4. 以前可以把安卓项目转换成 HarmonyOS 项目，调整一些 api 就可以打包出 HarmonyOS 应用，但这种应用无法在 OpenHarmony 运行，只能在兼容安卓应用的 HarmonyOS 手机上运行，目前已经废弃，**HarmonyOS 开发已经不再支持安卓和 java 代码**，\r\n5. 针对不兼容安卓的鸿蒙开发应用的话只能使用**ArkTS 开发**，ArkTS 是基于 javascript 的编程语言，但无法直接使用第三方的 js 库，等于就是个新的技术栈，\r\n\r\n这个 ArkTS 感觉有点坑， 给我的感觉是还不够成熟，或者说库少，我这种代码的搬运工无法在这里开发完整项目的感觉，\r\n有没有大手子写过 ArkTS 原生鸿蒙项目，感觉如何？", "content_rendered": "<p>前阵子老大提了一下我就去研究了一下，这里是我收集到的情况，</p>\n<ol>\n<li>鸿蒙 4.0 依然兼容安卓，<strong>已经发布的所有鸿蒙手机系统都支持安卓应用</strong>，</li>\n<li>HarmonyOS NEXT 不兼容安卓，但还没有开放，具体情况不明，目前向少数合作企业开放，2024 年才对开发者开放，什么时候能买到手机还不一定，</li>\n<li>所有鸿蒙底层都有一套 OpenHarmony, OpenHarmony 无法使用安卓和 java 的代码，要使用 OpenHarmony 专用的开发工具从零开发，</li>\n<li>以前可以把安卓项目转换成 HarmonyOS 项目，调整一些 api 就可以打包出 HarmonyOS 应用，但这种应用无法在 OpenHarmony 运行，只能在兼容安卓应用的 HarmonyOS 手机上运行，目前已经废弃，<strong>HarmonyOS 开发已经不再支持安卓和 java 代码</strong>，</li>\n<li>针对不兼容安卓的鸿蒙开发应用的话只能使用<strong>ArkTS 开发</strong>，ArkTS 是基于 javascript 的编程语言，但无法直接使用第三方的 js 库，等于就是个新的技术栈，</li>\n</ol>\n<p>这个 ArkTS 感觉有点坑， 给我的感觉是还不够成熟，或者说库少，我这种代码的搬运工无法在这里开发完整项目的感觉，\n有没有大手子写过 ArkTS 原生鸿蒙项目，感觉如何？</p>\n", "last_modified": 1695890563, "replies": 82, "id": 977996}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1692078075", "name": "programmer", "avatar_normal": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1692078075", "title": "程序员", "url": "https://www.v2ex.com/go/programmer", "topics": 59190, "footer": "", "header": "While code monkeys are not eating bananas, they're coding.", "title_alternative": "Programmer", "avatar_mini": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1692078075", "stars": 8645, "aliases": [], "root": false, "id": 300, "parent_node_name": "computer"}, "member": {"id": 81681, "username": "mikewang", "url": "https://www.v2ex.com/u/mikewang", "website": "", "twitter": "", "psn": "", "github": "MikeWang000000", "btc": "", "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/b728/8030/81681_mini.png?m=1683726911", "avatar_normal": "https://cdn.v2ex.com/avatar/b728/8030/81681_normal.png?m=1683726911", "avatar_large": "https://cdn.v2ex.com/avatar/b728/8030/81681_large.png?m=1683726911", "created": 1416026416, "last_modified": 1683726911}, "last_reply_by": "wtdd", "last_touched": 1695964180, "title": "卸载软件的时候需要注意了，质量不好卸载程序会清空您的磁盘 :)", "url": "https://www.v2ex.com/t/978051", "created": 1695908261, "deleted": 0, "content": "省流：如果安装地址选在 C 盘根目录，卸载程序会把整个 C 盘全部删掉\r\n\r\n---\r\n\r\n![]( https://i.imgur.com/RTD2V2z.png)\r\n\r\n> 尊敬的指挥官：  \r\n>   \r\n> 在今日 12:00 所发布的引力测试 PC 客户端，若进行“卸载游戏文件”操作，在执行游戏卸载时会根据所安装的游戏目录不同，出现将游戏安装盘符内所有文件删除的问题。  \r\n> 我们在发现问题后，进行了多次重现测试，测试结果与上述一致，在执行“卸载游戏文件”操作时会根据游戏安装目录的不同，出现清空游戏客户端文件所在目录内所有文件的问题，包括根目录。  \r\n>   \r\n> 会导致卸载时出现清空游戏客户端文件所在目录内所有文件的问题主要集中在安装游戏路径在根目录时，如：`C:/`  \r\n> 在此，我们呼吁每一位看到此说明的指挥官，在游戏安装时如需要修改安装路径，请不要直接安装在根目录下，而是多设一层子目录，如：`C:/GF2Exilium/GF2 Game`  \r\n>   \r\n> 若您此刻想进行“卸载游戏文件”操作，而安装时也直接安装至根目录时，烦请您不要使用启动器的“卸载游戏文件”功能，转由手动删除游戏文件进行。  \r\n>   \r\n> 出现了这样的错误，我们诚恳、诚挚地向各位指挥官道歉，这样的品控问题也是不应该出现的，我们定将重视此次问题，对之后的品控管理进行加强与监管。  \r\n> 此问题的应对我们正在紧急赶制中，会尽快进行问题修复。  \r\n> 最后，对各位指挥官一直以来的包容与支持我们衷心表示感谢，感谢您们！  \r\n>   \r\n> 《少女前线 2：追放》团队", "content_rendered": "<p>省流：如果安装地址选在 C 盘根目录，卸载程序会把整个 C 盘全部删掉</p>\n<hr/>\n<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://i.imgur.com/RTD2V2z.png\"/></p>\n<blockquote>\n<p>尊敬的指挥官：  </p>\n<p>在今日 12:00 所发布的引力测试 PC 客户端，若进行“卸载游戏文件”操作，在执行游戏卸载时会根据所安装的游戏目录不同，出现将游戏安装盘符内所有文件删除的问题。<br/>\n我们在发现问题后，进行了多次重现测试，测试结果与上述一致，在执行“卸载游戏文件”操作时会根据游戏安装目录的不同，出现清空游戏客户端文件所在目录内所有文件的问题，包括根目录。  </p>\n<p>会导致卸载时出现清空游戏客户端文件所在目录内所有文件的问题主要集中在安装游戏路径在根目录时，如：<code>C:/</code><br/>\n在此，我们呼吁每一位看到此说明的指挥官，在游戏安装时如需要修改安装路径，请不要直接安装在根目录下，而是多设一层子目录，如：<code>C:/GF2Exilium/GF2 Game</code> </p>\n<p>若您此刻想进行“卸载游戏文件”操作，而安装时也直接安装至根目录时，烦请您不要使用启动器的“卸载游戏文件”功能，转由手动删除游戏文件进行。  </p>\n<p>出现了这样的错误，我们诚恳、诚挚地向各位指挥官道歉，这样的品控问题也是不应该出现的，我们定将重视此次问题，对之后的品控管理进行加强与监管。<br/>\n此问题的应对我们正在紧急赶制中，会尽快进行问题修复。<br/>\n最后，对各位指挥官一直以来的包容与支持我们衷心表示感谢，感谢您们！  </p>\n<p>《少女前线 2：追放》团队</p>\n</blockquote>\n", "last_modified": 1695908261, "replies": 53, "id": 978051}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340", "name": "qna", "avatar_normal": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340", "title": "问与答", "url": "https://www.v2ex.com/go/qna", "topics": 211461, "footer": "", "header": "一个更好的世界需要你持续地提出好问题。", "title_alternative": "Questions and Answers", "avatar_mini": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340", "stars": 3970, "aliases": [], "root": false, "id": 12, "parent_node_name": "v2ex"}, "member": {"id": 493323, "username": "aiamjay", "url": "https://www.v2ex.com/u/aiamjay", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/254d4ff961c1936f0915b1aea8fc3b0b?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/254d4ff961c1936f0915b1aea8fc3b0b?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/254d4ff961c1936f0915b1aea8fc3b0b?s=73&d=retro", "created": 1591318063, "last_modified": 1591318063}, "last_reply_by": "fdghjk", "last_touched": 1695961498, "title": "开发主力机 Linux 桌面版求推荐", "url": "https://www.v2ex.com/t/977945", "created": 1695884366, "deleted": 0, "content": "各位大哥以及小姐姐们好，本人有一台 12700k+64G+2T 三星+4070 的 PC ，一直吃灰，最近想用来做开发主力机，应该装什么版本的 Liunx 系统好呢？我之前装的是 ubuntu ，但是踩过很多坑（比如，nvidia 驱动更新导致无法进入桌面，关机 bpfilter read fail 0 ，开机监测到系统错误，种种 bug ，每一次都很烦）；有没有省心一点的 Liunx 系统推荐。（现在用的最多的还是 MacOS ，但是近些年以来有些厌倦被苹果绑定了。）", "content_rendered": "<p>各位大哥以及小姐姐们好，本人有一台 12700k+64G+2T 三星+4070 的 PC ，一直吃灰，最近想用来做开发主力机，应该装什么版本的 Liunx 系统好呢？我之前装的是 ubuntu ，但是踩过很多坑（比如，nvidia 驱动更新导致无法进入桌面，关机 bpfilter read fail 0 ，开机监测到系统错误，种种 bug ，每一次都很烦）；有没有省心一点的 Liunx 系统推荐。（现在用的最多的还是 MacOS ，但是近些年以来有些厌倦被苹果绑定了。）</p>\n", "last_modified": 1695884366, "replies": 46, "id": 977945}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_large.png?m=1695370146", "name": "career", "avatar_normal": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_normal.png?m=1695370146", "title": "职场话题", "url": "https://www.v2ex.com/go/career", "topics": 14879, "footer": "", "header": "这里，我们聊聊那些工作中遇到的开心和不开心的事。", "title_alternative": "Career", "avatar_mini": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_mini.png?m=1695370146", "stars": 2803, "aliases": [], "root": false, "id": 770, "parent_node_name": "work"}, "member": {"id": 455574, "username": "zyxcompany", "url": "https://www.v2ex.com/u/zyxcompany", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/avatar/6a94/f3e0/455574_mini.png?m=1693467726", "avatar_normal": "https://cdn.v2ex.com/avatar/6a94/f3e0/455574_normal.png?m=1693467726", "avatar_large": "https://cdn.v2ex.com/avatar/6a94/f3e0/455574_large.png?m=1693467726", "avatar_xlarge": "https://cdn.v2ex.com/avatar/6a94/f3e0/455574_xlarge.png?m=1693467726", "avatar_xxlarge": "https://cdn.v2ex.com/avatar/6a94/f3e0/455574_xlarge.png?m=1693467726", "created": 1574749054, "last_modified": 1693467726}, "last_reply_by": "aliveyang", "last_touched": 1695930201, "title": "想辞职，但是不知道怎么开口", "url": "https://www.v2ex.com/t/977943", "created": 1695884049, "deleted": 0, "content": "目前在 A 公司工作了六七年了，一直压榨我们，手头负责的工作越来越多，想换一份工作，目前有已经选择好了下家，坐等怎么跟领导开口（还不想闹崩）", "content_rendered": "<p>目前在 A 公司工作了六七年了，一直压榨我们，手头负责的工作越来越多，想换一份工作，目前有已经选择好了下家，坐等怎么跟领导开口（还不想闹崩）</p>\n", "last_modified": 1695884049, "replies": 45, "id": 977943}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_large.png?m=1630643913", "name": "apple", "avatar_normal": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_normal.png?m=1630643913", "title": "Apple", "url": "https://www.v2ex.com/go/apple", "topics": 23728, "footer": "", "header": "设计了 <a href=\"/go/watch\">Apple Watch</a>，<a href=\"/go/ipad\">iPad</a>，<a href=\"/go/iphone\">iPhone</a>，<a href=\"/go/imac\">iMac</a> 及 <a href=\"/go/mbp\">MacBook Pro</a> 等电子产品的美国公司。", "title_alternative": "Apple", "avatar_mini": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_mini.png?m=1630643913", "stars": 2733, "aliases": [], "root": false, "id": 184, "parent_node_name": "hardware"}, "member": {"id": 190967, "username": "supahotfire", "url": "https://www.v2ex.com/u/supahotfire", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/7c04/23ed/190967_mini.png?m=1643812809", "avatar_normal": "https://cdn.v2ex.com/avatar/7c04/23ed/190967_normal.png?m=1643812809", "avatar_large": "https://cdn.v2ex.com/avatar/7c04/23ed/190967_large.png?m=1643812809", "created": 1473337780, "last_modified": 1643812809}, "last_reply_by": "astrophys", "last_touched": 1695965484, "title": "看到今天的热门，给国区 appstore 充了 1000，能用来干嘛呢", "url": "https://www.v2ex.com/t/978029", "created": 1695899287, "deleted": 0, "content": "平时主力是美区的，感觉有点冲动消费了，为了 9 折的羊毛不太值", "content_rendered": "平时主力是美区的，感觉有点冲动消费了，为了 9 折的羊毛不太值", "last_modified": 1695899287, "replies": 39, "id": 978029}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/f61d/6947/375_large.png?m=1658910399", "name": "go", "avatar_normal": "https://cdn.v2ex.com/navatar/f61d/6947/375_normal.png?m=1658910399", "title": "Go 编程语言", "url": "https://www.v2ex.com/go/go", "topics": 2798, "footer": "", "header": "Go 是一个开源的编程语言，它能让构造简单、可靠且高效的软件变得容易。", "title_alternative": "The Go Programming Language", "avatar_mini": "https://cdn.v2ex.com/navatar/f61d/6947/375_mini.png?m=1658910399", "stars": 3701, "aliases": [], "root": false, "id": 375, "parent_node_name": "programming"}, "member": {"id": 174672, "username": "Gota", "url": "https://www.v2ex.com/u/Gota", "website": "https://blog.igota.net", "twitter": "", "psn": "", "github": "gota33", "btc": "", "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/9631/bcdd/174672_mini.png?m=1639760656", "avatar_normal": "https://cdn.v2ex.com/avatar/9631/bcdd/174672_normal.png?m=1639760656", "avatar_large": "https://cdn.v2ex.com/avatar/9631/bcdd/174672_large.png?m=1639760656", "avatar_xlarge": "https://cdn.v2ex.com/avatar/9631/bcdd/174672_xlarge.png?m=1639760656", "avatar_xxlarge": "https://cdn.v2ex.com/avatar/9631/bcdd/174672_xlarge.png?m=1639760656", "created": 1464186479, "last_modified": 1639760656}, "last_reply_by": "Gota", "last_touched": 1695914071, "title": "Go 1.21 新加的 log/slog 大家开始用了吗? 写了一个输出到阿里云日志的 writer 扩展, 顺带问个跟 slog 扩展相关的问题.", "url": "https://www.v2ex.com/t/977965", "created": 1695885820, "deleted": 0, "content": "## 先是分享下我写的扩展\r\n\r\n扩展 writer 的地址: https://github.com/gota33/aliyun-log-writer\r\n\r\n```go\r\nlogger := slog.New(slog.NewJSONHandler(os.Stdout, nil))\r\n```\r\n\r\n用的时候把参数中的 os.Stdout 换成这个 writer 就行了.\r\n\r\n\r\n## 然后问两个问题\r\n\r\n一个是 slog 想 Hook 的话就两个接口可以入手, `slog.Handler` 和 `io.Writer`. \r\n\r\n我这里选择了 `io.Writer`, 主要是因为自己写 `slog.Handler` 的话, 得把 `slog.commonHandler` 里的逻辑再实现一遍, 实在有点麻烦, 有没有像 `logrus.Hook` 那样比较简单的实现方式?\r\n\r\n--- \r\n\r\n还有一个问题跟 channel 有关.\r\n\r\n有这样的工作队列, `submit()` 提交任务, `stop()` 阻止新任务提交, 并处理完存量任务后返回.\r\n\r\n\r\n```go\r\nvar (\r\n\tErrClosed = errors.New(\"closed\")\r\n\tchQuit    = make(chan struct{})\r\n\tchData    = make(chan int, 10)\r\n)\r\n\r\n// func start() { ... }\r\n\r\nfunc submit(n int) error {\r\n\tselect {\r\n\tcase <-chQuit:\r\n\t\treturn ErrClosed\r\n\tcase chData <- n:\r\n\t\treturn nil\r\n\t}\r\n}\r\n\r\nfunc stop() {\r\n\tclose(chQuit)\r\n\tclose(chData)\r\n\t\r\n\tfor n := range chData {\r\n\t\t// process data\r\n\t\t_ = n\r\n\t}\r\n}\r\n```\r\n\r\n但是 `select` 跟 `switch` 不一样, `case` 的选择不是有序的, 导致有时候会选到第二个 `case` 然后 `panic`.\r\n\r\n所以后来把 `stop()` 改成这样了\r\n\r\n```go\r\nfunc stop() {\r\n\tclose(chQuit)\r\n\r\n\tch := chData\r\n\tchData = make(chan int)\r\n\r\n\tfor len(ch) > 0 {\r\n\t\t// process data\r\n\t\tselect {\r\n\t\tcase n := <-ch:\r\n\t\t\t_ = n\r\n\t\tdefault:\r\n\t\t}\r\n\t}\r\n}\r\n```\r\n\r\n这种情况大家一般是怎么处理的?", "content_rendered": "<h2>先是分享下我写的扩展</h2>\n<p>扩展 writer 的地址: <a href=\"https://github.com/gota33/aliyun-log-writer\" rel=\"nofollow\">https://github.com/gota33/aliyun-log-writer</a></p>\n<pre><code class=\"language-go\">logger := slog.New(slog.NewJSONHandler(os.Stdout, nil))\n</code></pre>\n<p>用的时候把参数中的 os.Stdout 换成这个 writer 就行了.</p>\n<h2>然后问两个问题</h2>\n<p>一个是 slog 想 Hook 的话就两个接口可以入手, <code>slog.Handler</code> 和 <code>io.Writer</code>. </p>\n<p>我这里选择了 <code>io.Writer</code>, 主要是因为自己写 <code>slog.Handler</code> 的话, 得把 <code>slog.commonHandler</code> 里的逻辑再实现一遍, 实在有点麻烦, 有没有像 <code>logrus.Hook</code> 那样比较简单的实现方式?</p>\n<hr/>\n<p>还有一个问题跟 channel 有关.</p>\n<p>有这样的工作队列, <code>submit()</code> 提交任务, <code>stop()</code> 阻止新任务提交, 并处理完存量任务后返回.</p>\n<pre><code class=\"language-go\">var (\n\tErrClosed = errors.New(\"closed\")\n\tchQuit    = make(chan struct{})\n\tchData    = make(chan int, 10)\n)\n\n// func start() { ... }\n\nfunc submit(n int) error {\n\tselect {\n\tcase &lt;-chQuit:\n\t\treturn ErrClosed\n\tcase chData &lt;- n:\n\t\treturn nil\n\t}\n}\n\nfunc stop() {\n\tclose(chQuit)\n\tclose(chData)\n\t\n\tfor n := range chData {\n\t\t// process data\n\t\t_ = n\n\t}\n}\n</code></pre>\n<p>但是 <code>select</code> 跟 <code>switch</code> 不一样, <code>case</code> 的选择不是有序的, 导致有时候会选到第二个 <code>case</code> 然后 <code>panic</code>.</p>\n<p>所以后来把 <code>stop()</code> 改成这样了</p>\n<pre><code class=\"language-go\">func stop() {\n\tclose(chQuit)\n\n\tch := chData\n\tchData = make(chan int)\n\n\tfor len(ch) &gt; 0 {\n\t\t// process data\n\t\tselect {\n\t\tcase n := &lt;-ch:\n\t\t\t_ = n\n\t\tdefault:\n\t\t}\n\t}\n}\n</code></pre>\n<p>这种情况大家一般是怎么处理的?</p>\n", "last_modified": 1695885820, "replies": 34, "id": 977965}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/c9f0/f895/8_large.png?m=1630643991", "name": "iphone", "avatar_normal": "https://cdn.v2ex.com/navatar/c9f0/f895/8_normal.png?m=1630643991", "title": "iPhone", "url": "https://www.v2ex.com/go/iphone", "topics": 10544, "footer": "这里绝不讨论如何获得 iPhone 盗版软件、iTunes 黑卡之类。", "header": "Say hello to the future.", "title_alternative": "iPhone", "avatar_mini": "https://cdn.v2ex.com/navatar/c9f0/f895/8_mini.png?m=1630643991", "stars": 3202, "aliases": [], "root": false, "id": 8, "parent_node_name": "apple"}, "member": {"id": 92500, "username": "xuegy", "url": "https://www.v2ex.com/u/xuegy", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/gravatar/a14fd036007f13550119309d4ee7e0f1?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/a14fd036007f13550119309d4ee7e0f1?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/a14fd036007f13550119309d4ee7e0f1?s=73&d=retro", "created": 1421601097, "last_modified": 1695261520}, "last_reply_by": "S2Line", "last_touched": 1695966432, "title": "亲测 15 Pro 屏幕继续瞎眼", "url": "https://www.v2ex.com/t/978087", "created": 1695925133, "deleted": 0, "content": "在 Costco 的手机柜台看到了 15 Pro 和 15 Pro Max 的展示机，上去把玩了两分钟，跟营业员聊了聊。很快眼睛就开始疼，三角区酸胀。有了几年前 12 mini 退货的经验，我知道这是 PWM 调光闹的，赶紧离开手机柜台，10 分钟以后症状逐渐好转。\r\n\r\n本人对 PWM 极度敏感，开车的时候，如果后面跟车是 LED 大灯，我是能从后视镜里看到闪烁的。问同行乘客都说看不出来在闪。咱也不知道这是特异体质还是视力残疾，反正苹果整天关爱这个关爱那个，就是不关爱 PWM 敏感人群。", "content_rendered": "<p>在 Costco 的手机柜台看到了 15 Pro 和 15 Pro Max 的展示机，上去把玩了两分钟，跟营业员聊了聊。很快眼睛就开始疼，三角区酸胀。有了几年前 12 mini 退货的经验，我知道这是 PWM 调光闹的，赶紧离开手机柜台，10 分钟以后症状逐渐好转。</p>\n<p>本人对 PWM 极度敏感，开车的时候，如果后面跟车是 LED 大灯，我是能从后视镜里看到闪烁的。问同行乘客都说看不出来在闪。咱也不知道这是特异体质还是视力残疾，反正苹果整天关爱这个关爱那个，就是不关爱 PWM 敏感人群。</p>\n", "last_modified": 1695925147, "replies": 32, "id": 978087}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/c9f0/f895/8_large.png?m=1630643991", "name": "iphone", "avatar_normal": "https://cdn.v2ex.com/navatar/c9f0/f895/8_normal.png?m=1630643991", "title": "iPhone", "url": "https://www.v2ex.com/go/iphone", "topics": 10544, "footer": "这里绝不讨论如何获得 iPhone 盗版软件、iTunes 黑卡之类。", "header": "Say hello to the future.", "title_alternative": "iPhone", "avatar_mini": "https://cdn.v2ex.com/navatar/c9f0/f895/8_mini.png?m=1630643991", "stars": 3202, "aliases": [], "root": false, "id": 8, "parent_node_name": "apple"}, "member": {"id": 29340, "username": "xin1284", "url": "https://www.v2ex.com/u/xin1284", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/avatar/4912/9551/29340_mini.png?m=1635552146", "avatar_normal": "https://cdn.v2ex.com/avatar/4912/9551/29340_normal.png?m=1635552146", "avatar_large": "https://cdn.v2ex.com/avatar/4912/9551/29340_large.png?m=1635552146", "created": 1352088060, "last_modified": 1635552146}, "last_reply_by": "smlcgx", "last_touched": 1694975858, "title": "手机厂商就不能针对非手机摄影爱好者出一款旗舰机型吗", "url": "https://www.v2ex.com/t/978055", "created": 1695910262, "deleted": 0, "content": "今年的 iPhone15 颜色真不错，重量和手感也好，但是我还想要高刷和 8G 内存。pro 机型颜色也还行，但是和数字系列相比重很多，后边三颗硕大丑陋的摄像头我并不需要。如果想要高刷和 8G 内存，我就得为了我不用的摄影功能多花钱心里也觉得不值。\r\n所以就导致买哪款机型心里都没那么舒坦。\r\n平时就用手机扫个码，用了 2 年的手机相册里的照片不超过 50 张，但是不管用哪一款手机都得忍受硕大凸起的摄像头，不仅对我没用还重还丑很多还增加了手机的重量。之前用 se ，是个好选择，但是屏幕及其他配置比旗舰机型差太多了。我当然也可以接受虽然不常用但也算有点用的摄像头变大点，比如 iPhone 15 这样，但是不喜欢摄像头和其他功能绑定来定位旗舰，想要其他功能还必须买旗舰机型。\r\n\r\n当然我理解绝大多数人还是需要用手机记录生活的，我这种情况算非常小众的情形。但 iPad 的摄像头是个什么鬼啊……之前 iPad mini5 好好的，换成 mini6 摄像头一下就凸起了。pro 版本的 iPad 摄像头的激凸程度就更夸张了，咱就说真有人用 iPad 摄影吗？就算是学生也就是用 iPad 拍个 ppt 之类的吧，有必要搞得那么大的摄像头吗？苹果你能不能不要在任何设备上都搞个激凸的摄像头", "content_rendered": "今年的 iPhone15 颜色真不错，重量和手感也好，但是我还想要高刷和 8G 内存。pro 机型颜色也还行，但是和数字系列相比重很多，后边三颗硕大丑陋的摄像头我并不需要。如果想要高刷和 8G 内存，我就得为了我不用的摄影功能多花钱心里也觉得不值。<br />所以就导致买哪款机型心里都没那么舒坦。<br />平时就用手机扫个码，用了 2 年的手机相册里的照片不超过 50 张，但是不管用哪一款手机都得忍受硕大凸起的摄像头，不仅对我没用还重还丑很多还增加了手机的重量。之前用 se ，是个好选择，但是屏幕及其他配置比旗舰机型差太多了。我当然也可以接受虽然不常用但也算有点用的摄像头变大点，比如 iPhone 15 这样，但是不喜欢摄像头和其他功能绑定来定位旗舰，想要其他功能还必须买旗舰机型。<br /><br />当然我理解绝大多数人还是需要用手机记录生活的，我这种情况算非常小众的情形。但 iPad 的摄像头是个什么鬼啊……之前 iPad mini5 好好的，换成 mini6 摄像头一下就凸起了。pro 版本的 iPad 摄像头的激凸程度就更夸张了，咱就说真有人用 iPad 摄影吗？就算是学生也就是用 iPad 拍个 ppt 之类的吧，有必要搞得那么大的摄像头吗？苹果你能不能不要在任何设备上都搞个激凸的摄像头", "last_modified": 1695910456, "replies": 30, "id": 978055}]