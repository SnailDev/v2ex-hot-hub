[{"node": {"avatar_large": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340", "name": "qna", "avatar_normal": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340", "title": "问与答", "url": "https://www.v2ex.com/go/qna", "topics": 189630, "footer": "", "header": "一个更好的世界需要你持续地提出好问题。", "title_alternative": "Questions and Answers", "avatar_mini": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340", "stars": 3551, "aliases": [], "root": false, "id": 12, "parent_node_name": "v2ex"}, "member": {"id": 506259, "username": "silypie", "url": "https://www.v2ex.com/u/silypie", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/gravatar/e2f1dbb036de1978c1ddaffbd8435018?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/e2f1dbb036de1978c1ddaffbd8435018?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/e2f1dbb036de1978c1ddaffbd8435018?s=73&d=retro", "created": 1598965543, "last_modified": 1658109458}, "last_reply_by": "cubecube", "last_touched": 1662362390, "title": "大伙觉得这次的经济下行、互联网行业低潮大概会持续多久？", "url": "https://www.v2ex.com/t/877746", "created": 1662344584, "deleted": 0, "content": "无数的公司裁员，很多公司今年也不怎么招人，上岸难度比往年难很多，很多人现在都放低要求、能有一个差不多的坑位就行。不止互联网，其他行业好像也没以前容易了。", "content_rendered": "无数的公司裁员，很多公司今年也不怎么招人，上岸难度比往年难很多，很多人现在都放低要求、能有一个差不多的坑位就行。不止互联网，其他行业好像也没以前容易了。", "last_modified": 1662344659, "replies": 119, "id": 877746}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/70ef/df2e/17_large.png?m=1660301119", "name": "create", "avatar_normal": "https://cdn.v2ex.com/navatar/70ef/df2e/17_normal.png?m=1660301119", "title": "分享创造", "url": "https://www.v2ex.com/go/create", "topics": 18366, "footer": "", "header": "欢迎你在这里发布自己的最新作品！", "title_alternative": "Create", "avatar_mini": "https://cdn.v2ex.com/navatar/70ef/df2e/17_mini.png?m=1660301119", "stars": 4510, "aliases": [], "root": false, "id": 17, "parent_node_name": "geek"}, "member": {"id": 148974, "username": "star7th", "url": "https://www.v2ex.com/u/star7th", "website": "http://blog.star7th.com/", "twitter": "", "psn": "", "github": "", "btc": "", "location": "", "tagline": "", "bio": "前端、PHP、node.js和Linux", "avatar_mini": "https://cdn.v2ex.com/gravatar/28688ae0c93f06c9f73a3e6ba79e0508?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/28688ae0c93f06c9f73a3e6ba79e0508?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/28688ae0c93f06c9f73a3e6ba79e0508?s=73&d=retro", "created": 1448637932, "last_modified": 1648098744}, "last_reply_by": "ScepterZ", "last_touched": 1662358287, "title": "我是如何把网站图片 cdn 流量成本压到全网最低(之一)的", "url": "https://www.v2ex.com/t/877718", "created": 1662341564, "deleted": 0, "content": "### 缘起\r\n      \r\n我经营的一些网站和产品的访问量越来越高，付出的 cdn 流量成本（主要是图片资源）也越来越大。抱着节省成本的想法，我尝试在网络上找下有没有便宜的 cdn 商家。 像阿里云、腾讯云、七牛云，这些公有云 cdn 的价格都大同小异，我感觉即使从这一家换到另一家，也节省不了多少成本，同时还增加了迁移的麻烦。因此我把目光投向传统机房，预感可能越接近机器底层，能优化的空间越大。\r\n\r\n经过几天的考察，发现很多非热门地区的机房都或多或少都有一些闲置的优惠产品，甚至其中也不乏优质带宽机器。特别是三四线机房，线路测试其实还不错。很明显这些闲置资源没有得到充分利用。一个点子在我脑海中酝酿了。\r\n\r\n  \r\n### 使用开源 or 自己原创？\r\n\r\n假如我把各地的闲置机器组织起来，把它们当成一个个节点，组建起一个分布式网络，自动容灾切换，岂不就是一个廉价的自建 cdn 方案了？ 顺着这个思路，我去找一下开源的 cdn 软件 ，看看有没有现成的解决方案。\r\n\r\n然而事情没有我想的那么简单。开源 cdn 并没有很好的容灾切换机制，无法实时避障。 它核心原理里，用域名 cname 的方式指向某个节点 ip ，当节点挂了的时候，由于域名 cname 解析变更有 10 分钟以上的缓存，所以必定会导致用户有一段时间的访问故障。\r\n我现在探索的是把各地机房集成到一起，其中机器节点的可靠性是参差不齐的。如果想做成一套 cdn ，那么就必须要假设节点是不可靠的，随时可能故障的，然后为此设计一套完善的容灾解决方案。\r\n\r\n既然找不到现成的开源解决方案，那就自己动手写代码实现吧。\r\n\r\n### 基本逻辑\r\n\r\n我边啃着玉米，边用笔在纸上画着逻辑交互图。 经过一阵子的反复斟酌，基本逻辑已经成型。 \r\n\r\n1 ，这套程序主要有两个角色，调度服务器和节点服务器。调度服务器架设在阿里云 k8s 上，保障高可用。而节点服务器则是分布在各地机房，做好可能会故障、随时容灾切换的准备。\r\n\r\n2 ，调度服务器的作用是导流和容灾，将用户流量以重定向的方式导向可用的节点，同时避开故障节点，做到实时无缝切换。\r\n\r\n3 ，节点服务器的主要作用是拉取源文件到本地缓存，从而被用户访问。\r\n\r\n4 ，节点服务器跟调度服务器之间要用某 tcp 协议实时连接监控，监控粒度细分到每个文件，方便调度服务器实时避开故障节点，这样才能保证故障时候，用户访问的每个链接都可以正常切换访问。这里实时性是非常重要的，也是容灾方案的核心。\r\n\r\n\r\n### 小试牛刀\r\n\r\n于是我花了一个多月的时间去写代码来实现这个逻辑。核心代码其实写得很快，但是为了保障稳定性，增加了非常多的异常容灾措施，要花时间不断测试不断重写。 初期只放三个异地机房节点，把流量切进来看看。\r\n为了保险起见，先从小的做起。我一开始切日均 10G 流量过去，让它跑几天。\r\n几天后，没问题。\r\n试试日均 50G 流量？  50G 跑了几天，ok 。日均 300G ？ 依然正常运行 。\r\n\r\n### 开放商用\r\n\r\n现在，已经完美运行了一个月，每天承受超过 1000G 流量，暂时没发现有故障现象。我以及一些朋友的很多产品都在用。我刻意关掉其中一个节点，调度服务器马上切流量到其他节点。我刻意关闭全部节点，流量也马上转到源站。整个过程中，只要调度服务器正常运作，那么，无论节点故障与否，用户都将继续无感知地正常访问图片。 而调度服务器直接运行在阿里云 k8s 上，可靠性是非常高的。因此整套架构的可靠性很高。\r\n\r\n有了这个架构，如果需要承受更大流量，我只需要增加节点数即可。而全国范围内的机房机器多的是 ，我可以随时租机器来新增节点。当我意识到有规模化运作大流量的可能性后， 我决定把 cdn 能力包装出去 ，商业化运作。于是注册并备案了大风云网， 访问地址是  [www.dfyun.com.cn]( https://www.dfyun.com.cn  \"www.dfyun.com.cn\") \r\n        \r\n### 结语\r\n\r\n大风云[ www.dfyun.com.cn ]( https://www.dfyun.com.cn  \" www.dfyun.com.cn \") 严格来讲不是传统 cdn ，它是另一种内容分发机制，基于传统 cdn 以及传统机房机器， 用软件技术实现资源整合，是应用层面的一种微创新，在图片访问，文件下载等这些场景下可以成倍地降低流量成本 ，成本低于 0.05G/元 ， 降低到公有云 cdn 价格的四分之一以下（只对比平时价格，不考虑搞活动的临时特价），几乎是全网 cdn 流量成本最低之一了。", "content_rendered": "<h3>缘起</h3>\n<p>我经营的一些网站和产品的访问量越来越高，付出的 cdn 流量成本（主要是图片资源）也越来越大。抱着节省成本的想法，我尝试在网络上找下有没有便宜的 cdn 商家。 像阿里云、腾讯云、七牛云，这些公有云 cdn 的价格都大同小异，我感觉即使从这一家换到另一家，也节省不了多少成本，同时还增加了迁移的麻烦。因此我把目光投向传统机房，预感可能越接近机器底层，能优化的空间越大。</p>\n<p>经过几天的考察，发现很多非热门地区的机房都或多或少都有一些闲置的优惠产品，甚至其中也不乏优质带宽机器。特别是三四线机房，线路测试其实还不错。很明显这些闲置资源没有得到充分利用。一个点子在我脑海中酝酿了。</p>\n<h3>使用开源 or 自己原创？</h3>\n<p>假如我把各地的闲置机器组织起来，把它们当成一个个节点，组建起一个分布式网络，自动容灾切换，岂不就是一个廉价的自建 cdn 方案了？ 顺着这个思路，我去找一下开源的 cdn 软件 ，看看有没有现成的解决方案。</p>\n<p>然而事情没有我想的那么简单。开源 cdn 并没有很好的容灾切换机制，无法实时避障。 它核心原理里，用域名 cname 的方式指向某个节点 ip ，当节点挂了的时候，由于域名 cname 解析变更有 10 分钟以上的缓存，所以必定会导致用户有一段时间的访问故障。\n我现在探索的是把各地机房集成到一起，其中机器节点的可靠性是参差不齐的。如果想做成一套 cdn ，那么就必须要假设节点是不可靠的，随时可能故障的，然后为此设计一套完善的容灾解决方案。</p>\n<p>既然找不到现成的开源解决方案，那就自己动手写代码实现吧。</p>\n<h3>基本逻辑</h3>\n<p>我边啃着玉米，边用笔在纸上画着逻辑交互图。 经过一阵子的反复斟酌，基本逻辑已经成型。 </p>\n<p>1 ，这套程序主要有两个角色，调度服务器和节点服务器。调度服务器架设在阿里云 k8s 上，保障高可用。而节点服务器则是分布在各地机房，做好可能会故障、随时容灾切换的准备。</p>\n<p>2 ，调度服务器的作用是导流和容灾，将用户流量以重定向的方式导向可用的节点，同时避开故障节点，做到实时无缝切换。</p>\n<p>3 ，节点服务器的主要作用是拉取源文件到本地缓存，从而被用户访问。</p>\n<p>4 ，节点服务器跟调度服务器之间要用某 tcp 协议实时连接监控，监控粒度细分到每个文件，方便调度服务器实时避开故障节点，这样才能保证故障时候，用户访问的每个链接都可以正常切换访问。这里实时性是非常重要的，也是容灾方案的核心。</p>\n<h3>小试牛刀</h3>\n<p>于是我花了一个多月的时间去写代码来实现这个逻辑。核心代码其实写得很快，但是为了保障稳定性，增加了非常多的异常容灾措施，要花时间不断测试不断重写。 初期只放三个异地机房节点，把流量切进来看看。\n为了保险起见，先从小的做起。我一开始切日均 10G 流量过去，让它跑几天。\n几天后，没问题。\n试试日均 50G 流量？  50G 跑了几天，ok 。日均 300G ？ 依然正常运行 。</p>\n<h3>开放商用</h3>\n<p>现在，已经完美运行了一个月，每天承受超过 1000G 流量，暂时没发现有故障现象。我以及一些朋友的很多产品都在用。我刻意关掉其中一个节点，调度服务器马上切流量到其他节点。我刻意关闭全部节点，流量也马上转到源站。整个过程中，只要调度服务器正常运作，那么，无论节点故障与否，用户都将继续无感知地正常访问图片。 而调度服务器直接运行在阿里云 k8s 上，可靠性是非常高的。因此整套架构的可靠性很高。</p>\n<p>有了这个架构，如果需要承受更大流量，我只需要增加节点数即可。而全国范围内的机房机器多的是 ，我可以随时租机器来新增节点。当我意识到有规模化运作大流量的可能性后， 我决定把 cdn 能力包装出去 ，商业化运作。于是注册并备案了大风云网， 访问地址是  <a href=\"https://www.dfyun.com.cn\" rel=\"nofollow\" title=\"www.dfyun.com.cn\">www.dfyun.com.cn</a> </p>\n<h3>结语</h3>\n<p>大风云<a href=\"https://www.dfyun.com.cn\" rel=\"nofollow\" title=\" www.dfyun.com.cn \"> </a><a href=\"http://www.dfyun.com.cn\" rel=\"nofollow\">www.dfyun.com.cn</a>  严格来讲不是传统 cdn ，它是另一种内容分发机制，基于传统 cdn 以及传统机房机器， 用软件技术实现资源整合，是应用层面的一种微创新，在图片访问，文件下载等这些场景下可以成倍地降低流量成本 ，成本低于 0.05G/元 ， 降低到公有云 cdn 价格的四分之一以下（只对比平时价格，不考虑搞活动的临时特价），几乎是全网 cdn 流量成本最低之一了。</p>\n", "last_modified": 1662341756, "replies": 76, "id": 877718}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/c9f0/f895/8_large.png?m=1630643991", "name": "iphone", "avatar_normal": "https://cdn.v2ex.com/navatar/c9f0/f895/8_normal.png?m=1630643991", "title": "iPhone", "url": "https://www.v2ex.com/go/iphone", "topics": 9544, "footer": "这里绝不讨论如何获得 iPhone 盗版软件、iTunes 黑卡之类。", "header": "Say hello to the future.", "title_alternative": "iPhone", "avatar_mini": "https://cdn.v2ex.com/navatar/c9f0/f895/8_mini.png?m=1630643991", "stars": 2946, "aliases": [], "root": false, "id": 8, "parent_node_name": "apple"}, "member": {"id": 72587, "username": "sutking", "url": "https://www.v2ex.com/u/sutking", "website": "", "twitter": "", "psn": "", "github": "", "btc": "", "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/286b/1d8c/72587_mini.png?m=1567393123", "avatar_normal": "https://cdn.v2ex.com/avatar/286b/1d8c/72587_normal.png?m=1567393123", "avatar_large": "https://cdn.v2ex.com/avatar/286b/1d8c/72587_large.png?m=1567393123", "created": 1409541286, "last_modified": 1567393123}, "last_reply_by": "leimu012", "last_touched": 1662361313, "title": "既然信号不好，那就干脆不插 SIM 卡了！", "url": "https://www.v2ex.com/t/877634", "created": 1662284061, "deleted": 0, "content": "昨天带孩子到市郊玩，恰巧所处的位置手机信号不太好，当时正在用 iPhone 给孩子拍视频，手机突然弹出了这个画面（截图是后补的）：\r\n\r\n<img src=\"https://s3.bmp.ovh/imgs/2022/09/04/da2be2702c4491a9.png\" width = \"10\" alt=\"img\" align=center />\r\n\r\n然后拍摄就被打断了，正好错过了牙牙学语的孩子张口说话的精彩瞬间，非常气愤，回到家后就萌生了一个想法：\r\n<br>\r\n如果一个 iPhone 从买到手拆开包装的那一刻一直到它生命的终结一直都不插 SIM 卡，会怎样呢？🤔\r\n<br>\r\niPhone 本来信号就不好再加上电池续航也是蛋疼，每到信号不稳定的地方耗电量就更加夸张，如果让 iPhone 一直连着 WiFi 岂不是解决了这个问题？🤔iPhone 的这几个缺陷现在随便一个安卓机都强得多，续航都牛逼到不行、快充也是猛的一批、信号大概也比 iPhone 强，做个双机党有何不可（不用说那干脆用安卓机得了！ iPhone 是最好用的手机没有之一，不接受反驳！）？<br>\r\n你们觉得如何？<br>\r\n我打算先试试看，说不定过段时间回来更新体验。", "content_rendered": "<p>昨天带孩子到市郊玩，恰巧所处的位置手机信号不太好，当时正在用 iPhone 给孩子拍视频，手机突然弹出了这个画面（截图是后补的）：</p>\n<img alt=\"img\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://s3.bmp.ovh/imgs/2022/09/04/da2be2702c4491a9.png\"/>\n<p>然后拍摄就被打断了，正好错过了牙牙学语的孩子张口说话的精彩瞬间，非常气愤，回到家后就萌生了一个想法：\n<br/>\n如果一个 iPhone 从买到手拆开包装的那一刻一直到它生命的终结一直都不插 SIM 卡，会怎样呢？🤔\n<br/>\niPhone 本来信号就不好再加上电池续航也是蛋疼，每到信号不稳定的地方耗电量就更加夸张，如果让 iPhone 一直连着 WiFi 岂不是解决了这个问题？🤔iPhone 的这几个缺陷现在随便一个安卓机都强得多，续航都牛逼到不行、快充也是猛的一批、信号大概也比 iPhone 强，做个双机党有何不可（不用说那干脆用安卓机得了！ iPhone 是最好用的手机没有之一，不接受反驳！）？<br/>\n你们觉得如何？<br/>\n我打算先试试看，说不定过段时间回来更新体验。</p>\n", "last_modified": 1662284061, "replies": 71, "id": 877634}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/4299/8cf3/457_large.png?m=1583583838", "name": "gamedev", "avatar_normal": "https://cdn.v2ex.com/navatar/4299/8cf3/457_normal.png?m=1583583838", "title": "游戏开发", "url": "https://www.v2ex.com/go/gamedev", "topics": 308, "footer": "", "header": "无论你正在制作自己的 indie game，或是在大公司参与 AAA 大作，这里是大家讨论技术和理念的地方。", "title_alternative": "Game Development", "avatar_mini": "https://cdn.v2ex.com/navatar/4299/8cf3/457_mini.png?m=1583583838", "stars": 520, "aliases": [], "root": false, "id": 457, "parent_node_name": "programmer"}, "member": {"id": 589481, "username": "edis0n0", "url": "https://www.v2ex.com/u/edis0n0", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/8acfb030e98c7c3f424344dfb6eb8512?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/8acfb030e98c7c3f424344dfb6eb8512?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/8acfb030e98c7c3f424344dfb6eb8512?s=73&d=retro", "created": 1659166771, "last_modified": 1659970243}, "last_reply_by": "zw1one", "last_touched": 1662361896, "title": "为什么游戏玩家少了就要关服？", "url": "https://www.v2ex.com/t/877671", "created": 1662295854, "deleted": 0, "content": "服务器成本能有多高，留一两个人运营，或是直接不运营招一个低价兼*职服务器运维，纯收钱不行吗？\r\n\r\n（非游戏行业从业者，一直想不通的问题）", "content_rendered": "服务器成本能有多高，留一两个人运营，或是直接不运营招一个低价兼*职服务器运维，纯收钱不行吗？<br /><br />（非游戏行业从业者，一直想不通的问题）", "last_modified": 1662295854, "replies": 62, "id": 877671}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340", "name": "qna", "avatar_normal": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340", "title": "问与答", "url": "https://www.v2ex.com/go/qna", "topics": 189630, "footer": "", "header": "一个更好的世界需要你持续地提出好问题。", "title_alternative": "Questions and Answers", "avatar_mini": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340", "stars": 3551, "aliases": [], "root": false, "id": 12, "parent_node_name": "v2ex"}, "member": {"id": 576704, "username": "airbotgo", "url": "https://www.v2ex.com/u/airbotgo", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/gravatar/2d8f9a5b4fbddc9e8307b207222e9938?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/2d8f9a5b4fbddc9e8307b207222e9938?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/2d8f9a5b4fbddc9e8307b207222e9938?s=73&d=retro", "created": 1648272585, "last_modified": 1651624471}, "last_reply_by": "marcong95", "last_touched": 1662346453, "title": "腾讯这种行为是违规行为吗？", "url": "https://www.v2ex.com/t/877717", "created": 1662341434, "deleted": 0, "content": "1 、游戏故意多分区\r\n以王者荣耀为例，故意分出 iOS 、安卓、微信、QQ 四个组合分区，区之间账号隔离。目的是让用户重复消费。\r\n这种行为违规吗？\r\n\r\n2 、故意限制外区游戏\r\n以英雄联盟手游为例，外区英雄联盟手游，安卓、iOS 数据互通，且游戏内没有满天飞的广告。我玩外区（玩过美区、日区）必须挂梯子或加速器，否则无法连接服务器。\r\n这种行为违规吗？\r\n\r\n3 、游戏账号仅允许 QQ 、微信登录\r\n不能邮箱、游戏 ID 等其它登录方式，必须先下载它们的 QQ 、微信。\r\n这种行为违规吗？\r\n\r\n4 、付费用户遇到问题找不到真人客服\r\n提供的客服电话，从来没有打通过，对于付费用户来说，完全不能保障权益。\r\n这种行为违规吗？\r\n\r\n我天天祈祷腾讯倒闭。", "content_rendered": "1 、游戏故意多分区<br />以王者荣耀为例，故意分出 iOS 、安卓、微信、QQ 四个组合分区，区之间账号隔离。目的是让用户重复消费。<br />这种行为违规吗？<br /><br />2 、故意限制外区游戏<br />以英雄联盟手游为例，外区英雄联盟手游，安卓、iOS 数据互通，且游戏内没有满天飞的广告。我玩外区（玩过美区、日区）必须挂梯子或加速器，否则无法连接服务器。<br />这种行为违规吗？<br /><br />3 、游戏账号仅允许 QQ 、微信登录<br />不能邮箱、游戏 ID 等其它登录方式，必须先下载它们的 QQ 、微信。<br />这种行为违规吗？<br /><br />4 、付费用户遇到问题找不到真人客服<br />提供的客服电话，从来没有打通过，对于付费用户来说，完全不能保障权益。<br />这种行为违规吗？<br /><br />我天天祈祷腾讯倒闭。", "last_modified": 1662341434, "replies": 59, "id": 877717}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/03af/dbd6/63_large.png?m=1644490200", "name": "java", "avatar_normal": "https://cdn.v2ex.com/navatar/03af/dbd6/63_normal.png?m=1644490200", "title": "Java", "url": "https://www.v2ex.com/go/java", "topics": 5111, "footer": "", "header": "Sun 公司发明，被广泛使用的一门编程语言。", "title_alternative": "Java", "avatar_mini": "https://cdn.v2ex.com/navatar/03af/dbd6/63_mini.png?m=1644490200", "stars": 5041, "aliases": [], "root": false, "id": 63, "parent_node_name": "programming"}, "member": {"id": 446318, "username": "RedBeanIce", "url": "https://www.v2ex.com/u/RedBeanIce", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/1d1a/4f62/446318_mini.png?m=1593586282", "avatar_normal": "https://cdn.v2ex.com/avatar/1d1a/4f62/446318_normal.png?m=1593586282", "avatar_large": "https://cdn.v2ex.com/avatar/1d1a/4f62/446318_large.png?m=1593586282", "created": 1570929802, "last_modified": 1593586282}, "last_reply_by": "lolizeppelin", "last_touched": 1662361551, "title": "[mysql 字段] not null 还是 null default", "url": "https://www.v2ex.com/t/877652", "created": 1662288736, "deleted": 0, "content": "问题：如图，字段值的设置\r\n\r\n今天在看一篇文章，设计数据库的时候所有字段都设置为 not null ，并且给默认值 default null/0 ，我感觉这是不符合实际场景的\r\n\r\n我回想我入门的时候也看到过这样子的文章，但是我工作了两三年后发现，我都是根据业务实际来做的，业务允许为空那就是 null ，业务不允许为空我就给 not null ，这个是否必填由产品说了算。\r\n\r\n至于 default 属性，是只有选择框，下拉框才需要做的事情。否则都没有 default\r\n\r\n==========================隔断线=======\r\n\r\nnull 还是 not null：根据产品要求来设计\r\n\r\ndefault：根据实际场景，一般只在下拉框等场景使用\r\n\r\n如上，请各位指教，我这样应该是对的吧，这类似的文章都是不符合实际的吗？", "content_rendered": "<p>问题：如图，字段值的设置</p>\n<p>今天在看一篇文章，设计数据库的时候所有字段都设置为 not null ，并且给默认值 default null/0 ，我感觉这是不符合实际场景的</p>\n<p>我回想我入门的时候也看到过这样子的文章，但是我工作了两三年后发现，我都是根据业务实际来做的，业务允许为空那就是 null ，业务不允许为空我就给 not null ，这个是否必填由产品说了算。</p>\n<p>至于 default 属性，是只有选择框，下拉框才需要做的事情。否则都没有 default</p>\n<p>==========================隔断线=======</p>\n<p>null 还是 not null：根据产品要求来设计</p>\n<p>default：根据实际场景，一般只在下拉框等场景使用</p>\n<p>如上，请各位指教，我这样应该是对的吧，这类似的文章都是不符合实际的吗？</p>\n", "last_modified": 1662288765, "replies": 52, "id": 877652}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1659331259", "name": "programmer", "avatar_normal": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1659331259", "title": "程序员", "url": "https://www.v2ex.com/go/programmer", "topics": 50691, "footer": "", "header": "While code monkeys are not eating bananas, they're coding.", "title_alternative": "Programmer", "avatar_mini": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1659331259", "stars": 7969, "aliases": [], "root": false, "id": 300, "parent_node_name": "computer"}, "member": {"id": 572182, "username": "pepi", "url": "https://www.v2ex.com/u/pepi", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/avatar/4cb2/070f/572182_mini.png?m=1661866234", "avatar_normal": "https://cdn.v2ex.com/avatar/4cb2/070f/572182_normal.png?m=1661866234", "avatar_large": "https://cdn.v2ex.com/avatar/4cb2/070f/572182_large.png?m=1661866234", "avatar_xlarge": "https://cdn.v2ex.com/avatar/4cb2/070f/572182_xlarge.png?m=1661866234", "avatar_xxlarge": "https://cdn.v2ex.com/avatar/4cb2/070f/572182_xlarge.png?m=1661866234", "avatar_xxxlarge": "https://cdn.v2ex.com/avatar/4cb2/070f/572182_xlarge.png?m=1661866234", "created": 1644335138, "last_modified": 1661866234}, "last_reply_by": "viator42", "last_touched": 1662362286, "title": "你使用最长的，认为最好的笔记软件是什么?", "url": "https://www.v2ex.com/t/877756", "created": 1662346743, "deleted": 0, "content": "首先，确实没有完美的产品，或多或少都会为其痛点，不然不会有如此多的轮子被创造。\r\n但是对美好事物的向往，是每个人的追求，所以最接近你满意的就是最完美的\r\n\r\n个人目前使用最长笔记的就是 All In One 的 Notion ，使用 Ctrl+P 搜索所有\r\n\r\n市面上的笔记软件过于繁杂\r\n模块化: Notion\r\n传统大杂烩格式: OneNote 、Google Keep 、EverNote/印象笔记、为知笔记、有道云笔记、石墨文档、语雀、飞书文档\r\n思维扩散: 幕布、gitmind\r\n双向链表: Roam Research 、Obsidian 、Logseq 、Zettlr 、思源笔记\r\n纯离线的 md: typora\r\n以上列出过少，和分类不尽合理，比如为什么印象笔记就不是模块化，这里只是大致趋向分类。\r\n还有例如 craft 、bear 纯 iOS 平台的，虽然优秀，但是平台隔离也是痛点\r\n那么，小伙伴们，你的最爱笔记是什么呢？", "content_rendered": "<p>首先，确实没有完美的产品，或多或少都会为其痛点，不然不会有如此多的轮子被创造。\n但是对美好事物的向往，是每个人的追求，所以最接近你满意的就是最完美的</p>\n<p>个人目前使用最长笔记的就是 All In One 的 Notion ，使用 Ctrl+P 搜索所有</p>\n<p>市面上的笔记软件过于繁杂\n模块化: Notion\n传统大杂烩格式: OneNote 、Google Keep 、EverNote/印象笔记、为知笔记、有道云笔记、石墨文档、语雀、飞书文档\n思维扩散: 幕布、gitmind\n双向链表: Roam Research 、Obsidian 、Logseq 、Zettlr 、思源笔记\n纯离线的 md: typora\n以上列出过少，和分类不尽合理，比如为什么印象笔记就不是模块化，这里只是大致趋向分类。\n还有例如 craft 、bear 纯 iOS 平台的，虽然优秀，但是平台隔离也是痛点\n那么，小伙伴们，你的最爱笔记是什么呢？</p>\n", "last_modified": 1662346743, "replies": 52, "id": 877756}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340", "name": "qna", "avatar_normal": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340", "title": "问与答", "url": "https://www.v2ex.com/go/qna", "topics": 189630, "footer": "", "header": "一个更好的世界需要你持续地提出好问题。", "title_alternative": "Questions and Answers", "avatar_mini": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340", "stars": 3551, "aliases": [], "root": false, "id": 12, "parent_node_name": "v2ex"}, "member": {"id": 586395, "username": "rocododd", "url": "https://www.v2ex.com/u/rocododd", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/b6b3ae3c678c67e1700af746b93b2265?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/b6b3ae3c678c67e1700af746b93b2265?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/b6b3ae3c678c67e1700af746b93b2265?s=73&d=retro", "created": 1656570007, "last_modified": 1660284535}, "last_reply_by": "interger", "last_touched": 1662362345, "title": "大家在等红绿灯时候会想些什么呢", "url": "https://www.v2ex.com/t/877723", "created": 1662342244, "deleted": 0, "content": "", "content_rendered": "", "last_modified": 1662342244, "replies": 51, "id": 877723}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1659331259", "name": "programmer", "avatar_normal": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1659331259", "title": "程序员", "url": "https://www.v2ex.com/go/programmer", "topics": 50691, "footer": "", "header": "While code monkeys are not eating bananas, they're coding.", "title_alternative": "Programmer", "avatar_mini": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1659331259", "stars": 7969, "aliases": [], "root": false, "id": 300, "parent_node_name": "computer"}, "member": {"id": 554339, "username": "wanmyj", "url": "https://www.v2ex.com/u/wanmyj", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/be109705594bab0fb19c8fc051619b7d?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/be109705594bab0fb19c8fc051619b7d?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/be109705594bab0fb19c8fc051619b7d?s=73&d=retro", "created": 1629910849, "last_modified": 1629910849}, "last_reply_by": "xsqfjys", "last_touched": 1662361957, "title": "想基于电报开发完全去中心化的端端加密的即时通信 APP，目的是避免审查，有朋友有兴趣吗", "url": "https://www.v2ex.com/t/877787", "created": 1662353461, "deleted": 0, "content": "## Problem：\r\n0. 不翻墙的墙内安全群聊\r\n1. 中心化的 APP 一定会在被封和被审查当中二选一\r\n2. imessage 这种虽然不会被关键字审查（理论上），但不能跨平台\r\n\r\n\r\n## Solution：\r\n0. 基本设想是类似于`magnet link`，需要客户端，并且所有客户端都可以作为某些服务节点\r\n1. 由`group owner`发起一个`group link`，内容包含群 hash ，和自身 IP 和开放端口等信息组成的 tracker (NAT 造成的困难可以再想办法解决，我还没想到最优方案)，有效期，校验等信息。发布出去等待`group member`连接，建立群聊天室。\r\n2. 任何群组员`group member`都可以当 tracker 提供`group link`给其他人。\r\n3. group 内采用端端加密通信，并且无中心 server 。如果所有`group member`在同一时间换掉了 IP 地址，那这个群就会消亡。\r\n4. 聊天记录记录在一个或多个`group member`的本地，如果所有`group member`同时删掉了某条聊天记录，则这条记录无法恢复。\r\n\r\n本人在外企工作，平均每天能有 3 个小时的开发时间.这个项目可能需要数千小时的开发量，我的工程经验怕难以承担这种项目，所以想找一些同好一起完成这个 project 。最好有个有 IM 和网络工程经验的大佬来做 leader 。\r\n\r\n我想这个项目一定要开源，无论哪种许可证。", "content_rendered": "<h2>Problem：</h2>\n<ol>\n<li>不翻墙的墙内安全群聊</li>\n<li>中心化的 APP 一定会在被封和被审查当中二选一</li>\n<li>imessage 这种虽然不会被关键字审查（理论上），但不能跨平台</li>\n</ol>\n<h2>Solution：</h2>\n<ol>\n<li>基本设想是类似于<code>magnet link</code>，需要客户端，并且所有客户端都可以作为某些服务节点</li>\n<li>由<code>group owner</code>发起一个<code>group link</code>，内容包含群 hash ，和自身 IP 和开放端口等信息组成的 tracker (NAT 造成的困难可以再想办法解决，我还没想到最优方案)，有效期，校验等信息。发布出去等待<code>group member</code>连接，建立群聊天室。</li>\n<li>任何群组员<code>group member</code>都可以当 tracker 提供<code>group link</code>给其他人。</li>\n<li>group 内采用端端加密通信，并且无中心 server 。如果所有<code>group member</code>在同一时间换掉了 IP 地址，那这个群就会消亡。</li>\n<li>聊天记录记录在一个或多个<code>group member</code>的本地，如果所有<code>group member</code>同时删掉了某条聊天记录，则这条记录无法恢复。</li>\n</ol>\n<p>本人在外企工作，平均每天能有 3 个小时的开发时间.这个项目可能需要数千小时的开发量，我的工程经验怕难以承担这种项目，所以想找一些同好一起完成这个 project 。最好有个有 IM 和网络工程经验的大佬来做 leader 。</p>\n<p>我想这个项目一定要开源，无论哪种许可证。</p>\n", "last_modified": 1662353724, "replies": 48, "id": 877787}]