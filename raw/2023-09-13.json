[{"node": {"avatar_large": "https://cdn.v2ex.com/navatar/1fc2/1400/864_large.png?m=1658911802", "name": "promotions", "avatar_normal": "https://cdn.v2ex.com/navatar/1fc2/1400/864_normal.png?m=1658911802", "title": "推广", "url": "https://www.v2ex.com/go/promotions", "topics": 7360, "footer": "", "header": "来自厂商的推广活动类主题，会被归类到这个节点。希望有情怀的产商们在发布推广内容时，主动选择发布到本节点下。点击 <a href=\"/help/node\">这里</a> 阅读 V2EX 的节点使用指南。", "title_alternative": "Promotions", "avatar_mini": "https://cdn.v2ex.com/navatar/1fc2/1400/864_mini.png?m=1658911802", "stars": 827, "aliases": [], "root": false, "id": 864, "parent_node_name": ""}, "member": {"id": 42249, "username": "myexcite", "url": "https://www.v2ex.com/u/myexcite", "website": "https://www.imzimo.com", "twitter": "myexcite", "psn": "", "github": "", "btc": "", "location": "Beijing china", "tagline": "不大可能的事也许今天实现,根本不可能的事也许明天会实现。", "bio": "留住已经逝去的峥嵘岁月\r\n记住曾绽现的万种风情\r\n在记忆即将淡漠的时候\r\n来把这些重新回味", "avatar_mini": "https://cdn.v2ex.com/avatar/c5c2/42ec/42249_mini.png?m=1532438455", "avatar_normal": "https://cdn.v2ex.com/avatar/c5c2/42ec/42249_normal.png?m=1532438455", "avatar_large": "https://cdn.v2ex.com/avatar/c5c2/42ec/42249_large.png?m=1532438455", "created": 1374074648, "last_modified": 1532438455}, "last_reply_by": "ecoart", "last_touched": 1694592942, "title": "[ 2~3 折特价团购] 中秋团圆，少不了美酒相伴，盖楼赢奖品了伙伴们！", "url": "https://www.v2ex.com/t/973262", "created": 1694570572, "deleted": 0, "content": "<h1><b>秉衡老酒</b></h1><br>\r\n贵州怀庄酒业集团出品<br>\r\n源于民国初年“衡昌烧坊”<br>\r\n系茅台酒前身、三大烧坊之一<br>\r\n素有“风来隔壁三家醉，雨过开瓶十里香”的美誉<br>\r\n秉承百年传统酿造工艺，顺天应时，长期贮藏，精心酿制而成<br>\r\n具有酱香突出、优雅醇厚、酒体丰满、空杯留香等特点，是宴饮、馈赠和收藏的酒中佳品<br>\r\n\r\n\r\n![]( https://i.v2ex.co/J76QbP3M.jpeg)\r\n\r\n\r\n零售价 598 元，团购 200 元，1000 元一箱。<br>\r\n建议按箱购买，按箱购买更划算。只要您是爱喝酱香酒的，买一瓶不好喝全额退款，买一箱不好喝，只要剩下的五瓶未打开，也是全额退款。<br>\r\n您可以发现，这款酒绝对是酱香型酒友的福音，按活动价购买，性价比超高。<br>\r\n\r\n![]( https://i.v2ex.co/Z3WJ0wpO.jpeg)\r\n\r\n<h1>V 友专属团购群👆</h1><br>\r\n<hr/>\r\n<h2>邮寄和付款方式</h2>\r\n全场包邮，不支持货到付款，我们是菏泽开发区祥发商贸行，是贵州怀庄集团正式授权的代理商，可以放心付款。<br>\r\n您可以在群内付款，全体群友见证，绝无欺诈。<br>\r\n到货后别忘了检查，破损包赔。<br>\r\n<hr/>\r\n<h2>抽奖规则</h2><br>\r\n明天小奖，取明天上午贵州茅台股票的开盘价小数点后两位，奖品是一瓶秉衡老酒，每 100 楼抽一瓶，共 6 瓶。<br>\r\n后天大奖，取后天上午贵州茅台股票的开盘价小数点后两位，奖品是两瓶秉衡老酒（再加一个手提袋），总共一个名额，从前 100 个回复者当中产生。<br>\r\n小奖和大奖可以由一人同时中奖🎰<br>\r\n如果小数点后面是 00 ，则取 100 楼、200 楼、以此类推<br>\r\n<hr/>\r\nMTUyNzUwMTYwNTY=<br>\r\n以上是手机号，不懂解密的可以直接在微信中搜索“名优白酒”的拼音加微信。", "content_rendered": "<h1><b>秉衡老酒</b></h1><br/>\n贵州怀庄酒业集团出品<br/>\n源于民国初年“衡昌烧坊”<br/>\n系茅台酒前身、三大烧坊之一<br/>\n素有“风来隔壁三家醉，雨过开瓶十里香”的美誉<br/>\n秉承百年传统酿造工艺，顺天应时，长期贮藏，精心酿制而成<br/>\n具有酱香突出、优雅醇厚、酒体丰满、空杯留香等特点，是宴饮、馈赠和收藏的酒中佳品<br/>\n<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://i.v2ex.co/J76QbP3M.jpeg\"/></p>\n<p>零售价 598 元，团购 200 元，1000 元一箱。<br/>\n建议按箱购买，按箱购买更划算。只要您是爱喝酱香酒的，买一瓶不好喝全额退款，买一箱不好喝，只要剩下的五瓶未打开，也是全额退款。<br/>\n您可以发现，这款酒绝对是酱香型酒友的福音，按活动价购买，性价比超高。<br/></p>\n<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://i.v2ex.co/Z3WJ0wpO.jpeg\"/></p>\n<h1>V 友专属团购群👆</h1><br/>\n<hr/>\n<h2>邮寄和付款方式</h2>\n全场包邮，不支持货到付款，我们是菏泽开发区祥发商贸行，是贵州怀庄集团正式授权的代理商，可以放心付款。<br/>\n您可以在群内付款，全体群友见证，绝无欺诈。<br/>\n到货后别忘了检查，破损包赔。<br/>\n<hr/>\n<h2>抽奖规则</h2><br/>\n明天小奖，取明天上午贵州茅台股票的开盘价小数点后两位，奖品是一瓶秉衡老酒，每 100 楼抽一瓶，共 6 瓶。<br/>\n后天大奖，取后天上午贵州茅台股票的开盘价小数点后两位，奖品是两瓶秉衡老酒（再加一个手提袋），总共一个名额，从前 100 个回复者当中产生。<br/>\n小奖和大奖可以由一人同时中奖🎰<br/>\n如果小数点后面是 00 ，则取 100 楼、200 楼、以此类推<br/>\n<hr/>\nMTUyNzUwMTYwNTY=<br/>\n以上是手机号，不懂解密的可以直接在微信中搜索“名优白酒”的拼音加微信。", "last_modified": 1694570665, "replies": 151, "id": 973262}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1692078075", "name": "programmer", "avatar_normal": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1692078075", "title": "程序员", "url": "https://www.v2ex.com/go/programmer", "topics": 58850, "footer": "", "header": "While code monkeys are not eating bananas, they're coding.", "title_alternative": "Programmer", "avatar_mini": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1692078075", "stars": 8585, "aliases": [], "root": false, "id": 300, "parent_node_name": "computer"}, "member": {"id": 468371, "username": "Daotin", "url": "https://www.v2ex.com/u/Daotin", "website": "https://github.com/Daotin", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "永远年轻，永远热泪盈眶。", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/0053/93d4/468371_mini.png?m=1692424382", "avatar_normal": "https://cdn.v2ex.com/avatar/0053/93d4/468371_normal.png?m=1692424382", "avatar_large": "https://cdn.v2ex.com/avatar/0053/93d4/468371_large.png?m=1692424382", "created": 1581140297, "last_modified": 1692424382}, "last_reply_by": "polobug", "last_touched": 1694591686, "title": "安卓 or 苹果？想听听 V 友们的看法", "url": "https://www.v2ex.com/t/973118", "created": 1694516471, "deleted": 0, "content": "一直使用的 iPhone ，目前在使用 iPhone XR ，现在我使用 XR 老是杀进程，比如从微信复制个东西到抖音，操作一下再会微信就杀掉了。很影响用户体验。而安卓留给我的印象还是用 2-3 年就卡了。\r\n\r\n目前我的需求就是：**操作流畅，快，可随时切换后台，不卡，不杀进程**\r\n\r\n安卓和苹果都可以。想换安卓是因为生活不易，安卓比较便宜，然后似乎体验也很不错。\r\n\r\n但是，似乎也有一些担忧，比如数据转移麻烦，一些 app 内购的会员只能在 ios 使用，而且对于数据隐私性，苹果似乎更好。而且拥有一个苹果周边 Airpods pro.\r\n\r\n所以，想听听 V 友们的看法，谢谢！", "content_rendered": "<p>一直使用的 iPhone ，目前在使用 iPhone XR ，现在我使用 XR 老是杀进程，比如从微信复制个东西到抖音，操作一下再会微信就杀掉了。很影响用户体验。而安卓留给我的印象还是用 2-3 年就卡了。</p>\n<p>目前我的需求就是：<strong>操作流畅，快，可随时切换后台，不卡，不杀进程</strong></p>\n<p>安卓和苹果都可以。想换安卓是因为生活不易，安卓比较便宜，然后似乎体验也很不错。</p>\n<p>但是，似乎也有一些担忧，比如数据转移麻烦，一些 app 内购的会员只能在 ios 使用，而且对于数据隐私性，苹果似乎更好。而且拥有一个苹果周边 Airpods pro.</p>\n<p>所以，想听听 V 友们的看法，谢谢！</p>\n", "last_modified": 1694516471, "replies": 140, "id": 973118}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_large.png?m=1630643913", "name": "apple", "avatar_normal": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_normal.png?m=1630643913", "title": "Apple", "url": "https://www.v2ex.com/go/apple", "topics": 23378, "footer": "", "header": "设计了 <a href=\"/go/watch\">Apple Watch</a>，<a href=\"/go/ipad\">iPad</a>，<a href=\"/go/iphone\">iPhone</a>，<a href=\"/go/imac\">iMac</a> 及 <a href=\"/go/mbp\">MacBook Pro</a> 等电子产品的美国公司。", "title_alternative": "Apple", "avatar_mini": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_mini.png?m=1630643913", "stars": 2693, "aliases": [], "root": false, "id": 184, "parent_node_name": "hardware"}, "member": {"id": 558157, "username": "random1221", "url": "https://www.v2ex.com/u/random1221", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/gravatar/b0ad688244264522c6d2fbf152c4b840?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/b0ad688244264522c6d2fbf152c4b840?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/b0ad688244264522c6d2fbf152c4b840?s=73&d=retro", "created": 1633941398, "last_modified": 1633941398}, "last_reply_by": "XIVN1987", "last_touched": 1694591406, "title": "为什么 iPhone 发布会从来不公布 ram？", "url": "https://www.v2ex.com/t/973242", "created": 1694569732, "deleted": 0, "content": "发布会吹了半天，连颜色都吹了，顺嘴提一下 RAM 很费事吗？\r\n\r\n官网也从来不标注 ram ，这是为什么", "content_rendered": "<p>发布会吹了半天，连颜色都吹了，顺嘴提一下 RAM 很费事吗？</p>\n<p>官网也从来不标注 ram ，这是为什么</p>\n", "last_modified": 1694569744, "replies": 124, "id": 973242}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/3b5d/ca50/819_large.png?m=1633251402", "name": "watch", "avatar_normal": "https://cdn.v2ex.com/navatar/3b5d/ca50/819_normal.png?m=1633251402", "title": " WATCH", "url": "https://www.v2ex.com/go/watch", "topics": 1055, "footer": "", "header": "<a href=\"/go/apple\">Apple</a> 公司设计的智能手表产品", "title_alternative": " WATCH", "avatar_mini": "https://cdn.v2ex.com/navatar/3b5d/ca50/819_mini.png?m=1633251402", "stars": 465, "aliases": [], "root": false, "id": 819, "parent_node_name": "apple"}, "member": {"id": 227469, "username": "ronman", "url": "https://www.v2ex.com/u/ronman", "website": "", "twitter": "", "psn": "", "github": "", "btc": "", "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/a0bc/c259/227469_mini.png?m=1671488254", "avatar_normal": "https://cdn.v2ex.com/avatar/a0bc/c259/227469_normal.png?m=1671488254", "avatar_large": "https://cdn.v2ex.com/avatar/a0bc/c259/227469_large.png?m=1671488254", "created": 1492959068, "last_modified": 1671488254}, "last_reply_by": "yhgogogo", "last_touched": 1694592106, "title": "想问一下买 Apple watch 的人是怎样的使用习惯？", "url": "https://www.v2ex.com/t/973214", "created": 1694566721, "deleted": 0, "content": "本来以为升级了处理器能够提升能效，结果早上醒来一看 9 代续航还是 18 小时，这是最不能忍受的，连一天都不到。如果白天要使用，晚上想记录睡眠，那么大家都是啥时候充电呢？出门玩两天不得把充电器也专门带上？😂", "content_rendered": "本来以为升级了处理器能够提升能效，结果早上醒来一看 9 代续航还是 18 小时，这是最不能忍受的，连一天都不到。如果白天要使用，晚上想记录睡眠，那么大家都是啥时候充电呢？出门玩两天不得把充电器也专门带上？😂", "last_modified": 1694571188, "replies": 109, "id": 973214}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1692078075", "name": "programmer", "avatar_normal": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1692078075", "title": "程序员", "url": "https://www.v2ex.com/go/programmer", "topics": 58850, "footer": "", "header": "While code monkeys are not eating bananas, they're coding.", "title_alternative": "Programmer", "avatar_mini": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1692078075", "stars": 8585, "aliases": [], "root": false, "id": 300, "parent_node_name": "computer"}, "member": {"id": 640245, "username": "shaoyie", "url": "https://www.v2ex.com/u/shaoyie", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/075af895dcaf5e5f495d52b69c7c7bd2?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/075af895dcaf5e5f495d52b69c7c7bd2?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/075af895dcaf5e5f495d52b69c7c7bd2?s=73&d=retro", "created": 1690334664, "last_modified": 1694505470}, "last_reply_by": "ragnaroks", "last_touched": 1694591812, "title": "c++多线程实现反向代理 QPS 达到 Haproxy/Nginx 的 3 倍", "url": "https://www.v2ex.com/t/973075", "created": 1694507528, "deleted": 0, "content": "## NiubiX. \r\n[项目地址]( https://github.com/shaovie/niubix)\r\n\r\n实验性项目，NiubiX 只提供反向代理功能，大家轻拍有不好的地方可以留言或提 issue/pr.  觉得好就点个 star ，我会持续完善它\r\n\r\n与 Nginx/Haproxy 对比测试\r\n> Linux 5.19.0-1030-gcp #32~22.04.1-Ubuntu  \r\n> Instacne 1 GCP cloud VM, 2 cores, 4GB RAM 10.146.0.2 (nginx,haproxy, niubix run at here)   \r\n> Instacne 2 GCP cloud VM, 2 cores, 4GB RAM 10.146.0.3 (backend, wrk run at here)  \r\n\r\n**nginx version config**\r\n```\r\nnginx version: nginx/1.18.0 (Ubuntu)\r\n\r\nserver {\r\n    listen       8082 reuseport;\r\n    server_name  localhost;\r\n\r\n    access_log  off;\r\n    error_log off;\r\n\r\n    location / {\r\n        proxy_pass http://10.146.0.3:8080;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n    }\r\n}\r\n\r\nroot         516       1  0 Aug24 ?        00:00:00 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;\r\nwww-data  417322     516  0 12:13 ?        00:00:06 nginx: worker process\r\nwww-data  417323     516  0 12:13 ?        00:00:08 nginx: worker process\r\n```\r\n\r\n**haproxy version config**\r\n```\r\nHAProxy version 2.4.22-0ubuntu0.22.04.2 2023/08/14\r\n\r\nlisten niubix\r\n    bind 0.0.0.0:8083\r\n    mode http\r\n    option forwardfor\r\n    server s1 10.146.0.3:8080\r\n\r\nps -eLf | grep haproxy\r\nroot      449421       1  449421  0    1 15:11 ?        00:00:00 /usr/sbin/haproxy -Ws -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -S /run/haproxy-master.sock\r\nhaproxy   449423  449421  449423  0    2 15:11 ?        00:00:05 /usr/sbin/haproxy -Ws -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -S /run/haproxy-master.sock\r\nhaproxy   449423  449421  449429  0    2 15:11 ?        00:00:05 /usr/sbin/haproxy -Ws -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -S /run/haproxy-master.sock\r\n```\r\n\r\n**单独测试后端程序处理能力, 确保不存在吞吐量瓶颈**\r\n```\r\nrun at 10.146.0.2\r\n\r\nwrk -t 2 -c 100 -d 10s  http://10.146.0.3:8080/xxx\r\nRunning 10s test @ http://10.146.0.3:8080/xxx\r\n  2 threads and 100 connections\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   520.95us  203.98us   4.09ms   68.03%\r\n    Req/Sec    59.25k     2.68k   63.62k    52.50%\r\n  1179133 requests in 10.00s, 173.17MB read\r\nRequests/sec: 117888.45\r\nTransfer/sec:     17.31MB\r\n```\r\n\r\n为了数据真实性，我只取了 1 次测试结果，连续对 3 个服务测试截图\r\n![]( https://picx.zhimg.com/80/v2-835d6ae5863fb9643e82420ed1a18b1c_1440w.png?source=d16d100b)\r\n\r\n> 对于 nginx 的数据声明一下：只有偶尔能跑到 1.7w 的 qps ，如果 proxy_pass http://10.146.0.3:8080; 换到 127.0.0.1:8080 ，qps 能到 9000 qps ，至于局域网内为什么这么低通过 strace 也没看到异常，而且 cpu 也通跑满，不知道它在干嘛\r\n\r\n\r\n![]( https://pica.zhimg.com/80/v2-d5ae358121a2c93e4544cbea1925a020_1440w.png?source=d16d100b)\r\ntcpdump tcp port 8080 抓包查看 niubix 实际数据，包含 X-Real-IP, XFF ，并且响应在微秒级\r\n\r\n#### 目前具备功能：\r\n* master/worker 模式，worker 采用多线程，支持配置优雅的 Reload(像 nginx 一样)，master 还是守护进程，当 worker 进程异常会马上 fork 一个新的\r\n* 只支持 Linux （将来也不准备跨平台）\r\n* 主体逻辑无锁，简单高效，可靠\r\n* 优雅的 acceptor/connector ，高效实现异步监听+连接\r\n\r\n#### 测试声明\r\n* niubix 仅提供反向代理功能\r\n* niubix 支持 X-Real-IP,  X-Forwarded-For, 其他 Header 并没有解析  \r\n* http parser 只是简单的解析, 并没有完全实现\r\n* 只是初步测试, 并没有做冒烟测试和稳定性测试以及多条件下复杂测试\r\n* niubix 均衡策略使用的是 roundrobin(别的也还没实现呢), nginx/haproxy 也是一样的策略\r\n* backend 测试程序 code\r\n* niubix 不解析 response 内容\r\n* 功能逐步完善中, 基本框架是过硬的, 我相信这是一个好的开始\r\n\r\n#### 接下来开发计划\r\n* Better HTTP parser\r\n* TCP protocol + Proxy Protocol\r\n* Https", "content_rendered": "<h2>NiubiX.</h2>\n<p><a href=\"https://github.com/shaovie/niubix\" rel=\"nofollow\">项目地址</a></p>\n<p>实验性项目，NiubiX 只提供反向代理功能，大家轻拍有不好的地方可以留言或提 issue/pr.  觉得好就点个 star ，我会持续完善它</p>\n<p>与 Nginx/Haproxy 对比测试</p>\n<blockquote>\n<p>Linux 5.19.0-1030-gcp #32~22.04.1-Ubuntu<br/>\nInstacne 1 GCP cloud VM, 2 cores, 4GB RAM 10.146.0.2 (nginx,haproxy, niubix run at here)<br/>\nInstacne 2 GCP cloud VM, 2 cores, 4GB RAM 10.146.0.3 (backend, wrk run at here)  </p>\n</blockquote>\n<p><strong>nginx version config</strong></p>\n<pre><code>nginx version: nginx/1.18.0 (Ubuntu)\n\nserver {\n    listen       8082 reuseport;\n    server_name  localhost;\n\n    access_log  off;\n    error_log off;\n\n    location / {\n        proxy_pass http://10.146.0.3:8080;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n}\n\nroot         516       1  0 Aug24 ?        00:00:00 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;\nwww-data  417322     516  0 12:13 ?        00:00:06 nginx: worker process\nwww-data  417323     516  0 12:13 ?        00:00:08 nginx: worker process\n</code></pre>\n<p><strong>haproxy version config</strong></p>\n<pre><code>HAProxy version 2.4.22-0ubuntu0.22.04.2 2023/08/14\n\nlisten niubix\n    bind 0.0.0.0:8083\n    mode http\n    option forwardfor\n    server s1 10.146.0.3:8080\n\nps -eLf | grep haproxy\nroot      449421       1  449421  0    1 15:11 ?        00:00:00 /usr/sbin/haproxy -Ws -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -S /run/haproxy-master.sock\nhaproxy   449423  449421  449423  0    2 15:11 ?        00:00:05 /usr/sbin/haproxy -Ws -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -S /run/haproxy-master.sock\nhaproxy   449423  449421  449429  0    2 15:11 ?        00:00:05 /usr/sbin/haproxy -Ws -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -S /run/haproxy-master.sock\n</code></pre>\n<p><strong>单独测试后端程序处理能力, 确保不存在吞吐量瓶颈</strong></p>\n<pre><code>run at 10.146.0.2\n\nwrk -t 2 -c 100 -d 10s  http://10.146.0.3:8080/xxx\nRunning 10s test @ http://10.146.0.3:8080/xxx\n  2 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   520.95us  203.98us   4.09ms   68.03%\n    Req/Sec    59.25k     2.68k   63.62k    52.50%\n  1179133 requests in 10.00s, 173.17MB read\nRequests/sec: 117888.45\nTransfer/sec:     17.31MB\n</code></pre>\n<p>为了数据真实性，我只取了 1 次测试结果，连续对 3 个服务测试截图\n<img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://picx.zhimg.com/80/v2-835d6ae5863fb9643e82420ed1a18b1c_1440w.png?source=d16d100b\"/></p>\n<blockquote>\n<p>对于 nginx 的数据声明一下：只有偶尔能跑到 1.7w 的 qps ，如果 proxy_pass <a href=\"http://10.146.0.3:8080%3B\" rel=\"nofollow\">http://10.146.0.3:8080;</a> 换到 127.0.0.1:8080 ，qps 能到 9000 qps ，至于局域网内为什么这么低通过 strace 也没看到异常，而且 cpu 也通跑满，不知道它在干嘛</p>\n</blockquote>\n<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://pica.zhimg.com/80/v2-d5ae358121a2c93e4544cbea1925a020_1440w.png?source=d16d100b\"/>\ntcpdump tcp port 8080 抓包查看 niubix 实际数据，包含 X-Real-IP, XFF ，并且响应在微秒级</p>\n<h4>目前具备功能：</h4>\n<ul>\n<li>master/worker 模式，worker 采用多线程，支持配置优雅的 Reload(像 nginx 一样)，master 还是守护进程，当 worker 进程异常会马上 fork 一个新的</li>\n<li>只支持 Linux （将来也不准备跨平台）</li>\n<li>主体逻辑无锁，简单高效，可靠</li>\n<li>优雅的 acceptor/connector ，高效实现异步监听+连接</li>\n</ul>\n<h4>测试声明</h4>\n<ul>\n<li>niubix 仅提供反向代理功能</li>\n<li>niubix 支持 X-Real-IP,  X-Forwarded-For, 其他 Header 并没有解析  </li>\n<li>http parser 只是简单的解析, 并没有完全实现</li>\n<li>只是初步测试, 并没有做冒烟测试和稳定性测试以及多条件下复杂测试</li>\n<li>niubix 均衡策略使用的是 roundrobin(别的也还没实现呢), nginx/haproxy 也是一样的策略</li>\n<li>backend 测试程序 code</li>\n<li>niubix 不解析 response 内容</li>\n<li>功能逐步完善中, 基本框架是过硬的, 我相信这是一个好的开始</li>\n</ul>\n<h4>接下来开发计划</h4>\n<ul>\n<li>Better HTTP parser</li>\n<li>TCP protocol + Proxy Protocol</li>\n<li>Https</li>\n</ul>\n", "last_modified": 1694507528, "replies": 78, "id": 973075}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/c9f0/f895/8_large.png?m=1630643991", "name": "iphone", "avatar_normal": "https://cdn.v2ex.com/navatar/c9f0/f895/8_normal.png?m=1630643991", "title": "iPhone", "url": "https://www.v2ex.com/go/iphone", "topics": 10393, "footer": "这里绝不讨论如何获得 iPhone 盗版软件、iTunes 黑卡之类。", "header": "Say hello to the future.", "title_alternative": "iPhone", "avatar_mini": "https://cdn.v2ex.com/navatar/c9f0/f895/8_mini.png?m=1630643991", "stars": 3184, "aliases": [], "root": false, "id": 8, "parent_node_name": "apple"}, "member": {"id": 513768, "username": "Arvin0913", "url": "https://www.v2ex.com/u/Arvin0913", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/ef1bf7e6269f3a0cb86d2fe400bad9a6?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/ef1bf7e6269f3a0cb86d2fe400bad9a6?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/ef1bf7e6269f3a0cb86d2fe400bad9a6?s=73&d=retro", "created": 1603245847, "last_modified": 1694566570}, "last_reply_by": "xiangbohua", "last_touched": 1694590790, "title": "关于 iPhone 15 Pro/Max，我只关心一点，运存是不是 8g", "url": "https://www.v2ex.com/t/973212", "created": 1694566671, "deleted": 0, "content": "RT ，有知道运存是多少的吗？", "content_rendered": "RT ，有知道运存是多少的吗？", "last_modified": 1694566671, "replies": 75, "id": 973212}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_large.png?m=1630643913", "name": "apple", "avatar_normal": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_normal.png?m=1630643913", "title": "Apple", "url": "https://www.v2ex.com/go/apple", "topics": 23378, "footer": "", "header": "设计了 <a href=\"/go/watch\">Apple Watch</a>，<a href=\"/go/ipad\">iPad</a>，<a href=\"/go/iphone\">iPhone</a>，<a href=\"/go/imac\">iMac</a> 及 <a href=\"/go/mbp\">MacBook Pro</a> 等电子产品的美国公司。", "title_alternative": "Apple", "avatar_mini": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_mini.png?m=1630643913", "stars": 2693, "aliases": [], "root": false, "id": 184, "parent_node_name": "hardware"}, "member": {"id": 265596, "username": "inhzus", "url": "https://www.v2ex.com/u/inhzus", "website": "https://inhzus.io", "twitter": "", "psn": "", "github": "", "btc": "", "location": "", "tagline": "", "bio": "https://volt.fm/inhzus", "avatar_mini": "https://cdn.v2ex.com/gravatar/6bc21b75d0dd5238771132225361c003?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/6bc21b75d0dd5238771132225361c003?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/6bc21b75d0dd5238771132225361c003?s=73&d=retro", "created": 1510057295, "last_modified": 1694572803}, "last_reply_by": "maemolee", "last_touched": 1694591415, "title": "就连 Type-C 对老用户来说都不见得是升级啊...", "url": "https://www.v2ex.com/t/973294", "created": 1694572855, "deleted": 0, "content": "升级 Type-C 后，又要把家里各个插头、办公室的 lightning 线换一遍\r\n\r\n备注：\r\n1. 只是客观表述需要替换充电线这一事项客观存在；\r\n2. 没有否认 Apple 升级至 Type-C 的进步；\r\n3. 没有表示 Type-C 劣于 lightning 接口，也没有表示两者孰优孰差；\r\n4. 没有说除 Type-C 外就一无是处，这是楼主鄙人能看到最直观的升级；\r\n5. 祝大家生活愉快 = =", "content_rendered": "升级 Type-C 后，又要把家里各个插头、办公室的 lightning 线换一遍<br /><br />备注：<br />1. 只是客观表述需要替换充电线这一事项客观存在；<br />2. 没有否认 Apple 升级至 Type-C 的进步；<br />3. 没有表示 Type-C 劣于 lightning 接口，也没有表示两者孰优孰差；<br />4. 没有说除 Type-C 外就一无是处，这是楼主鄙人能看到最直观的升级；<br />5. 祝大家生活愉快 = =", "last_modified": 1694574590, "replies": 71, "id": 973294}]