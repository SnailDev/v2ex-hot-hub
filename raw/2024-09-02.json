[{"node": {"avatar_large": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_large.png?m=1695370146", "name": "career", "avatar_normal": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_normal.png?m=1695370146", "title": "职场话题", "url": "https://www.v2ex.com/go/career", "topics": 17981, "footer": "", "header": "这里，我们聊聊那些工作中遇到的开心和不开心的事。", "title_alternative": "Career", "avatar_mini": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_mini.png?m=1695370146", "stars": 3220, "aliases": [], "root": false, "id": 770, "parent_node_name": "work"}, "member": {"id": 158991, "username": "airingursb", "url": "https://www.v2ex.com/u/airingursb", "website": "http://ursb.me", "twitter": "airingursb", "psn": "", "github": "airingursb", "btc": "", "location": "", "tagline": "", "bio": "哲学硕士｜小学老师 ｜终端全栈", "avatar_mini": "https://cdn.v2ex.com/avatar/ed7a/7840/158991_mini.png?m=1725164087", "avatar_normal": "https://cdn.v2ex.com/avatar/ed7a/7840/158991_normal.png?m=1725164087", "avatar_large": "https://cdn.v2ex.com/avatar/ed7a/7840/158991_large.png?m=1725164087", "avatar_xlarge": "https://cdn.v2ex.com/avatar/ed7a/7840/158991_xlarge.png?m=1725164087", "avatar_xxlarge": "https://cdn.v2ex.com/avatar/ed7a/7840/158991_xlarge.png?m=1725164087", "avatar_xxxlarge": "https://cdn.v2ex.com/avatar/ed7a/7840/158991_xlarge.png?m=1725164087", "created": 1455591233, "last_modified": 1725164087}, "last_reply_by": "nenseso", "last_touched": 1725246493, "title": "毕业 4 年在 Q 音干到 T11，准备跑路了，谈一谈想法", "url": "https://www.v2ex.com/t/1069344", "created": 1725163973, "deleted": 0, "content": "## 介绍\r\n\r\n23 岁的研一暑假，我在校招实习时加入腾讯音乐，那个时候 TME 还属于腾讯的 SNG 。\r\n\r\n虽然在那之前我已经是一个在 GitHub 活跃了 5 年有余的独立开发者，但是我从未参与过企业级的项目。通知这次实习，我掌握了项目的完整流程，也学习到了对线上的敬畏、对用户个体的关注。\r\n\r\n## 加入时的期望\r\n\r\n在实习之后，我在对鹅厂的这段经历充满热情，加上团队氛围很好，毅然选择留下来，也没有去看其他的机会。\r\n\r\n我想在这里收获尽可能多的技术和成长，想与尽可能多的鹅们建立链接——想体验积极向上的团队氛围，想收获一段独特的人生经历。那时，我对自己的职业规划很简单，三年内到 T9 就可以了。\r\n\r\n那个时候给自己保存了这句歌词，感谢过去的自己：\r\n\r\n![]( https://s2.loli.net/2024/09/01/PngcVblZtesY645.jpg)\r\n\r\n## 职业经历\r\n\r\n实际的经历则曲折很多，我加入互联网行业时恰好是动荡期，立马经历了几年疫情，之后又是裁员浪潮。我的业务和团队在五年间不断变化，我也积极在其中寻求成长的可能性。\r\n\r\n这段期间，我收获了：\r\n\r\n- 充足的报酬，以及成为鹅厂员工的满足感\r\n- 软件工程技能，现在基本上任何一个需求抛过来能立马抛出它的实现方案\r\n- 问题处理能力，在问题定位上形成了自己的一套方法论，得到同事之间认可\r\n- 高效、有序的规划能力，繁杂的工作培养出来的业务能力，最多同时手上并行七个需求仍然井井有条\r\n- 坚定的工作态度，培养了在工作时保持专注的能力，在工作中几乎能付出百分百的精力和责任感\r\n- 钻研的精神，对各端技术都有较为深度的理解，始终保持热爱和好奇\r\n- 沟通与协调能力，越到后期越注重这个软能力项，在过程中负责过紧迫的大项目，同时协调将近 10 个团队配合项目工作\r\n- 数据分析能力，生涯中培养了对业务的敏感度，对基本数据有直观上的归因能力，在更深的挖掘能力上也得到了培\r\n\r\n![]( https://s2.loli.net/2024/09/01/f6MNCuosO2mnyAV.jpg)\r\n\r\n但也有我不满意的：\r\n\r\n- 对大厂开始祛魅\r\n- 团建假期没有了\r\n- 没有机会培养管理经验，个人成长机会有些不明朗\r\n- 等等其他不说了\r\n\r\n## 自我反思\r\n\r\n哪些地方进展顺利：\r\n\r\n- 我晋升很快，两年 T10 、四年 T11 ，绩效让我几乎一直走绿色通道，三次答辩也是 Top1 ，保持着百分百的通过率\r\n- 以 T11 作为这段经历的结束已经超预期了\r\n- 收获了很多出来后不知道有什么用的奖项\r\n- 负责过 4 个核心项目，而且分别在不同的技术领域\r\n- 软技能得到了培养和提升，包括沟通、汇报、技术分享等\r\n\r\n哪些地方做的不好：\r\n\r\n- 主动性在后期逐渐减弱，工作激情在身边人逐渐离职后开始消磨\r\n- 推动性较弱，顾及形象，但这点后来想通了，如果都是为了同一个目标奋斗的话，那么对事不对人就好\r\n\r\n幸运之处：\r\n\r\n- 初期团队的包容和友善\r\n- 和设计师合作，写了很多专利\r\n- 绩效不错\r\n- 领导们也都很好\r\n- 接触到了很多不同形态的业务\r\n- 职业生涯中有半数以上的时间专注技术\r\n- 得到机会接触并负责不错的技术项目，包括跨端项目以及后续的渲染引擎项目，有机会负责 iOS 项目和 C++ 工程，在前端领域得到了扩展和转型\r\n\r\n如果重来，我有什么可以改变的：\r\n\r\n- 做更多的技术输出，目前个人的技术输出偏少了\r\n- 付出一部分精力在工作之外的技术探索上\r\n\r\n> 更多内容和关于未来规划，可见我昨晚发的博客 [《再见了，盛夏》]( https://blog.ursb.me/posts/2024-summer/)", "content_rendered": "<h2>介绍</h2>\n<p>23 岁的研一暑假，我在校招实习时加入腾讯音乐，那个时候 TME 还属于腾讯的 SNG 。</p>\n<p>虽然在那之前我已经是一个在 GitHub 活跃了 5 年有余的独立开发者，但是我从未参与过企业级的项目。通知这次实习，我掌握了项目的完整流程，也学习到了对线上的敬畏、对用户个体的关注。</p>\n<h2>加入时的期望</h2>\n<p>在实习之后，我在对鹅厂的这段经历充满热情，加上团队氛围很好，毅然选择留下来，也没有去看其他的机会。</p>\n<p>我想在这里收获尽可能多的技术和成长，想与尽可能多的鹅们建立链接——想体验积极向上的团队氛围，想收获一段独特的人生经历。那时，我对自己的职业规划很简单，三年内到 T9 就可以了。</p>\n<p>那个时候给自己保存了这句歌词，感谢过去的自己：</p>\n<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://s2.loli.net/2024/09/01/PngcVblZtesY645.jpg\"/></p>\n<h2>职业经历</h2>\n<p>实际的经历则曲折很多，我加入互联网行业时恰好是动荡期，立马经历了几年疫情，之后又是裁员浪潮。我的业务和团队在五年间不断变化，我也积极在其中寻求成长的可能性。</p>\n<p>这段期间，我收获了：</p>\n<ul>\n<li>充足的报酬，以及成为鹅厂员工的满足感</li>\n<li>软件工程技能，现在基本上任何一个需求抛过来能立马抛出它的实现方案</li>\n<li>问题处理能力，在问题定位上形成了自己的一套方法论，得到同事之间认可</li>\n<li>高效、有序的规划能力，繁杂的工作培养出来的业务能力，最多同时手上并行七个需求仍然井井有条</li>\n<li>坚定的工作态度，培养了在工作时保持专注的能力，在工作中几乎能付出百分百的精力和责任感</li>\n<li>钻研的精神，对各端技术都有较为深度的理解，始终保持热爱和好奇</li>\n<li>沟通与协调能力，越到后期越注重这个软能力项，在过程中负责过紧迫的大项目，同时协调将近 10 个团队配合项目工作</li>\n<li>数据分析能力，生涯中培养了对业务的敏感度，对基本数据有直观上的归因能力，在更深的挖掘能力上也得到了培</li>\n</ul>\n<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://s2.loli.net/2024/09/01/f6MNCuosO2mnyAV.jpg\"/></p>\n<p>但也有我不满意的：</p>\n<ul>\n<li>对大厂开始祛魅</li>\n<li>团建假期没有了</li>\n<li>没有机会培养管理经验，个人成长机会有些不明朗</li>\n<li>等等其他不说了</li>\n</ul>\n<h2>自我反思</h2>\n<p>哪些地方进展顺利：</p>\n<ul>\n<li>我晋升很快，两年 T10 、四年 T11 ，绩效让我几乎一直走绿色通道，三次答辩也是 Top1 ，保持着百分百的通过率</li>\n<li>以 T11 作为这段经历的结束已经超预期了</li>\n<li>收获了很多出来后不知道有什么用的奖项</li>\n<li>负责过 4 个核心项目，而且分别在不同的技术领域</li>\n<li>软技能得到了培养和提升，包括沟通、汇报、技术分享等</li>\n</ul>\n<p>哪些地方做的不好：</p>\n<ul>\n<li>主动性在后期逐渐减弱，工作激情在身边人逐渐离职后开始消磨</li>\n<li>推动性较弱，顾及形象，但这点后来想通了，如果都是为了同一个目标奋斗的话，那么对事不对人就好</li>\n</ul>\n<p>幸运之处：</p>\n<ul>\n<li>初期团队的包容和友善</li>\n<li>和设计师合作，写了很多专利</li>\n<li>绩效不错</li>\n<li>领导们也都很好</li>\n<li>接触到了很多不同形态的业务</li>\n<li>职业生涯中有半数以上的时间专注技术</li>\n<li>得到机会接触并负责不错的技术项目，包括跨端项目以及后续的渲染引擎项目，有机会负责 iOS 项目和 C++ 工程，在前端领域得到了扩展和转型</li>\n</ul>\n<p>如果重来，我有什么可以改变的：</p>\n<ul>\n<li>做更多的技术输出，目前个人的技术输出偏少了</li>\n<li>付出一部分精力在工作之外的技术探索上</li>\n</ul>\n<blockquote>\n<p>更多内容和关于未来规划，可见我昨晚发的博客 <a href=\"https://blog.ursb.me/posts/2024-summer/\" rel=\"nofollow\">《再见了，盛夏》</a></p>\n</blockquote>\n", "last_modified": 1725176210, "replies": 93, "id": 1069344}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340", "name": "qna", "avatar_normal": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340", "title": "问与答", "url": "https://www.v2ex.com/go/qna", "topics": 222496, "footer": "", "header": "一个更好的世界需要你持续地提出好问题。", "title_alternative": "Questions and Answers", "avatar_mini": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340", "stars": 4229, "aliases": [], "root": false, "id": 12, "parent_node_name": "v2ex"}, "member": {"id": 17019, "username": "ayang23", "url": "https://www.v2ex.com/u/ayang23", "website": "ayang.github.io", "twitter": "", "psn": "", "github": "ayang23", "btc": "", "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/597a/335c/17019_mini.png?m=1362458874", "avatar_normal": "https://cdn.v2ex.com/avatar/597a/335c/17019_normal.png?m=1362458874", "avatar_large": "https://cdn.v2ex.com/avatar/597a/335c/17019_large.png?m=1362458874", "created": 1329957029, "last_modified": 1362458874}, "last_reply_by": "heavenx", "last_touched": 1725245770, "title": "家有学生，需要打印的资料非常多，哪款激光打印机性价比高？主要考虑耗材，平均大概几毛一页？", "url": "https://www.v2ex.com/t/1069342", "created": 1725163101, "deleted": 0, "content": "", "content_rendered": "", "last_modified": 1725163175, "replies": 63, "id": 1069342}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_large.png?m=1695370146", "name": "career", "avatar_normal": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_normal.png?m=1695370146", "title": "职场话题", "url": "https://www.v2ex.com/go/career", "topics": 17981, "footer": "", "header": "这里，我们聊聊那些工作中遇到的开心和不开心的事。", "title_alternative": "Career", "avatar_mini": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_mini.png?m=1695370146", "stars": 3220, "aliases": [], "root": false, "id": 770, "parent_node_name": "work"}, "member": {"id": 324508, "username": "itskingname", "url": "https://www.v2ex.com/u/itskingname", "website": "", "twitter": "", "psn": "", "github": "", "btc": "", "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/5469/969b/324508_mini.png?m=1532149726", "avatar_normal": "https://cdn.v2ex.com/avatar/5469/969b/324508_normal.png?m=1532149726", "avatar_large": "https://cdn.v2ex.com/avatar/5469/969b/324508_large.png?m=1532149726", "created": 1529883749, "last_modified": 1532149726}, "last_reply_by": "Link99", "last_touched": 1725246493, "title": "大家身边有没有这样的同事，喜欢把你的话重复一遍？", "url": "https://www.v2ex.com/t/1069513", "created": 1725243487, "deleted": 0, "content": "例如：\r\n\r\n```\r\n他：你中午在哪里吃的饭？\r\n我：我在楼下云南米线吃的\r\n他：你在楼下云南米线吃的是吧？\r\n\r\n他：这个 bug 是什么问题导致的？\r\n我：AWS 那边数据中心网络挂了，已经提工单。\r\n他：AWS 那边数据中心网络挂了，已经提工单是吧？\r\n\r\n他：你周末怎么过的？\r\n我：我在家打了一天游戏。\r\n他：你在家打了一天游戏是吧。\r\n……\r\n```\r\n\r\n\r\n基本上任何一个问题，他问了我，我回复以后，他都会重复一遍，再加上『是吧』。好像不这样反问，就不能理解我的回答一样。", "content_rendered": "<p>例如：</p>\n<pre><code>他：你中午在哪里吃的饭？\n我：我在楼下云南米线吃的\n他：你在楼下云南米线吃的是吧？\n\n他：这个 bug 是什么问题导致的？\n我：AWS 那边数据中心网络挂了，已经提工单。\n他：AWS 那边数据中心网络挂了，已经提工单是吧？\n\n他：你周末怎么过的？\n我：我在家打了一天游戏。\n他：你在家打了一天游戏是吧。\n……\n</code></pre>\n<p>基本上任何一个问题，他问了我，我回复以后，他都会重复一遍，再加上『是吧』。好像不这样反问，就不能理解我的回答一样。</p>\n", "last_modified": 1725246146, "replies": 50, "id": 1069513}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_large.png?m=1691642161", "name": "bb", "avatar_normal": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_normal.png?m=1691642161", "title": "宽带症候群", "url": "https://www.v2ex.com/go/bb", "topics": 16115, "footer": "", "header": "网速很重要。比快更快。", "title_alternative": "Broadband Symptom Complex", "avatar_mini": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_mini.png?m=1691642161", "stars": 7523, "aliases": [], "root": false, "id": 108, "parent_node_name": "geek"}, "member": {"id": 598573, "username": "ABCDEFAA", "url": "https://www.v2ex.com/u/ABCDEFAA", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/gravatar/40afd53ef7298de9ff7f6b070f95839d?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/40afd53ef7298de9ff7f6b070f95839d?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/40afd53ef7298de9ff7f6b070f95839d?s=73&d=retro", "created": 1666459604, "last_modified": 1666459604}, "last_reply_by": "WhiteDragon96", "last_touched": 1725246010, "title": "深圳电信宽带老用户如狗 169 300M 到底还要不要留着", "url": "https://www.v2ex.com/t/1069383", "created": 1725178155, "deleted": 0, "content": "RT 装了 10 年的宽带还是 169 300M 资费降不下来\r\n网上找了个 99 300M 但是没有公网 IP 每个月可以省 70\r\n\r\n另外一个方法是跨省办理宽带 39+30=100M 39+60=300M 39+100=1000M \r\n到底选哪个", "content_rendered": "<p>RT 装了 10 年的宽带还是 169 300M 资费降不下来\n网上找了个 99 300M 但是没有公网 IP 每个月可以省 70</p>\n<p>另外一个方法是跨省办理宽带 39+30=100M 39+60=300M 39+100=1000M\n到底选哪个</p>\n", "last_modified": 1725178155, "replies": 48, "id": 1069383}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1700771269", "name": "programmer", "avatar_normal": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1700771269", "title": "程序员", "url": "https://www.v2ex.com/go/programmer", "topics": 63979, "footer": "", "header": "While code monkeys are not eating bananas, they're coding.", "title_alternative": "Programmer", "avatar_mini": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1700771269", "stars": 9074, "aliases": [], "root": false, "id": 300, "parent_node_name": "computer"}, "member": {"id": 5055, "username": "sdjl", "url": "https://www.v2ex.com/u/sdjl", "website": "", "twitter": "", "psn": "", "github": "", "btc": "", "location": "贵州安顺", "tagline": "微信云开发布道师，接小程序外包项目。", "bio": "专注微信小程序云开发，腾讯官方布道师，定期为腾讯公众号供稿，见帖子： \r\n https://www.v2ex.com/t/1065470\r\n\r\n注意，我直接定制开发，套模板和二次开发不做。\r\n\r\n小程序案例：“绘图助手”", "avatar_mini": "https://cdn.v2ex.com/avatar/be6a/d876/5055_mini.png?m=1724731250", "avatar_normal": "https://cdn.v2ex.com/avatar/be6a/d876/5055_normal.png?m=1724731250", "avatar_large": "https://cdn.v2ex.com/avatar/be6a/d876/5055_large.png?m=1724731250", "created": 1294652197, "last_modified": 1724731250}, "last_reply_by": "ganbuliao", "last_touched": 1725246517, "title": "5 个前端 JS 函数，只为了优雅解决 a.b.c.d = 1 问题", "url": "https://www.v2ex.com/t/1069443", "created": 1725201621, "deleted": 0, "content": "## 前言\r\n\r\n最近更新了我的系列文章，其中有一部分是**关于 JavaScript 语言中“点表示法”的使用**。\r\n\r\n文章中有 5 个工具函数是纯`JavaScript`的，我觉得不仅仅是小程序项目用得上，**其他前端 JS 项目也应该用得上**。\r\n\r\n我把文章中的这一部分单独整理出来，**给需要写前端代码的朋友参考参考**。\r\n\r\n你可以直接在 [Github 项目]( https://github.com/sdjl/WxMpCloudBooster) 中的前端 `utils.js` 文件中找到这 5 个工具函数。\r\n\r\n下面是文章节选，完整的文章列表可以在 [Github 项目]( https://github.com/sdjl/WxMpCloudBooster) 中查看。\r\n\r\n## 点表示法`a.b.c`\r\n\r\n### 用点表示法给对象赋值：`putValue`函数\r\n\r\n想象一下，如果`a`是一个对象，你要给`a.b.c.d`赋值为 1 ，你会这样写？\r\n\r\n```javascript\r\nlet a // 通过某种方式获得的对象\r\nif (!a.b) {\r\n  a.b = {}\r\n}\r\nif (!a.b.c) {\r\n  a.b.c = {}\r\n}\r\na.b.c.d = 1\r\n```\r\n\r\n拜托，大学生才这样写。为此，我们引入了`putValue`函数：\r\n\r\n```javascript\r\nutils.putValue(a, 'b.c.d', 1)\r\n```\r\n\r\n`putValue`函数会自动创建`a.b`、`a.b.c`中间对象，它的声明如下：\r\n\r\n```javascript\r\n/**\r\n* 向对象中按照路径赋值，如果路径上的中间对象不存在，则自动创建。\r\n* @param {Object} obj - 目标对象。\r\n* @param {string} key - 属性路径，支持'a.b.c'形式。\r\n* @param {*} value - 要设置的值。\r\n* @param {Object} [options={}] - 可选参数。\r\n*   - {boolean} remove_undefined - 如果为 true 且 value 为 undefined ，则删除该属性。\r\n* @throws {Error} 如果 obj 为 null 或 undefined ，或路径不合法（如中间非对象）则抛出异常。\r\n*/\r\nputValue(obj, key, value, {remove_undefined = true} = {}){\r\n  // ...\r\n}\r\n```\r\n\r\n使用这个函数有两个地方要注意，一个是如果路径上的中间对象不是对象，会抛出异常。例如`a.b=2`，这里`b`不是对象，此时会抛出异常。\r\n\r\n另一个是如果`value`是`undefined`，则会删除该属性。例如下面的代码：\r\n\r\n```javascript\r\nutils.putValue(a, 'b.c.d', undefined)\r\nconsole.log(a) // {b: {c: {}}}，putValue 会自动创建中间对象，但不会自动删除空对象\r\n```\r\n\r\n但若你真想赋值为`undefined`，可设置`remove_undefined`参数为`false`。\r\n\r\n\r\n### 读取对象属性值：`pickValue`函数\r\n\r\n对应的，如果要获取`a.b.c.d`的值，可以使用`pickValue`函数：\r\n\r\n```javascript\r\nutils.putValue(a, 'b.c.d', 1)\r\nconst value = utils.pickValue(a, 'b.c.d')\r\nconsole.log(value) // 1\r\n```\r\n\r\n当然你也可以直接使用`javascript`的原生语法：\r\n\r\n```javascript\r\nconst value = a.b?.c?.d\r\n```\r\n\r\n这两种写法，当中间路径不存在时，均会返回`undefined`。\r\n\r\n但`a.b?.c?.d`这种写法是硬编码，而在实际开发中路径可能是动态的。例如用户要修改一个配置项，这个配置可能是`user_config.font.size`也可能是`user_config.page.color.background`，如果使用硬编码的方式，可能会写出这样的代码：\r\n\r\n```javascript\r\nif (key === 'font.size') {\r\n  user_config.font.size = value\r\n} else if (key === 'page.color.background') {\r\n  user_config.page.color.background = value\r\n}\r\n// 更多的 if 语句...\r\n```\r\n\r\n这样写显然不够优雅，看看`putValue`与`pickValue`的组合用法。\r\n\r\n\r\n```javascript\r\n// 写入用户配置：\r\nutils.putValue(user_config, key, value)\r\n\r\n// 读取用户配置\r\nconst value = utils.pickValue(user_config, key)\r\n```\r\n\r\n不管`key`怎么变，一句话搞定，感觉一下子和大学生拉开差距了是吧？\r\n\r\n\r\n### 向数组末尾添加元素：`pushValue`函数\r\n\r\n在实际开发中，常有向数组末尾添加数据的需求。例如记录用户最近的评论，此时你可以使用`pushValue`函数：\r\n\r\n```javascript\r\nconst user_data = {} // 用户数据\r\nlet comment = {content: '顶'} // 用户的评论\r\n\r\nutils.pushValue(user_data, `articles.recent_comments`, comment)\r\n\r\nconsole.log(user_data) // {articles: {recent_comments: [{content: '顶'}]}}\r\n```\r\n\r\n在上面代码中，`pushValue`函数先是自动创建了`user_data.articles.recent_comments`数组，然后把`comment`添加到数组末尾。`pushValue`函数的声明如下：\r\n\r\n```javascript\r\n/**\r\n * 将值推入对象指定路径的数组中，若路径或数组不存在则自动创建。\r\n * @param {Object} obj - 目标对象。\r\n * @param {string} key - 数组属性的路径，支持'a.b.c'形式。\r\n * @param {*} value - 要推入的值。\r\n * @throws {Error} 如果路径不是数组，则抛出异常。\r\n */\r\npushValue(obj, key, value){\r\n  // ...\r\n}\r\n```\r\n\r\n再次调用此函数，数组中就会有两个评论：\r\n\r\n```javascript\r\ncomment = {content: '再顶'}\r\n\r\nutils.pushValue(user_data, `articles.recent_comments`, comment)\r\n\r\nconsole.log(user_data) // {articles: {recent_comments: [{content: '顶'}, {content: '再顶'}]}}\r\n```\r\n\r\n### 向对象中添加多个属性：`putObj`函数\r\n\r\n前面我们使用`putValue`函数向`obj`对象写入了一个属性值，但如果你要写入很多个（例如 100 个）属性值，你可能会使用`for`循环：\r\n\r\n```javascript\r\nlet user_config = {}\r\nlet new_config_keys // 100 个新的配置项（数组）\r\nlet new_config_values // 对应的 100 个值（数组）\r\n\r\nfor (let i = 0; i < new_config_keys.length; i++) {\r\n  utils.putValue(user_config, new_config_keys[i], new_config_values[i])\r\n}\r\n```\r\n\r\n这样写没问题，但在实战中，你拿到的用户配置往往不是数组的形式，而很可能是一个对象，例如：\r\n\r\n```javascript\r\nlet new_config = {\r\n  font: {\r\n    size: 16,\r\n    'family.first': 'Arial',\r\n    'family.second': 'sans-serif',\r\n  },\r\n  'page.color.background': '#fff',\r\n  // ...\r\n}\r\n\r\n// 你对拿到的配置数据又进一步处理\r\nnew_config.update_time = new Date()\r\n```\r\n\r\n这种情况下你可以使用`putObj`函数一次性写入多个属性值：\r\n\r\n```javascript\r\nutils.putObj(user_config, new_config)\r\n\r\nconsole.log(user_config)\r\n\r\n/* 输出如下：\r\n{\r\n  font: {\r\n    size: 16,\r\n    family: {\r\n      first: 'Arial',\r\n      second: 'sans-serif'\r\n    }\r\n  },\r\n  page: {\r\n    color: {\r\n      background: '#fff'\r\n    }\r\n  },\r\n  update_time: '...',\r\n}\r\n*/\r\n```\r\n\r\n**注意`putObj`会自动处理上面`new_config`变量中各种路径的写法**。`putObj`函数的声明如下：\r\n\r\n```javascript\r\n/**\r\n * 将一个对象的所有属性按路径添加到另一个对象中。\r\n * @param {Object} obj - 目标对象。\r\n * @param {Object} obj_value - 要添加的属性对象，键支持'a.b.c'形式的路径。\r\n * @param {Object} [options={}] - 可选参数。\r\n *   - {boolean} remove_undefined - 如果为 true 且 value 为 undefined ，则删除该属性。\r\n * @throws {Error} 如果 obj 为 null 或 undefined ，或路径不合法（如中间非对象）则抛出异常。\r\n *\r\n * 注意\r\n *   若 obj_value 中出现重复路径，则后者会覆盖前者。\r\n *   如 obj_value = {a: {b: 1}, 'a.b': 2}，则结果为 {a: {b: 2}}\r\n */\r\nputObj(obj, obj_value, { remove_undefined = true} = {}) {\r\n  // ...\r\n}\r\n```\r\n\r\n### 从对象中获取多个属性：`pickObj`函数\r\n\r\n同样的，我们可以一次性读取多个对象的属性值。例如虽然小程序中的用户配置非常复杂，但当前页面仅关注背景颜色、字体大小等少量配置项，你可以这样使用`pickObj`函数：\r\n\r\n```javascript\r\nlet user_config // 某个用户的所有配置\r\n\r\n// 本页面需要关注的配置\r\nconst keys = ['page.color.background', 'font.size', 'font.family']\r\n\r\n// 获取当前页面需要的配置\r\nconst curr_config = utils.pickObj(user_config, keys)\r\n\r\nconsole.log(curr_config)\r\n\r\n/* 输出如下：\r\n{\r\n  'page.color.background': '#fff',\r\n  'font.size': 16,\r\n  'font.family': {\r\n    first: 'Arial',\r\n    second: 'sans-serif'\r\n  }\r\n}\r\n*/\r\n\r\nconsole.log(curr_config.font) // undefined\r\n```\r\n\r\n注意，传给`pickObj`函数的第二个参数是一个字符串数组，而不是对象。并且，`pickObj`返回的对象中，属性值不是以`curr_config.font.size`这样的形式返回，而是返回`curr_config['font.size']`。\r\n\r\n当然，如果你想要`curr_config.font.size`这样的形式，可用`putObj`转换一下：\r\n\r\n```javascript\r\nlet obj_config = utils.putObj({}, curr_config)\r\n\r\nconsole.log(obj_config.font.size) // 16\r\n```\r\n\r\n\r\n## 点表示法在微信小程序中实战演示\r\n\r\n为什么要设计这几个函数？为什么要支持`config.a.b.c`与`config['a.b.c']`两种写法混用？为什么传给`putObj`的第二个参数是对象，而传给`pickObj`的第二个参数是字符串数组？为什么`pickObj`返回的对象属性值不是`config.a.b.c`这样的形式，而是`config['a.b.c']`？\r\n\r\n因为这样设计符合实战需求，**一句话解释就是：“这样好用”**。\r\n\r\n下面我们通过几个案例来演示这些函数在实战中的应用。\r\n\r\n\r\n### 在 js 中设置用户配置\r\n\r\n假设用户首次打开小程序，你需要设置用户默认字体大小为 16 ，背景颜色为白色。可以这样写：\r\n\r\n```javascript\r\nlet user_config = {}\r\nutils.putValue(user_config, 'font.size', 16)\r\nutils.putValue(user_config, 'page.color.background', '#fff')\r\n```\r\n\r\n使用`putValue`设置后，你想修改字体大小和背景颜色？可以这样写：\r\n\r\n```javascript\r\nuser_config.font.size = 18\r\nuser_config.page.color.background = '#000'\r\n```\r\n\r\n### 在 wxml 中实现修改用户配置\r\n\r\n你可能会在 wxml 页面中实现多个配置项的修改，并且使用同一个函数来处理。这时你可以这样写：\r\n\r\n```html\r\n<button bind:tap=\"changeConfig\" data-key=\"font.size\" value=\"16\" >\r\n<button bind:tap=\"changeConfig\" data-key=\"page.color.background\" value=\"#fff\">\r\n```\r\n\r\n```javascript\r\nchangeConfig(e){\r\n  const { user_config } = this.data\r\n  const { key, value } = e.currentTarget.dataset\r\n\r\n  // 从 wxml 中获得点表示法的 key 字符串，直接调用 putValue 函数\r\n  utils.putValue(user_config, key, value)\r\n\r\n  // 修改背景色时顺便改一下字体颜色（两种写法混用）\r\n  if (key === 'page.color.background' && value === '#fff') {\r\n    user_config.page.color.font_color = '#000'\r\n  }\r\n\r\n  // 记录最近修改时间\r\n  user_config.update_time = new Date()\r\n}\r\n```\r\n\r\n### 在 wxml 中使用用户配置\r\n\r\n要在页面中使用`page.color.background`与`page.color.font_color`的值，实现根据用户配置显示不同的颜色，可以这样写：\r\n\r\n```html\r\n<view style=\"background-color: {{color.background}}\">\r\n  <text style=\"color: {{color.font_color}}\">\r\n      Hello, WxMpCloudBooster!\r\n  </text>\r\n</view>\r\n```\r\n\r\n```javascript\r\nonLoad(){\r\n  const { user_config } = this.data\r\n  const color = utils.pickValue(user_config, 'page.color')\r\n  this.setData({color})\r\n}\r\n```\r\n\r\n你看，我们传递给`pickValue`的`key`根据实际需求可长可短。\r\n\r\n\r\n### 初始化默认的用户配置\r\n\r\n你希望为每个用户设置一个默认的用户配置，并且你想用常规方式写（不使用点表示法）。可以这样：\r\n\r\n```javascript\r\n// 默认配置\r\nconst DEFAULT_CONFIG = {\r\n  font: {\r\n    size: 16,\r\n  },\r\n  page: {\r\n    color: {\r\n      background: '#fff',\r\n      font_color: '#000'\r\n    }\r\n  },\r\n  // 这里也可以使用点表示法 a.b.c ，但你不想这样写...\r\n}\r\n\r\nApp({\r\n  initConfig(){\r\n    let { user_config } = this.data\r\n    utils.putObj(user_config, DEFAULT_CONFIG) // user_config 的其他值会被保留\r\n    // 保存用户配置...\r\n  }\r\n})\r\n```\r\n\r\n注意，上面代码中`user_config`可能会有其他没有出现在`DEFAULT_CONFIG`中的配置项，这些配置项会被保留。\r\n\r\n\r\n### 记录用户最近发表的内容\r\n\r\n假如你已经实现了“记录用户最近发布的评论”功能，代码如下：\r\n\r\n```html\r\n<button bind:tap=\"append\" data-key=\"articles.recent_comments\" data-prop=\"comment\" >\r\n```\r\n\r\n当用户点击这个按钮时，假设`this.data`中已经有一个`comment`对象，你可以这样添加评论：\r\n\r\n```javascript\r\nappend(e){\r\n  const { user_data } = this.data\r\n  const { key, prop } = e.currentTarget.dataset\r\n  const value = this.data[prop] // prop === \"comment\"\r\n\r\n  utils.pushValue(user_data, key, value) // 注意这里用的是 push\r\n}\r\n```\r\n\r\n上面这个`append`函数会把`this.data.comment`对象添加到`user_data.articles.recent_comments`数组的末尾。\r\n\r\n然后，此时你希望再增加一个按钮，可以把最近的点赞数据`this.data.like`添加到`user_data.articles.recent_likes`数组的末尾，那么只需一句：\r\n\r\n```html\r\n<button bind:tap=\"append\" data-key=\"articles.recent_likes\" data-prop=\"like\" >\r\n```\r\n\r\n完成了，你不需要修改`append`函数，只需要给`data-key`和`data-prop`属性设置不同的值即可。\r\n\r\n可见，**点表示法很大的目的是为了在`wxml`中可以方便地指定路径，并在`js`中方便地处理这些路径。**\r\n\r\n\r\n### 在页面中修改多个配置项\r\n\r\n假设你有一个修改用户配置项的页面，`wxml`代码如下：\r\n\r\n```html\r\n<!-- 注意这里有一个 for 循环 -->\r\n<view wx:for=\"{{configs}}\">\r\n  配置名称：{{item.title}}\r\n  当前值：{{item.value}}\r\n  输入新值：<input type=\"text\" />\r\n  点击修改：<button bind:tap=\"changeConfig\"/>\r\n</view>\r\n```\r\n\r\n上面代码使用了`for`循环，`configs`变量中有多少个值，就会显示多少个配置项。\r\n\r\n为了实现在用户打开页面时显示的是用户的当前值（而不是默认值），你还需要从`user_config`中读取当前用户的配置值。\r\n\r\n代码样例如下：\r\n\r\n```javascript\r\n// 代码中写死了需要修改的配置项以及默认值\r\nconfigs = [\r\n  {title: '字体大小', key: 'font.size', value: 16},\r\n  {title: '背景颜色', key: 'page.color.background', value: '#fff'},\r\n  {title: '字体颜色', key: 'page.color.font_color', value: '#000'},\r\n]\r\n\r\n// 读取当前用户的配置值\r\nconst uc_obj = utils.pickObj(user_config, configs.map(item => item.key))\r\n\r\n// 注意，这里的 uc_obj 是 uc_obj['font.size'] 这样的形式，而不是 uc_obj.font.size\r\n\r\n// 用户当前值覆盖默认值\r\nconfigs.forEach(item => {\r\n  if (uc_obj[item.key] !== undefined) {\r\n    item.value = uc_obj[item.key]\r\n  }\r\n})\r\n\r\nthis.setData({configs}) // 传给 wxml 页面显示\r\n```\r\n\r\n这样你就实现了修改多个配置项的页面，用户打开页面时显示的是用户当前的配置值。\r\n\r\n*提问：假设我们坚决不使用点表示法，且要实现上面这些功能，你要如何设计才能如此简单、高效？*\r\n\r\n\r\n### 让你的函数也支持点表示法\r\n\r\n好了，目前我们花了不少篇幅介绍点表示法，这是因为**后面我们会介绍更多的工具函数，而这些工具函数都支持点表示法的调用方式**。\r\n\r\n当你编写自己的工具函数时，你可以调用`putValue`、`pickValue`、`pushValue`、`putObj`、`pickObj`这 5 个函数，**轻松地让你的工具函数也支持点表示法**。如果你不知道如何实现，可以参考`utils.js`中其他函数的代码。\r\n\r\n**（文章节选完，如果你感兴趣的话可以看看 [Github 项目]( https://github.com/sdjl/WxMpCloudBooster)）**", "content_rendered": "<h2>前言</h2>\n<p>最近更新了我的系列文章，其中有一部分是<strong>关于 JavaScript 语言中“点表示法”的使用</strong>。</p>\n<p>文章中有 5 个工具函数是纯<code>JavaScript</code>的，我觉得不仅仅是小程序项目用得上，<strong>其他前端 JS 项目也应该用得上</strong>。</p>\n<p>我把文章中的这一部分单独整理出来，<strong>给需要写前端代码的朋友参考参考</strong>。</p>\n<p>你可以直接在 <a href=\"https://github.com/sdjl/WxMpCloudBooster\" rel=\"nofollow\">Github 项目</a> 中的前端 <code>utils.js</code> 文件中找到这 5 个工具函数。</p>\n<p>下面是文章节选，完整的文章列表可以在 <a href=\"https://github.com/sdjl/WxMpCloudBooster\" rel=\"nofollow\">Github 项目</a> 中查看。</p>\n<h2>点表示法<code>a.b.c</code></h2>\n<h3>用点表示法给对象赋值：<code>putValue</code>函数</h3>\n<p>想象一下，如果<code>a</code>是一个对象，你要给<code>a.b.c.d</code>赋值为 1 ，你会这样写？</p>\n<pre><code class=\"language-javascript\">let a // 通过某种方式获得的对象\nif (!a.b) {\n  a.b = {}\n}\nif (!a.b.c) {\n  a.b.c = {}\n}\na.b.c.d = 1\n</code></pre>\n<p>拜托，大学生才这样写。为此，我们引入了<code>putValue</code>函数：</p>\n<pre><code class=\"language-javascript\">utils.putValue(a, 'b.c.d', 1)\n</code></pre>\n<p><code>putValue</code>函数会自动创建<code>a.b</code>、<code>a.b.c</code>中间对象，它的声明如下：</p>\n<pre><code class=\"language-javascript\">/**\n* 向对象中按照路径赋值，如果路径上的中间对象不存在，则自动创建。\n* @param {Object} obj - 目标对象。\n* @param {string} key - 属性路径，支持'a.b.c'形式。\n* @param {*} value - 要设置的值。\n* @param {Object} [options={}] - 可选参数。\n*   - {boolean} remove_undefined - 如果为 true 且 value 为 undefined ，则删除该属性。\n* @throws {Error} 如果 obj 为 null 或 undefined ，或路径不合法（如中间非对象）则抛出异常。\n*/\nputValue(obj, key, value, {remove_undefined = true} = {}){\n  // ...\n}\n</code></pre>\n<p>使用这个函数有两个地方要注意，一个是如果路径上的中间对象不是对象，会抛出异常。例如<code>a.b=2</code>，这里<code>b</code>不是对象，此时会抛出异常。</p>\n<p>另一个是如果<code>value</code>是<code>undefined</code>，则会删除该属性。例如下面的代码：</p>\n<pre><code class=\"language-javascript\">utils.putValue(a, 'b.c.d', undefined)\nconsole.log(a) // {b: {c: {}}}，putValue 会自动创建中间对象，但不会自动删除空对象\n</code></pre>\n<p>但若你真想赋值为<code>undefined</code>，可设置<code>remove_undefined</code>参数为<code>false</code>。</p>\n<h3>读取对象属性值：<code>pickValue</code>函数</h3>\n<p>对应的，如果要获取<code>a.b.c.d</code>的值，可以使用<code>pickValue</code>函数：</p>\n<pre><code class=\"language-javascript\">utils.putValue(a, 'b.c.d', 1)\nconst value = utils.pickValue(a, 'b.c.d')\nconsole.log(value) // 1\n</code></pre>\n<p>当然你也可以直接使用<code>javascript</code>的原生语法：</p>\n<pre><code class=\"language-javascript\">const value = a.b?.c?.d\n</code></pre>\n<p>这两种写法，当中间路径不存在时，均会返回<code>undefined</code>。</p>\n<p>但<code>a.b?.c?.d</code>这种写法是硬编码，而在实际开发中路径可能是动态的。例如用户要修改一个配置项，这个配置可能是<code>user_config.font.size</code>也可能是<code>user_config.page.color.background</code>，如果使用硬编码的方式，可能会写出这样的代码：</p>\n<pre><code class=\"language-javascript\">if (key === 'font.size') {\n  user_config.font.size = value\n} else if (key === 'page.color.background') {\n  user_config.page.color.background = value\n}\n// 更多的 if 语句...\n</code></pre>\n<p>这样写显然不够优雅，看看<code>putValue</code>与<code>pickValue</code>的组合用法。</p>\n<pre><code class=\"language-javascript\">// 写入用户配置：\nutils.putValue(user_config, key, value)\n\n// 读取用户配置\nconst value = utils.pickValue(user_config, key)\n</code></pre>\n<p>不管<code>key</code>怎么变，一句话搞定，感觉一下子和大学生拉开差距了是吧？</p>\n<h3>向数组末尾添加元素：<code>pushValue</code>函数</h3>\n<p>在实际开发中，常有向数组末尾添加数据的需求。例如记录用户最近的评论，此时你可以使用<code>pushValue</code>函数：</p>\n<pre><code class=\"language-javascript\">const user_data = {} // 用户数据\nlet comment = {content: '顶'} // 用户的评论\n\nutils.pushValue(user_data, `articles.recent_comments`, comment)\n\nconsole.log(user_data) // {articles: {recent_comments: [{content: '顶'}]}}\n</code></pre>\n<p>在上面代码中，<code>pushValue</code>函数先是自动创建了<code>user_data.articles.recent_comments</code>数组，然后把<code>comment</code>添加到数组末尾。<code>pushValue</code>函数的声明如下：</p>\n<pre><code class=\"language-javascript\">/**\n * 将值推入对象指定路径的数组中，若路径或数组不存在则自动创建。\n * @param {Object} obj - 目标对象。\n * @param {string} key - 数组属性的路径，支持'a.b.c'形式。\n * @param {*} value - 要推入的值。\n * @throws {Error} 如果路径不是数组，则抛出异常。\n */\npushValue(obj, key, value){\n  // ...\n}\n</code></pre>\n<p>再次调用此函数，数组中就会有两个评论：</p>\n<pre><code class=\"language-javascript\">comment = {content: '再顶'}\n\nutils.pushValue(user_data, `articles.recent_comments`, comment)\n\nconsole.log(user_data) // {articles: {recent_comments: [{content: '顶'}, {content: '再顶'}]}}\n</code></pre>\n<h3>向对象中添加多个属性：<code>putObj</code>函数</h3>\n<p>前面我们使用<code>putValue</code>函数向<code>obj</code>对象写入了一个属性值，但如果你要写入很多个（例如 100 个）属性值，你可能会使用<code>for</code>循环：</p>\n<pre><code class=\"language-javascript\">let user_config = {}\nlet new_config_keys // 100 个新的配置项（数组）\nlet new_config_values // 对应的 100 个值（数组）\n\nfor (let i = 0; i &lt; new_config_keys.length; i++) {\n  utils.putValue(user_config, new_config_keys[i], new_config_values[i])\n}\n</code></pre>\n<p>这样写没问题，但在实战中，你拿到的用户配置往往不是数组的形式，而很可能是一个对象，例如：</p>\n<pre><code class=\"language-javascript\">let new_config = {\n  font: {\n    size: 16,\n    'family.first': 'Arial',\n    'family.second': 'sans-serif',\n  },\n  'page.color.background': '#fff',\n  // ...\n}\n\n// 你对拿到的配置数据又进一步处理\nnew_config.update_time = new Date()\n</code></pre>\n<p>这种情况下你可以使用<code>putObj</code>函数一次性写入多个属性值：</p>\n<pre><code class=\"language-javascript\">utils.putObj(user_config, new_config)\n\nconsole.log(user_config)\n\n/* 输出如下：\n{\n  font: {\n    size: 16,\n    family: {\n      first: 'Arial',\n      second: 'sans-serif'\n    }\n  },\n  page: {\n    color: {\n      background: '#fff'\n    }\n  },\n  update_time: '...',\n}\n*/\n</code></pre>\n<p><strong>注意<code>putObj</code>会自动处理上面<code>new_config</code>变量中各种路径的写法</strong>。<code>putObj</code>函数的声明如下：</p>\n<pre><code class=\"language-javascript\">/**\n * 将一个对象的所有属性按路径添加到另一个对象中。\n * @param {Object} obj - 目标对象。\n * @param {Object} obj_value - 要添加的属性对象，键支持'a.b.c'形式的路径。\n * @param {Object} [options={}] - 可选参数。\n *   - {boolean} remove_undefined - 如果为 true 且 value 为 undefined ，则删除该属性。\n * @throws {Error} 如果 obj 为 null 或 undefined ，或路径不合法（如中间非对象）则抛出异常。\n *\n * 注意\n *   若 obj_value 中出现重复路径，则后者会覆盖前者。\n *   如 obj_value = {a: {b: 1}, 'a.b': 2}，则结果为 {a: {b: 2}}\n */\nputObj(obj, obj_value, { remove_undefined = true} = {}) {\n  // ...\n}\n</code></pre>\n<h3>从对象中获取多个属性：<code>pickObj</code>函数</h3>\n<p>同样的，我们可以一次性读取多个对象的属性值。例如虽然小程序中的用户配置非常复杂，但当前页面仅关注背景颜色、字体大小等少量配置项，你可以这样使用<code>pickObj</code>函数：</p>\n<pre><code class=\"language-javascript\">let user_config // 某个用户的所有配置\n\n// 本页面需要关注的配置\nconst keys = ['page.color.background', 'font.size', 'font.family']\n\n// 获取当前页面需要的配置\nconst curr_config = utils.pickObj(user_config, keys)\n\nconsole.log(curr_config)\n\n/* 输出如下：\n{\n  'page.color.background': '#fff',\n  'font.size': 16,\n  'font.family': {\n    first: 'Arial',\n    second: 'sans-serif'\n  }\n}\n*/\n\nconsole.log(curr_config.font) // undefined\n</code></pre>\n<p>注意，传给<code>pickObj</code>函数的第二个参数是一个字符串数组，而不是对象。并且，<code>pickObj</code>返回的对象中，属性值不是以<code>curr_config.font.size</code>这样的形式返回，而是返回<code>curr_config['font.size']</code>。</p>\n<p>当然，如果你想要<code>curr_config.font.size</code>这样的形式，可用<code>putObj</code>转换一下：</p>\n<pre><code class=\"language-javascript\">let obj_config = utils.putObj({}, curr_config)\n\nconsole.log(obj_config.font.size) // 16\n</code></pre>\n<h2>点表示法在微信小程序中实战演示</h2>\n<p>为什么要设计这几个函数？为什么要支持<code>config.a.b.c</code>与<code>config['a.b.c']</code>两种写法混用？为什么传给<code>putObj</code>的第二个参数是对象，而传给<code>pickObj</code>的第二个参数是字符串数组？为什么<code>pickObj</code>返回的对象属性值不是<code>config.a.b.c</code>这样的形式，而是<code>config['a.b.c']</code>？</p>\n<p>因为这样设计符合实战需求，<strong>一句话解释就是：“这样好用”</strong>。</p>\n<p>下面我们通过几个案例来演示这些函数在实战中的应用。</p>\n<h3>在 js 中设置用户配置</h3>\n<p>假设用户首次打开小程序，你需要设置用户默认字体大小为 16 ，背景颜色为白色。可以这样写：</p>\n<pre><code class=\"language-javascript\">let user_config = {}\nutils.putValue(user_config, 'font.size', 16)\nutils.putValue(user_config, 'page.color.background', '#fff')\n</code></pre>\n<p>使用<code>putValue</code>设置后，你想修改字体大小和背景颜色？可以这样写：</p>\n<pre><code class=\"language-javascript\">user_config.font.size = 18\nuser_config.page.color.background = '#000'\n</code></pre>\n<h3>在 wxml 中实现修改用户配置</h3>\n<p>你可能会在 wxml 页面中实现多个配置项的修改，并且使用同一个函数来处理。这时你可以这样写：</p>\n<pre><code class=\"language-html\">&lt;button bind:tap=\"changeConfig\" data-key=\"font.size\" value=\"16\" &gt;\n&lt;button bind:tap=\"changeConfig\" data-key=\"page.color.background\" value=\"#fff\"&gt;\n</code></pre>\n<pre><code class=\"language-javascript\">changeConfig(e){\n  const { user_config } = this.data\n  const { key, value } = e.currentTarget.dataset\n\n  // 从 wxml 中获得点表示法的 key 字符串，直接调用 putValue 函数\n  utils.putValue(user_config, key, value)\n\n  // 修改背景色时顺便改一下字体颜色（两种写法混用）\n  if (key === 'page.color.background' &amp;&amp; value === '#fff') {\n    user_config.page.color.font_color = '#000'\n  }\n\n  // 记录最近修改时间\n  user_config.update_time = new Date()\n}\n</code></pre>\n<h3>在 wxml 中使用用户配置</h3>\n<p>要在页面中使用<code>page.color.background</code>与<code>page.color.font_color</code>的值，实现根据用户配置显示不同的颜色，可以这样写：</p>\n<pre><code class=\"language-html\">&lt;view style=\"background-color: {{color.background}}\"&gt;\n  &lt;text style=\"color: {{color.font_color}}\"&gt;\n      Hello, WxMpCloudBooster!\n  &lt;/text&gt;\n&lt;/view&gt;\n</code></pre>\n<pre><code class=\"language-javascript\">onLoad(){\n  const { user_config } = this.data\n  const color = utils.pickValue(user_config, 'page.color')\n  this.setData({color})\n}\n</code></pre>\n<p>你看，我们传递给<code>pickValue</code>的<code>key</code>根据实际需求可长可短。</p>\n<h3>初始化默认的用户配置</h3>\n<p>你希望为每个用户设置一个默认的用户配置，并且你想用常规方式写（不使用点表示法）。可以这样：</p>\n<pre><code class=\"language-javascript\">// 默认配置\nconst DEFAULT_CONFIG = {\n  font: {\n    size: 16,\n  },\n  page: {\n    color: {\n      background: '#fff',\n      font_color: '#000'\n    }\n  },\n  // 这里也可以使用点表示法 a.b.c ，但你不想这样写...\n}\n\nApp({\n  initConfig(){\n    let { user_config } = this.data\n    utils.putObj(user_config, DEFAULT_CONFIG) // user_config 的其他值会被保留\n    // 保存用户配置...\n  }\n})\n</code></pre>\n<p>注意，上面代码中<code>user_config</code>可能会有其他没有出现在<code>DEFAULT_CONFIG</code>中的配置项，这些配置项会被保留。</p>\n<h3>记录用户最近发表的内容</h3>\n<p>假如你已经实现了“记录用户最近发布的评论”功能，代码如下：</p>\n<pre><code class=\"language-html\">&lt;button bind:tap=\"append\" data-key=\"articles.recent_comments\" data-prop=\"comment\" &gt;\n</code></pre>\n<p>当用户点击这个按钮时，假设<code>this.data</code>中已经有一个<code>comment</code>对象，你可以这样添加评论：</p>\n<pre><code class=\"language-javascript\">append(e){\n  const { user_data } = this.data\n  const { key, prop } = e.currentTarget.dataset\n  const value = this.data[prop] // prop === \"comment\"\n\n  utils.pushValue(user_data, key, value) // 注意这里用的是 push\n}\n</code></pre>\n<p>上面这个<code>append</code>函数会把<code>this.data.comment</code>对象添加到<code>user_data.articles.recent_comments</code>数组的末尾。</p>\n<p>然后，此时你希望再增加一个按钮，可以把最近的点赞数据<code>this.data.like</code>添加到<code>user_data.articles.recent_likes</code>数组的末尾，那么只需一句：</p>\n<pre><code class=\"language-html\">&lt;button bind:tap=\"append\" data-key=\"articles.recent_likes\" data-prop=\"like\" &gt;\n</code></pre>\n<p>完成了，你不需要修改<code>append</code>函数，只需要给<code>data-key</code>和<code>data-prop</code>属性设置不同的值即可。</p>\n<p>可见，<strong>点表示法很大的目的是为了在<code>wxml</code>中可以方便地指定路径，并在<code>js</code>中方便地处理这些路径。</strong></p>\n<h3>在页面中修改多个配置项</h3>\n<p>假设你有一个修改用户配置项的页面，<code>wxml</code>代码如下：</p>\n<pre><code class=\"language-html\">&lt;!-- 注意这里有一个 for 循环 --&gt;\n&lt;view wx:for=\"{{configs}}\"&gt;\n  配置名称：{{item.title}}\n  当前值：{{item.value}}\n  输入新值：&lt;input type=\"text\" /&gt;\n  点击修改：&lt;button bind:tap=\"changeConfig\"/&gt;\n&lt;/view&gt;\n</code></pre>\n<p>上面代码使用了<code>for</code>循环，<code>configs</code>变量中有多少个值，就会显示多少个配置项。</p>\n<p>为了实现在用户打开页面时显示的是用户的当前值（而不是默认值），你还需要从<code>user_config</code>中读取当前用户的配置值。</p>\n<p>代码样例如下：</p>\n<pre><code class=\"language-javascript\">// 代码中写死了需要修改的配置项以及默认值\nconfigs = [\n  {title: '字体大小', key: 'font.size', value: 16},\n  {title: '背景颜色', key: 'page.color.background', value: '#fff'},\n  {title: '字体颜色', key: 'page.color.font_color', value: '#000'},\n]\n\n// 读取当前用户的配置值\nconst uc_obj = utils.pickObj(user_config, configs.map(item =&gt; item.key))\n\n// 注意，这里的 uc_obj 是 uc_obj['font.size'] 这样的形式，而不是 uc_obj.font.size\n\n// 用户当前值覆盖默认值\nconfigs.forEach(item =&gt; {\n  if (uc_obj[item.key] !== undefined) {\n    item.value = uc_obj[item.key]\n  }\n})\n\nthis.setData({configs}) // 传给 wxml 页面显示\n</code></pre>\n<p>这样你就实现了修改多个配置项的页面，用户打开页面时显示的是用户当前的配置值。</p>\n<p><em>提问：假设我们坚决不使用点表示法，且要实现上面这些功能，你要如何设计才能如此简单、高效？</em></p>\n<h3>让你的函数也支持点表示法</h3>\n<p>好了，目前我们花了不少篇幅介绍点表示法，这是因为<strong>后面我们会介绍更多的工具函数，而这些工具函数都支持点表示法的调用方式</strong>。</p>\n<p>当你编写自己的工具函数时，你可以调用<code>putValue</code>、<code>pickValue</code>、<code>pushValue</code>、<code>putObj</code>、<code>pickObj</code>这 5 个函数，<strong>轻松地让你的工具函数也支持点表示法</strong>。如果你不知道如何实现，可以参考<code>utils.js</code>中其他函数的代码。</p>\n<p><strong>（文章节选完，如果你感兴趣的话可以看看 <a href=\"https://github.com/sdjl/WxMpCloudBooster\" rel=\"nofollow\">Github 项目</a>）</strong></p>\n", "last_modified": 1725202177, "replies": 46, "id": 1069443}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_large.png?m=1695370146", "name": "career", "avatar_normal": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_normal.png?m=1695370146", "title": "职场话题", "url": "https://www.v2ex.com/go/career", "topics": 17981, "footer": "", "header": "这里，我们聊聊那些工作中遇到的开心和不开心的事。", "title_alternative": "Career", "avatar_mini": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_mini.png?m=1695370146", "stars": 3220, "aliases": [], "root": false, "id": 770, "parent_node_name": "work"}, "member": {"id": 85851, "username": "fee", "url": "https://www.v2ex.com/u/fee", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/66ac037ba50e707588c3f000764f5709?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/66ac037ba50e707588c3f000764f5709?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/66ac037ba50e707588c3f000764f5709?s=73&d=retro", "created": 1418101764, "last_modified": 1418101764}, "last_reply_by": "tfull", "last_touched": 1725246256, "title": "职业现状与转行机会", "url": "https://www.v2ex.com/t/1069366", "created": 1725172146, "deleted": 0, "content": "## 我的职业现状\r\n\r\n毕业后我就在杭州工作，到现在快 10 年了。前几年在一家中厂上班，由于受不了频繁的加班，降薪跳槽到了现在的公司，公司大约有 100 名员工，我从事前端开发工作，双休不加班，年收入大概在 20 万元左右，骑车到公司大概 8 分钟。公司是以项目为主，目前看这个项目还能维持两三年，但之后的情况不确定，没有接到新项目估计就要裁员了。\r\n\r\n## 新的转行机会\r\n\r\n最近有一个转行的机会：我的亲戚在老家办厂，现在想在杭州开设一个电商部门，邀请我去负责天猫旗舰店，主要产品是低压电器。工资待遇按我现在的水平，发展得好还有分红。他计划一年投入 100-200 万元，用于人员和流量购买，办公地点大概会安排在余杭阿里附近，而我现在住在滨江。\r\n\r\n## 犹豫与考虑\r\n\r\n现在有些纠结，电商已经发展了这么多年，现在做这个是不是有点晚了？新的工作对我来说也是一个挑战。但亲戚希望做天猫旗舰店，因为目前天猫上有一家店铺没有工厂，所有货物都从他那里拿货，一年销售额能达到两三千万。所以，论坛的老哥们帮忙出出主意，这个机会是否值得抓住？", "content_rendered": "<h2>我的职业现状</h2>\n<p>毕业后我就在杭州工作，到现在快 10 年了。前几年在一家中厂上班，由于受不了频繁的加班，降薪跳槽到了现在的公司，公司大约有 100 名员工，我从事前端开发工作，双休不加班，年收入大概在 20 万元左右，骑车到公司大概 8 分钟。公司是以项目为主，目前看这个项目还能维持两三年，但之后的情况不确定，没有接到新项目估计就要裁员了。</p>\n<h2>新的转行机会</h2>\n<p>最近有一个转行的机会：我的亲戚在老家办厂，现在想在杭州开设一个电商部门，邀请我去负责天猫旗舰店，主要产品是低压电器。工资待遇按我现在的水平，发展得好还有分红。他计划一年投入 100-200 万元，用于人员和流量购买，办公地点大概会安排在余杭阿里附近，而我现在住在滨江。</p>\n<h2>犹豫与考虑</h2>\n<p>现在有些纠结，电商已经发展了这么多年，现在做这个是不是有点晚了？新的工作对我来说也是一个挑战。但亲戚希望做天猫旗舰店，因为目前天猫上有一家店铺没有工厂，所有货物都从他那里拿货，一年销售额能达到两三千万。所以，论坛的老哥们帮忙出出主意，这个机会是否值得抓住？</p>\n", "last_modified": 1725172146, "replies": 42, "id": 1069366}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340", "name": "qna", "avatar_normal": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340", "title": "问与答", "url": "https://www.v2ex.com/go/qna", "topics": 222496, "footer": "", "header": "一个更好的世界需要你持续地提出好问题。", "title_alternative": "Questions and Answers", "avatar_mini": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340", "stars": 4229, "aliases": [], "root": false, "id": 12, "parent_node_name": "v2ex"}, "member": {"id": 514450, "username": "ABCDiSDR", "url": "https://www.v2ex.com/u/ABCDiSDR", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/avatar/3e54/f918/514450_mini.png?m=1717234189", "avatar_normal": "https://cdn.v2ex.com/avatar/3e54/f918/514450_normal.png?m=1717234189", "avatar_large": "https://cdn.v2ex.com/avatar/3e54/f918/514450_large.png?m=1717234189", "avatar_xlarge": "https://cdn.v2ex.com/avatar/3e54/f918/514450_xlarge.png?m=1717234189", "avatar_xxlarge": "https://cdn.v2ex.com/avatar/3e54/f918/514450_xlarge.png?m=1717234189", "created": 1603554091, "last_modified": 1717234189}, "last_reply_by": "JieeeAdaxi", "last_touched": 1725245535, "title": "Thinkbook 14+ 品质探究", "url": "https://www.v2ex.com/t/1069341", "created": 1725163089, "deleted": 0, "content": "最近薅了京爷券，买了 Thinkbook 14+锐龙版，看到京东自营差评一堆\r\n\r\n\r\n例如：\r\nABCD 面做工：C 面键盘中间鼓两边凹、屏幕合不上有缝隙、D 面后盖按压合上松开又顶起、D 面不平整\r\n屏幕：闪屏（屏幕背光供电高压板不稳定，等管接头处焊点不牢固打火）、漏液。亮屏状态下挪动笔记本，小角度开合屏幕屏幕闪屏\r\n兼容性：双盘位（致态 7100 等）睡眠唤醒掉盘\r\n充电接口：用一个月无法充电，用几次无法充电，松，易晃动\r\n系统：黑屏崩溃\r\n其他：卡顿，发热，噪声大，电流声，触控板就不在列举了\r\n\r\n请教各位大佬，你们买联想的本有过类似问题么？和京东自营客服 battle 退换货难度高不高？", "content_rendered": "最近薅了京爷券，买了 Thinkbook 14+锐龙版，看到京东自营差评一堆<br /><br /><br />例如：<br />ABCD 面做工：C 面键盘中间鼓两边凹、屏幕合不上有缝隙、D 面后盖按压合上松开又顶起、D 面不平整<br />屏幕：闪屏（屏幕背光供电高压板不稳定，等管接头处焊点不牢固打火）、漏液。亮屏状态下挪动笔记本，小角度开合屏幕屏幕闪屏<br />兼容性：双盘位（致态 7100 等）睡眠唤醒掉盘<br />充电接口：用一个月无法充电，用几次无法充电，松，易晃动<br />系统：黑屏崩溃<br />其他：卡顿，发热，噪声大，电流声，触控板就不在列举了<br /><br />请教各位大佬，你们买联想的本有过类似问题么？和京东自营客服 battle 退换货难度高不高？", "last_modified": 1725163089, "replies": 40, "id": 1069341}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/ab88/b157/836_large.png?m=1450649879", "name": "telegram", "avatar_normal": "https://cdn.v2ex.com/navatar/ab88/b157/836_normal.png?m=1450649879", "title": "Telegram", "url": "https://www.v2ex.com/go/telegram", "topics": 1028, "footer": "", "header": "一个全新的主打安全和隐私的通讯平台——Telegram Messenger，来自俄罗斯最大的社交网站 VK 的创建人 Nikolai Durov 和 Pavel Durov 兄弟", "title_alternative": "Telegram", "avatar_mini": "https://cdn.v2ex.com/navatar/ab88/b157/836_mini.png?m=1450649879", "stars": 1109, "aliases": [], "root": false, "id": 836, "parent_node_name": "internet"}, "member": {"id": 666753, "username": "UncleCAT4", "url": "https://www.v2ex.com/u/UncleCAT4", "website": "yuanj.top", "twitter": "", "psn": "", "github": "yuanj82", "btc": "", "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/b3a3/2391/666753_mini.png?m=1702447939", "avatar_normal": "https://cdn.v2ex.com/avatar/b3a3/2391/666753_normal.png?m=1702447939", "avatar_large": "https://cdn.v2ex.com/avatar/b3a3/2391/666753_large.png?m=1702447939", "avatar_xlarge": "https://cdn.v2ex.com/avatar/b3a3/2391/666753_xlarge.png?m=1702447939", "avatar_xxlarge": "https://cdn.v2ex.com/avatar/b3a3/2391/666753_xlarge.png?m=1702447939", "created": 1702447853, "last_modified": 1702447939}, "last_reply_by": "nitmali", "last_touched": 1725245418, "title": "求一个 im 软件，替代 telegram", "url": "https://www.v2ex.com/t/1069388", "created": 1725179823, "deleted": 0, "content": "号被封的遭不住，其他都不在乎，主要是 telegram 传文件实在方便，有类似的替代品么？主要是当作文件传输助手，QQ/微信实在难绷", "content_rendered": "<p>号被封的遭不住，其他都不在乎，主要是 telegram 传文件实在方便，有类似的替代品么？主要是当作文件传输助手，QQ/微信实在难绷</p>\n", "last_modified": 1725184543, "replies": 40, "id": 1069388}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/d580/72be/806_large.png?m=1644128175", "name": "openwrt", "avatar_normal": "https://cdn.v2ex.com/navatar/d580/72be/806_normal.png?m=1644128175", "title": "OpenWrt", "url": "https://www.v2ex.com/go/openwrt", "topics": 1357, "footer": "", "header": "Wireless Freedom", "title_alternative": "OpenWrt", "avatar_mini": "https://cdn.v2ex.com/navatar/d580/72be/806_mini.png?m=1644128175", "stars": 1171, "aliases": [], "root": false, "id": 806, "parent_node_name": "router"}, "member": {"id": 400458, "username": "sjqboss", "url": "https://www.v2ex.com/u/sjqboss", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/0e68c9cc3e2a078873d4727ae0c1d2c1?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/0e68c9cc3e2a078873d4727ae0c1d2c1?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/0e68c9cc3e2a078873d4727ae0c1d2c1?s=73&d=retro", "created": 1554905991, "last_modified": 1554905991}, "last_reply_by": "Earsum", "last_touched": 1725221874, "title": "感觉 openclash 的设置好反人类，一个自定义规则搞了好久", "url": "https://www.v2ex.com/t/1069333", "created": 1725160318, "deleted": 0, "content": "一直以为在配置管理里的配置文件里编辑，编辑好自定义的规则是可以使用的，但应该是定制了自动更新订阅的缘故，订阅更新后自定义的规则消失了，现在完全不懂在哪里添加自定义规则，太难了。", "content_rendered": "<p>一直以为在配置管理里的配置文件里编辑，编辑好自定义的规则是可以使用的，但应该是定制了自动更新订阅的缘故，订阅更新后自定义的规则消失了，现在完全不懂在哪里添加自定义规则，太难了。</p>\n", "last_modified": 1725160318, "replies": 39, "id": 1069333}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_large.png?m=1691642161", "name": "bb", "avatar_normal": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_normal.png?m=1691642161", "title": "宽带症候群", "url": "https://www.v2ex.com/go/bb", "topics": 16115, "footer": "", "header": "网速很重要。比快更快。", "title_alternative": "Broadband Symptom Complex", "avatar_mini": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_mini.png?m=1691642161", "stars": 7523, "aliases": [], "root": false, "id": 108, "parent_node_name": "geek"}, "member": {"id": 632088, "username": "AS58453", "url": "https://www.v2ex.com/u/AS58453", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/903512f8eb6aee5493e28e883f116981?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/903512f8eb6aee5493e28e883f116981?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/903512f8eb6aee5493e28e883f116981?s=73&d=retro", "created": 1685608047, "last_modified": 1694056237}, "last_reply_by": "microka", "last_touched": 1725246437, "title": "四川移动、成都移动固定 IP 专线上传限速和高 ping 丢包情况通报", "url": "https://www.v2ex.com/t/1069459", "created": 1725209986, "deleted": 0, "content": "各位使用成都、四川移动地区专线的 V 友们，请关注自己专线的网络状况：\r\n  由于打压 PCDN ，从 2024.9.1 日下午 16：00 以后，成都地区移动出现了只要有上传流量（流速>10mbps ）,会出现到网关的高 ping 、跳包现象。同时上传速度仅仅只有正常速度的 10/1 。\r\n  我这里已经有两条专线中招，有一条日均上传很高（作用于网盘备份、同步），而另外一条日均上传不过 5-15G ，一个月下下上行流量不过 137G 。\r\n现在的情况就是：下行可以跑满合同限速，ping 不丢包，只要测速开始测试上传，并且速率>10m ，到第一跳网关将出现高 ping 导致整个网络连接质量极差，停止上传后网络会立即恢复正常。\r\ntips：1 、这些都是固定 IP 的专线，不是家宽；\r\n      2 、最开始我还认为只针对高上传用户，结果低上传用户也被一锅端了。\r\n      3 、不跑 PCDN 、PT ，不要拿跑 PCDN 被收拾来幸灾乐祸。这个 QOS 策略纯纯傻逼。\r\n      大家对照一下检查一下专线的情况把\r\n\r\n图片：\r\nhttps://imgur.com/a/xz6kYwV", "content_rendered": "各位使用成都、四川移动地区专线的 V 友们，请关注自己专线的网络状况：<br />  由于打压 PCDN ，从 2024.9.1 日下午 16：00 以后，成都地区移动出现了只要有上传流量（流速&gt;10mbps ）,会出现到网关的高 ping 、跳包现象。同时上传速度仅仅只有正常速度的 10/1 。<br />  我这里已经有两条专线中招，有一条日均上传很高（作用于网盘备份、同步），而另外一条日均上传不过 5-15G ，一个月下下上行流量不过 137G 。<br />现在的情况就是：下行可以跑满合同限速，ping 不丢包，只要测速开始测试上传，并且速率&gt;10m ，到第一跳网关将出现高 ping 导致整个网络连接质量极差，停止上传后网络会立即恢复正常。<br />tips：1 、这些都是固定 IP 的专线，不是家宽；<br />      2 、最开始我还认为只针对高上传用户，结果低上传用户也被一锅端了。<br />      3 、不跑 PCDN 、PT ，不要拿跑 PCDN 被收拾来幸灾乐祸。这个 QOS 策略纯纯傻逼。<br />      大家对照一下检查一下专线的情况把<br /><br />图片：<br /><a target=\"_blank\" href=\"https://imgur.com/a/xz6kYwV\" rel=\"nofollow noopener\">https://imgur.com/a/xz6kYwV</a>", "last_modified": 1725209986, "replies": 39, "id": 1069459}]