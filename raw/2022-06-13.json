[{"node": {"avatar_large": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1651385949", "name": "programmer", "avatar_normal": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1651385949", "title": "程序员", "url": "https://www.v2ex.com/go/programmer", "topics": 49237, "footer": "", "header": "While code monkeys are not eating bananas, they're coding.", "title_alternative": "Programmer", "avatar_mini": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1651385949", "stars": 7852, "aliases": [], "root": false, "id": 300, "parent_node_name": "computer"}, "member": {"id": 119683, "username": "realpg", "url": "https://www.v2ex.com/u/realpg", "website": "", "twitter": "", "psn": "", "github": "realpg", "btc": "", "location": "帝都", "tagline": "Nothing", "bio": "Nothing", "avatar_mini": "https://cdn.v2ex.com/avatar/71ee/202d/119683_mini.png?m=1655059011", "avatar_normal": "https://cdn.v2ex.com/avatar/71ee/202d/119683_normal.png?m=1655059011", "avatar_large": "https://cdn.v2ex.com/avatar/71ee/202d/119683_large.png?m=1655059011", "created": 1432975869, "last_modified": 1655059011}, "last_reply_by": "Buges", "last_touched": 1655110233, "title": "哔了狗的 gorm. 很久没用 golang 了，生态这么操蛋么？", "url": "https://www.v2ex.com/t/859178", "created": 1655059703, "deleted": 0, "content": "我已经 6 年没说过脏话了，这次破防了，出口成脏敬请原谅。。\r\n\r\n\r\n\r\n\r\n最近用 golang 的一个项目，天生集成了 gorm 我无从选择。\r\n\r\n有一个需求，嗯，很简单，MYSQL 用一个外键。\r\n\r\n\r\n为什么要用外键？因为他的 orm ，据我初步看文档了解，如果不建立外键对应关系，是不能做 join 的。不让 join 基本 crud 都玩不转啊\r\n\r\n\r\n\r\n\r\n我看了文档，我不是没有英文阅读能力，为了省事，我看中文比较快，嗯，语法很简单\r\n\r\nhttps://gorm.io/zh_CN/docs/index.html\r\n\r\n数据库创建外键很简单\r\n\r\nhttps://i.imgur.com/Srtz8Wd.png\r\n\r\n嗯，我照着做了，不生效\r\n\r\n没准是哪个傻逼翻译中文时候翻译错了\r\n\r\n看英文官方文档，嗯，翻译没错，不生效\r\n\r\n我直接按照文档做了个示例，不生效\r\n\r\n看来这玩意 BUG 了\r\n\r\n我看看我的版本吧，看了下项目引用\r\n\r\nhttps://i.imgur.com/TDQwoQv.png\r\n\r\n1.22.5\r\n\r\n上官方网站\r\n\r\nhttps://i.imgur.com/BX7r8pI.png\r\n\r\n显示最新 1.23.6\r\n\r\n那就找找 changelog ，看看 1.22.5 到 1.23.6 有什么升级。是不是修复了这个 BUG\r\n\r\n嗯嗯，我傻逼了，找了一个小时没找到\r\n\r\n所有关于 changelog what's new 的，都指向一个吹牛逼 gorm v2 有啥新特性的地方\r\n\r\ngithub 呢，没有 release ，只有版本库的 tag ，也没有任何说明\r\n\r\n\r\n因为还有其他地方用着这个版本，竟然前人大佬写死了 1.22.5 ，暂时不敢升级\r\n\r\n\r\n找官方手册，找来找去没找到。找 stackoverflow 之类，找到了一个非官方解决方案\r\n\r\n\r\n用这个方案的关键字去搜索，哇，找到了一个 2018 年的 github issue\r\n\r\n\r\n这个大佬真贴心，原来 2018 年建外键的功能就不好使啊，而且 MYSQL POSTGRES SQLITE 都不好使，你敢信，他官方好像就主要支持这三种数据库！\r\n\r\n\r\nhttps://i.imgur.com/RWSe4sB.png\r\n\r\n\r\n请允许我引用一下\r\n\r\n\r\nYou can use gorm:\"foreignkey:\", but it doesn't create any foreign key, not like primary_key, that's quite counter-intuitive.\r\nYou need use gorm:\"type:int REFERENCES user(id) ON DELETE CASCADE\" for PostgteSQL#450.\r\nYou need use db.Model(Email{}).AddForeignKey(\"user_id\", \"user(id)\", \"CASCADE\", \"CASCADE\") for MySQL, because above tag doesn't work in MySQL.\r\nYou need use gorm:\"type:int REFERENCES user(id) ON DELETE CASCADE\" + db.Exec(\"PRAGMA foreign_keys = ON\") for SQLite because AddForeignKey() doesn't work for SQLite and 'foreign_keys = off' is default setting in SQLite#390.\r\nNone of above things are mentioned in document.\r\nI am still confusing what's the usage of tag gorm:\"foreignkey:XXX\", it doesn't create any foreign key or contribute cascade delete/insert/update/retrieve.\r\n\r\n\r\n2018 年 6 月，现在是 2022 年 6 月，这可真是高效，还没修复\r\n\r\n\r\n好在这个大佬给了一个方式，也就是我之前在 stackoverflow 搜索到的\r\n\r\n\r\nYou need use db.Model(Email{}).AddForeignKey(\"user_id\", \"user(id)\", \"CASCADE\", \"CASCADE\") for MySQL\r\n\r\n\r\n然后我惊奇的发现，GORM 官方把 AddForeignKey()删除了\r\n\r\n\r\n因为没有 changelog ，我也不知道他啥时候删除的\r\n\r\n\r\n这可真是高效 艹", "content_rendered": "我已经 6 年没说过脏话了，这次破防了，出口成脏敬请原谅。。<br /><br /><br /><br /><br />最近用 golang 的一个项目，天生集成了 gorm 我无从选择。<br /><br />有一个需求，嗯，很简单，MYSQL 用一个外键。<br /><br /><br />为什么要用外键？因为他的 orm ，据我初步看文档了解，如果不建立外键对应关系，是不能做 join 的。不让 join 基本 crud 都玩不转啊<br /><br /><br /><br /><br />我看了文档，我不是没有英文阅读能力，为了省事，我看中文比较快，嗯，语法很简单<br /><br /><a target=\"_blank\" href=\"https://gorm.io/zh_CN/docs/index.html\" rel=\"nofollow noopener\">https://gorm.io/zh_CN/docs/index.html</a><br /><br />数据库创建外键很简单<br /><br /><a target=\"_blank\" href=\"https://i.imgur.com/Srtz8Wd.png\" rel=\"nofollow noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/Srtz8Wd.png\" class=\"embedded_image\" rel=\"noreferrer\"></a><br /><br />嗯，我照着做了，不生效<br /><br />没准是哪个傻逼翻译中文时候翻译错了<br /><br />看英文官方文档，嗯，翻译没错，不生效<br /><br />我直接按照文档做了个示例，不生效<br /><br />看来这玩意 BUG 了<br /><br />我看看我的版本吧，看了下项目引用<br /><br /><a target=\"_blank\" href=\"https://i.imgur.com/TDQwoQv.png\" rel=\"nofollow noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/TDQwoQv.png\" class=\"embedded_image\" rel=\"noreferrer\"></a><br /><br />1.22.5<br /><br />上官方网站<br /><br /><a target=\"_blank\" href=\"https://i.imgur.com/BX7r8pI.png\" rel=\"nofollow noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/BX7r8pI.png\" class=\"embedded_image\" rel=\"noreferrer\"></a><br /><br />显示最新 1.23.6<br /><br />那就找找 changelog ，看看 1.22.5 到 1.23.6 有什么升级。是不是修复了这个 BUG<br /><br />嗯嗯，我傻逼了，找了一个小时没找到<br /><br />所有关于 changelog what's new 的，都指向一个吹牛逼 gorm v2 有啥新特性的地方<br /><br />github 呢，没有 release ，只有版本库的 tag ，也没有任何说明<br /><br /><br />因为还有其他地方用着这个版本，竟然前人大佬写死了 1.22.5 ，暂时不敢升级<br /><br /><br />找官方手册，找来找去没找到。找 stackoverflow 之类，找到了一个非官方解决方案<br /><br /><br />用这个方案的关键字去搜索，哇，找到了一个 2018 年的 github issue<br /><br /><br />这个大佬真贴心，原来 2018 年建外键的功能就不好使啊，而且 MYSQL POSTGRES SQLITE 都不好使，你敢信，他官方好像就主要支持这三种数据库！<br /><br /><br /><a target=\"_blank\" href=\"https://i.imgur.com/RWSe4sB.png\" rel=\"nofollow noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/RWSe4sB.png\" class=\"embedded_image\" rel=\"noreferrer\"></a><br /><br /><br />请允许我引用一下<br /><br /><br />You can use gorm:\"foreignkey:\", but it doesn't create any foreign key, not like primary_key, that's quite counter-intuitive.<br />You need use gorm:\"type:int REFERENCES user(id) ON DELETE CASCADE\" for PostgteSQL#450.<br />You need use db.Model(Email{}).AddForeignKey(\"user_id\", \"user(id)\", \"CASCADE\", \"CASCADE\") for MySQL, because above tag doesn't work in MySQL.<br />You need use gorm:\"type:int REFERENCES user(id) ON DELETE CASCADE\" + db.Exec(\"PRAGMA foreign_keys = ON\") for SQLite because AddForeignKey() doesn't work for SQLite and 'foreign_keys = off' is default setting in SQLite#390.<br />None of above things are mentioned in document.<br />I am still confusing what's the usage of tag gorm:\"foreignkey:XXX\", it doesn't create any foreign key or contribute cascade delete/insert/update/retrieve.<br /><br /><br />2018 年 6 月，现在是 2022 年 6 月，这可真是高效，还没修复<br /><br /><br />好在这个大佬给了一个方式，也就是我之前在 stackoverflow 搜索到的<br /><br /><br />You need use db.Model(Email{}).AddForeignKey(\"user_id\", \"user(id)\", \"CASCADE\", \"CASCADE\") for MySQL<br /><br /><br />然后我惊奇的发现，GORM 官方把 AddForeignKey()删除了<br /><br /><br />因为没有 changelog ，我也不知道他啥时候删除的<br /><br /><br />这可真是高效 艹", "last_modified": 1655060101, "replies": 108, "id": 859178}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/6e27/13a6/557_large.png?m=1608969785", "name": "life", "avatar_normal": "https://cdn.v2ex.com/navatar/6e27/13a6/557_normal.png?m=1608969785", "title": "生活", "url": "https://www.v2ex.com/go/life", "topics": 3220, "footer": "", "header": "生活中的技术讨论", "title_alternative": "Life", "avatar_mini": "https://cdn.v2ex.com/navatar/6e27/13a6/557_mini.png?m=1608969785", "stars": 845, "aliases": [], "root": false, "id": 557, "parent_node_name": ""}, "member": {"id": 59091, "username": "klo424", "url": "https://www.v2ex.com/u/klo424", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/13d9/41b7/59091_mini.png?m=1646267791", "avatar_normal": "https://cdn.v2ex.com/avatar/13d9/41b7/59091_normal.png?m=1646267791", "avatar_large": "https://cdn.v2ex.com/avatar/13d9/41b7/59091_large.png?m=1646267791", "created": 1395889389, "last_modified": 1646267791}, "last_reply_by": "wealliam", "last_touched": 1655109944, "title": "想买个手机，选哪个？", "url": "https://www.v2ex.com/t/859181", "created": 1655078873, "deleted": 0, "content": "好久没关注手机了，想买个好点的手机，现在用的米 6 当备用机。\r\n\r\n需求：能用 3 年以上，大存储，日常拍照，游戏，看电视剧。\r\n\r\n这几个选项（按心仪顺序排列）：\r\n1.华为 mate 40 pro ，一个是可以支持国产，一是信号好，拍照听说也不错，但现在官方停售了，要不等一等 mate50 ？\r\n2.SONY Xperia 1 IV 5G ，好像是新出的微单手机，可以不用买相机了？可以刷国产系统吗？\r\n3.IPhone 13 ，各方面都挺优秀，但我没用过 ios 系统，而且不怎么喜欢他的操作，最后的选择？\r\n\r\n其实我还是想等一等 mate 50 ，大家觉得如何？", "content_rendered": "<p>好久没关注手机了，想买个好点的手机，现在用的米 6 当备用机。</p>\n<p>需求：能用 3 年以上，大存储，日常拍照，游戏，看电视剧。</p>\n<p>这几个选项（按心仪顺序排列）：\n1.华为 mate 40 pro ，一个是可以支持国产，一是信号好，拍照听说也不错，但现在官方停售了，要不等一等 mate50 ？\n2.SONY Xperia 1 IV 5G ，好像是新出的微单手机，可以不用买相机了？可以刷国产系统吗？\n3.IPhone 13 ，各方面都挺优秀，但我没用过 ios 系统，而且不怎么喜欢他的操作，最后的选择？</p>\n<p>其实我还是想等一等 mate 50 ，大家觉得如何？</p>\n", "last_modified": 1655078873, "replies": 87, "id": 859181}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/e7b2/4b11/360_large.png?m=1641783557", "name": "windows", "avatar_normal": "https://cdn.v2ex.com/navatar/e7b2/4b11/360_normal.png?m=1641783557", "title": "Windows", "url": "https://www.v2ex.com/go/windows", "topics": 2733, "footer": "", "header": "Windows, not walls.", "title_alternative": "Windows", "avatar_mini": "https://cdn.v2ex.com/navatar/e7b2/4b11/360_mini.png?m=1641783557", "stars": 895, "aliases": [], "root": false, "id": 360, "parent_node_name": "os"}, "member": {"id": 563464, "username": "darklinden", "url": "https://www.v2ex.com/u/darklinden", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/b468abcec236c08ef839796de98a1f07?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/b468abcec236c08ef839796de98a1f07?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/b468abcec236c08ef839796de98a1f07?s=73&d=retro", "created": 1637995687, "last_modified": 1655034912}, "last_reply_by": "ByteCat", "last_touched": 1655107451, "title": "吐槽： Windows 竟然没有 rsync...", "url": "https://www.v2ex.com/t/859114", "created": 1655035020, "deleted": 0, "content": "今天终于闲了会儿，突发奇想把媳妇闲置很久的本子拿来折腾。\r\n为了不挨打先备份资料，把闲置很久的小米硬盘路由拎出来挂了个 smb ，然后 Windows 下挂载网络磁盘\r\n复制粘贴简直要命，中间 wifi 抽风断了下，40g 的文件夹复制了 20g 过去，看着就蛋疼\r\n掏出 powershell ，rsync ，命令不认识，掏出 mingw64 ，rsync 不认识，网上一查，各种收费版，一个 power shell 版的 github 上 10 年前的，装了还报错...\r\n于是装个 python 然后写个遍历文件夹判断大小不同重新复制\r\n\r\nWindows 下同步文件夹都用什么？总不至于都是各自造的轮子吧？简直了", "content_rendered": "今天终于闲了会儿，突发奇想把媳妇闲置很久的本子拿来折腾。<br />为了不挨打先备份资料，把闲置很久的小米硬盘路由拎出来挂了个 smb ，然后 Windows 下挂载网络磁盘<br />复制粘贴简直要命，中间 wifi 抽风断了下，40g 的文件夹复制了 20g 过去，看着就蛋疼<br />掏出 powershell ，rsync ，命令不认识，掏出 mingw64 ，rsync 不认识，网上一查，各种收费版，一个 power shell 版的 github 上 10 年前的，装了还报错...<br />于是装个 python 然后写个遍历文件夹判断大小不同重新复制<br /><br />Windows 下同步文件夹都用什么？总不至于都是各自造的轮子吧？简直了", "last_modified": 1655061071, "replies": 80, "id": 859114}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/0f84/0be9/959_large.png?m=1599117046", "name": "switch", "avatar_normal": "https://cdn.v2ex.com/navatar/0f84/0be9/959_normal.png?m=1599117046", "title": "Nintendo Switch", "url": "https://www.v2ex.com/go/switch", "topics": 401, "footer": "", "header": "任天堂 Switch（日语：ニンテンドースイッチ，英语：Nintendo Switch）是日本任天堂公司出品的电子游戏机，于 2017 年 3 月 3 日开始发售。", "title_alternative": "Nintendo Switch", "avatar_mini": "https://cdn.v2ex.com/navatar/0f84/0be9/959_mini.png?m=1599117046", "stars": 1226, "aliases": [], "root": false, "id": 959, "parent_node_name": "consoles"}, "member": {"id": 151087, "username": "ecloud", "url": "https://www.v2ex.com/u/ecloud", "website": "www.yecloud.net", "twitter": "yecloud", "psn": "", "github": "yecloud", "btc": "", "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/c430/bf33/151087_mini.png?m=1654595603", "avatar_normal": "https://cdn.v2ex.com/avatar/c430/bf33/151087_normal.png?m=1654595603", "avatar_large": "https://cdn.v2ex.com/avatar/c430/bf33/151087_large.png?m=1654595603", "created": 1449976367, "last_modified": 1654595603}, "last_reply_by": "shiguiyou", "last_touched": 1655110931, "title": "我是否真的需要买台 NS？", "url": "https://www.v2ex.com/t/859189", "created": 1655082960, "deleted": 0, "content": "家里没有 windows 电脑，有三台 mac 两台 arm 。几乎不玩网游（除了 pkuxkx 还在玩）。对硬核大作不是太感冒。喜欢玩飞行类游戏、战略类游戏（ steam 上已经有了）和休闲类游戏。平均每天游戏时间大约在 1-2 小时。不想在手机上装任何游戏。\r\n\r\n是否可以考虑购入国行？", "content_rendered": "<p>家里没有 windows 电脑，有三台 mac 两台 arm 。几乎不玩网游（除了 pkuxkx 还在玩）。对硬核大作不是太感冒。喜欢玩飞行类游戏、战略类游戏（ steam 上已经有了）和休闲类游戏。平均每天游戏时间大约在 1-2 小时。不想在手机上装任何游戏。</p>\n<p>是否可以考虑购入国行？</p>\n", "last_modified": 1655082960, "replies": 78, "id": 859189}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/6e27/13a6/557_large.png?m=1608969785", "name": "life", "avatar_normal": "https://cdn.v2ex.com/navatar/6e27/13a6/557_normal.png?m=1608969785", "title": "生活", "url": "https://www.v2ex.com/go/life", "topics": 3220, "footer": "", "header": "生活中的技术讨论", "title_alternative": "Life", "avatar_mini": "https://cdn.v2ex.com/navatar/6e27/13a6/557_mini.png?m=1608969785", "stars": 845, "aliases": [], "root": false, "id": 557, "parent_node_name": ""}, "member": {"id": 132693, "username": "fyxtc", "url": "https://www.v2ex.com/u/fyxtc", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/efd6/53c4/132693_mini.png?m=1646359299", "avatar_normal": "https://cdn.v2ex.com/avatar/efd6/53c4/132693_normal.png?m=1646359299", "avatar_large": "https://cdn.v2ex.com/avatar/efd6/53c4/132693_large.png?m=1646359299", "created": 1439434181, "last_modified": 1646359299}, "last_reply_by": "nc4697", "last_touched": 1655111146, "title": "重疾险，有必要买吗", "url": "https://www.v2ex.com/t/859187", "created": 1655082479, "deleted": 0, "content": "年费 5000 保 50w ，一直在纠结。本地惠民保医疗险和寿险都买了，就是这个重疾开销最大也最纠结", "content_rendered": "年费 5000 保 50w ，一直在纠结。本地惠民保医疗险和寿险都买了，就是这个重疾开销最大也最纠结", "last_modified": 1655082479, "replies": 58, "id": 859187}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/6e27/13a6/557_large.png?m=1608969785", "name": "life", "avatar_normal": "https://cdn.v2ex.com/navatar/6e27/13a6/557_normal.png?m=1608969785", "title": "生活", "url": "https://www.v2ex.com/go/life", "topics": 3220, "footer": "", "header": "生活中的技术讨论", "title_alternative": "Life", "avatar_mini": "https://cdn.v2ex.com/navatar/6e27/13a6/557_mini.png?m=1608969785", "stars": 845, "aliases": [], "root": false, "id": 557, "parent_node_name": ""}, "member": {"id": 577331, "username": "Echo28", "url": "https://www.v2ex.com/u/Echo28", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/58ff57b11c499aa51146415cfb36f9a5?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/58ff57b11c499aa51146415cfb36f9a5?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/58ff57b11c499aa51146415cfb36f9a5?s=73&d=retro", "created": 1648957042, "last_modified": 1648957042}, "last_reply_by": "Robertwhite", "last_touched": 1655111122, "title": "想学钢琴", "url": "https://www.v2ex.com/t/859182", "created": 1655078877, "deleted": 0, "content": "深圳龙岗布吉附近，想学钢琴，有没有推荐，这边都是 160 一节课有点贵，有便宜些的嘛，私教也可以啊", "content_rendered": "<p>深圳龙岗布吉附近，想学钢琴，有没有推荐，这边都是 160 一节课有点贵，有便宜些的嘛，私教也可以啊</p>\n", "last_modified": 1655078877, "replies": 56, "id": 859182}]