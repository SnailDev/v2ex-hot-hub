[{"node": {"avatar_large": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_large.png?m=1691642161", "name": "bb", "avatar_normal": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_normal.png?m=1691642161", "title": "宽带症候群", "url": "https://www.v2ex.com/go/bb", "topics": 16221, "footer": "", "header": "网速很重要。比快更快。", "title_alternative": "Broadband Symptom Complex", "avatar_mini": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_mini.png?m=1691642161", "stars": 7549, "aliases": [], "root": false, "id": 108, "parent_node_name": "geek"}, "member": {"id": 315883, "username": "youx", "url": "https://www.v2ex.com/u/youx", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/7c747f36b0083deb914ebcc81c571dd1?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/7c747f36b0083deb914ebcc81c571dd1?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/7c747f36b0083deb914ebcc81c571dd1?s=73&d=retro", "created": 1526093278, "last_modified": 1717900406}, "last_reply_by": "youx", "last_touched": 1726995088, "title": "固定宽带 按流量计费 最公平", "url": "https://www.v2ex.com/t/1074762", "created": 1726971333, "deleted": 0, "content": "固定宽带 按流量计费 最公平\r\n\r\n下行\r\n100M 每 TB  5 元，结转 1 个月\r\n300M 每 TB 10 元，结转 1 个月\r\n500M 每 TB 15 元，结转 1 个月\r\n1G 每 TB 20 元，结转 1 个月\r\n2G 每 TB 30 元，结转 2 个月\r\n3G 每 TB 40 元，结转 3 个月\r\n4G 每 TB 50 元，结转 4 个月\r\n5G 每 TB 60 元，结转 5 个月\r\n\r\n上行\r\n 10M 每 TB  5 元，结转 1 个月\r\n 30M 每 TB 10 元，结转 1 个月\r\n 50M 每 TB 15 元，结转 1 个月\r\n100M 每 TB 20 元，结转 1 个月\r\n200M 每 TB 30 元，结转 2 个月\r\n300M 每 TB 40 元，结转 3 个月\r\n400M 每 TB 50 元，结转 4 个月\r\n500M 每 TB 60 元，结转 5 个月", "content_rendered": "固定宽带 按流量计费 最公平<br /><br />下行<br />100M 每 TB  5 元，结转 1 个月<br />300M 每 TB 10 元，结转 1 个月<br />500M 每 TB 15 元，结转 1 个月<br />1G 每 TB 20 元，结转 1 个月<br />2G 每 TB 30 元，结转 2 个月<br />3G 每 TB 40 元，结转 3 个月<br />4G 每 TB 50 元，结转 4 个月<br />5G 每 TB 60 元，结转 5 个月<br /><br />上行<br /> 10M 每 TB  5 元，结转 1 个月<br /> 30M 每 TB 10 元，结转 1 个月<br /> 50M 每 TB 15 元，结转 1 个月<br />100M 每 TB 20 元，结转 1 个月<br />200M 每 TB 30 元，结转 2 个月<br />300M 每 TB 40 元，结转 3 个月<br />400M 每 TB 50 元，结转 4 个月<br />500M 每 TB 60 元，结转 5 个月", "last_modified": 1726971333, "replies": 63, "id": 1074762}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/58c5/4802/1049_large.png?m=1633342159", "name": "cloudflare", "avatar_normal": "https://cdn.v2ex.com/navatar/58c5/4802/1049_normal.png?m=1633342159", "title": "Cloudflare", "url": "https://www.v2ex.com/go/cloudflare", "topics": 282, "footer": "", "header": "Cloudflare 提供全球 CDN 和 Anti-DDoS 服务。", "title_alternative": "Cloudflare", "avatar_mini": "https://cdn.v2ex.com/navatar/58c5/4802/1049_mini.png?m=1633342159", "stars": 393, "aliases": [], "root": false, "id": 1049, "parent_node_name": "cloud"}, "member": {"id": 509243, "username": "Lotii", "url": "https://www.v2ex.com/u/Lotii", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/4c15/2422/509243_mini.png?m=1726359379", "avatar_normal": "https://cdn.v2ex.com/avatar/4c15/2422/509243_normal.png?m=1726359379", "avatar_large": "https://cdn.v2ex.com/avatar/4c15/2422/509243_large.png?m=1726359379", "avatar_xlarge": "https://cdn.v2ex.com/avatar/4c15/2422/509243_xlarge.png?m=1726359379", "avatar_xxlarge": "https://cdn.v2ex.com/avatar/4c15/2422/509243_xlarge.png?m=1726359379", "created": 1600785286, "last_modified": 1726359379}, "last_reply_by": "ppxppx", "last_touched": 1726995792, "title": "1.1.1.1 带着新协议回归了， WARP 又复活了", "url": "https://www.v2ex.com/t/1074753", "created": 1726965759, "deleted": 0, "content": "更新了 1.1.1.1 版本，新协议可以连上 WARP 了\r\n\r\n在设置-高级-连接选项-Tunnel Protocol 里选择 MASQUE 即可\r\n\r\n测试了下 WARP 可以直连了，先感谢一下大善人\r\n\r\n但是，能用多久？", "content_rendered": "更新了 1.1.1.1 版本，新协议可以连上 WARP 了<br /><br />在设置-高级-连接选项-Tunnel Protocol 里选择 MASQUE 即可<br /><br />测试了下 WARP 可以直连了，先感谢一下大善人<br /><br />但是，能用多久？", "last_modified": 1726965759, "replies": 44, "id": 1074753}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/6353/8fe6/519_large.png?m=1595507885", "name": "ideas", "avatar_normal": "https://cdn.v2ex.com/navatar/6353/8fe6/519_normal.png?m=1595507885", "title": "奇思妙想", "url": "https://www.v2ex.com/go/ideas", "topics": 6120, "footer": "", "header": "让你的创意在这里自由流动吧。", "title_alternative": "Ideas", "avatar_mini": "https://cdn.v2ex.com/navatar/6353/8fe6/519_mini.png?m=1595507885", "stars": 3064, "aliases": [], "root": false, "id": 519, "parent_node_name": "v2ex"}, "member": {"id": 345958, "username": "bobguo", "url": "https://www.v2ex.com/u/bobguo", "website": "", "twitter": "", "psn": "", "github": "", "btc": "", "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/49ed/4afd/345958_mini.png?m=1726990663", "avatar_normal": "https://cdn.v2ex.com/avatar/49ed/4afd/345958_normal.png?m=1726990663", "avatar_large": "https://cdn.v2ex.com/avatar/49ed/4afd/345958_large.png?m=1726990663", "avatar_xlarge": "https://cdn.v2ex.com/avatar/49ed/4afd/345958_xlarge.png?m=1726990663", "avatar_xxlarge": "https://cdn.v2ex.com/avatar/49ed/4afd/345958_xlarge.png?m=1726990663", "avatar_xxxlarge": "https://cdn.v2ex.com/avatar/49ed/4afd/345958_xlarge.png?m=1726990663", "created": 1535684913, "last_modified": 1726990663}, "last_reply_by": "bobguo", "last_touched": 1726995525, "title": "电传动自行车的可行性", "url": "https://www.v2ex.com/t/1074808", "created": 1726991306, "deleted": 0, "content": "国内电动车普及率越来越高，并且自行车这块没太大的市场，来来去去就那么些配件有点无聊，萌生了电传动自行车的想法\r\n\r\n1. 这台自行车没有电池，顶多有一些大电容作为缓冲\r\n\r\n2. 这台自行车脚踏和前后轮是解耦的，只是驱动一个发电机\r\n\r\n3. 发电机通过电线驱动前轮或者后轮的轮毂电机\r\n\r\n这样就完全绕开了链条传动和外置变速器，车速、扭矩 和 踏频 完全解耦，脚踏只负责功率\r\n\r\n这样基本用的都是电动车的配件，也能充分享受电动车市场的规模效应\r\n\r\n这样的车，可以通过电机的控制逻辑，做一个低速高扭，高速低扭的线性逻辑，实现电子化无极变速的 CVT 效果\r\n\r\n目前和一些人讨论，主要是脚踏发电效率民用的可能只有 80%，轮毂电机低速效率也可能只有 80%，这套基于电的传动系统最终轮端效率只有 60%\r\n\r\n但是是否这个效率可以为这样的场景做一些定制化设计提升？由于不是这个专业的，也不知道去哪找人聊，发到这里蹲蹲专业人士的建议", "content_rendered": "<p>国内电动车普及率越来越高，并且自行车这块没太大的市场，来来去去就那么些配件有点无聊，萌生了电传动自行车的想法</p>\n<ol>\n<li>\n<p>这台自行车没有电池，顶多有一些大电容作为缓冲</p>\n</li>\n<li>\n<p>这台自行车脚踏和前后轮是解耦的，只是驱动一个发电机</p>\n</li>\n<li>\n<p>发电机通过电线驱动前轮或者后轮的轮毂电机</p>\n</li>\n</ol>\n<p>这样就完全绕开了链条传动和外置变速器，车速、扭矩 和 踏频 完全解耦，脚踏只负责功率</p>\n<p>这样基本用的都是电动车的配件，也能充分享受电动车市场的规模效应</p>\n<p>这样的车，可以通过电机的控制逻辑，做一个低速高扭，高速低扭的线性逻辑，实现电子化无极变速的 CVT 效果</p>\n<p>目前和一些人讨论，主要是脚踏发电效率民用的可能只有 80%，轮毂电机低速效率也可能只有 80%，这套基于电的传动系统最终轮端效率只有 60%</p>\n<p>但是是否这个效率可以为这样的场景做一些定制化设计提升？由于不是这个专业的，也不知道去哪找人聊，发到这里蹲蹲专业人士的建议</p>\n", "last_modified": 1726991306, "replies": 31, "id": 1074808}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1700771269", "name": "programmer", "avatar_normal": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1700771269", "title": "程序员", "url": "https://www.v2ex.com/go/programmer", "topics": 64225, "footer": "", "header": "While code monkeys are not eating bananas, they're coding.", "title_alternative": "Programmer", "avatar_mini": "https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1700771269", "stars": 9085, "aliases": [], "root": false, "id": 300, "parent_node_name": "computer"}, "member": {"id": 680370, "username": "THEcattail", "url": "https://www.v2ex.com/u/THEcattail", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/fffca0ff7866daaa91d1563f946e26e1?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/fffca0ff7866daaa91d1563f946e26e1?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/fffca0ff7866daaa91d1563f946e26e1?s=73&d=retro", "created": 1710428525, "last_modified": 1710430792}, "last_reply_by": "Admstor", "last_touched": 1726987316, "title": "小型工作室存储选型的一点思考和疑问", "url": "https://www.v2ex.com/t/1074658", "created": 1726913488, "deleted": 0, "content": "有什么适合长期存储热数据（比如代码仓库、数据库、元数据之类的）的生产环境吗\r\n\r\n本地存储心里放心，但是需要大量运维精力，也缺乏应对极端故障的能力，考虑数据和服务最好在一个网络里就还要考虑拉商宽的成本，感觉有点得不偿失\r\n\r\n云托管是看到最多建议的方案，但是也比较担心运维和云平台耦合度高，未来有迁移需求比较麻烦的问题，另外这也是唯一一个成本会和读写次数/流量挂钩的方案\r\n\r\n还有一个个人还有点心仪的方案是租 idc 的服务器托管，但是看了一圈好像没有看到那种公认知名稳定的大品牌，数据安全系数是个未知数，对准备备份迁移的要求反而会更高", "content_rendered": "<p>有什么适合长期存储热数据（比如代码仓库、数据库、元数据之类的）的生产环境吗</p>\n<p>本地存储心里放心，但是需要大量运维精力，也缺乏应对极端故障的能力，考虑数据和服务最好在一个网络里就还要考虑拉商宽的成本，感觉有点得不偿失</p>\n<p>云托管是看到最多建议的方案，但是也比较担心运维和云平台耦合度高，未来有迁移需求比较麻烦的问题，另外这也是唯一一个成本会和读写次数/流量挂钩的方案</p>\n<p>还有一个个人还有点心仪的方案是租 idc 的服务器托管，但是看了一圈好像没有看到那种公认知名稳定的大品牌，数据安全系数是个未知数，对准备备份迁移的要求反而会更高</p>\n", "last_modified": 1726913509, "replies": 28, "id": 1074658}, {"node": {"avatar_large": "/static/img/node_default_large.png", "name": "immigration", "avatar_normal": "/static/img/node_default_normal.png", "title": "移民", "url": "https://www.v2ex.com/go/immigration", "topics": 112, "footer": "", "header": "", "title_alternative": "Immigration", "avatar_mini": "/static/img/node_default_mini.png", "stars": 602, "aliases": [], "root": false, "id": 970, "parent_node_name": "life"}, "member": {"id": 636539, "username": "zanderzhan", "url": "https://www.v2ex.com/u/zanderzhan", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/e8b2d1b1040dbe358c9a48634ac74b89?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/e8b2d1b1040dbe358c9a48634ac74b89?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/e8b2d1b1040dbe358c9a48634ac74b89?s=73&d=retro", "created": 1688090174, "last_modified": 1688090174}, "last_reply_by": "secretlowland", "last_touched": 1726995930, "title": "新西兰 IT 工作行情如何，留学移民成功率大吗？", "url": "https://www.v2ex.com/t/1074768", "created": 1726973494, "deleted": 0, "content": "打着移民的目的，申请了新西兰的 IT 硕士，怀卡托大学已经下了 offer ，学费巨贵，只学费这一 part 就要接近 30w 人民币。\r\n我已经毕业 8 年了，专业网络工程，想着如果按照移民规划，毕业后找到认证雇主工作，满一年可以申请 pr 。缺点是太贵，并且都说那边工作不好找。\r\n所以现在有点犹疑，大佬们见多识广，觉得这一条路可走吗？", "content_rendered": "<p>打着移民的目的，申请了新西兰的 IT 硕士，怀卡托大学已经下了 offer ，学费巨贵，只学费这一 part 就要接近 30w 人民币。\n我已经毕业 8 年了，专业网络工程，想着如果按照移民规划，毕业后找到认证雇主工作，满一年可以申请 pr 。缺点是太贵，并且都说那边工作不好找。\n所以现在有点犹疑，大佬们见多识广，觉得这一条路可走吗？</p>\n", "last_modified": 1726973494, "replies": 24, "id": 1074768}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_large.png?m=1695370146", "name": "career", "avatar_normal": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_normal.png?m=1695370146", "title": "职场话题", "url": "https://www.v2ex.com/go/career", "topics": 18146, "footer": "", "header": "这里，我们聊聊那些工作中遇到的开心和不开心的事。", "title_alternative": "Career", "avatar_mini": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_mini.png?m=1695370146", "stars": 3238, "aliases": [], "root": false, "id": 770, "parent_node_name": "work"}, "member": {"id": 637707, "username": "jiangmuAlvin", "url": "https://www.v2ex.com/u/jiangmuAlvin", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/avatar/dd7e/9941/637707_mini.png?m=1688892385", "avatar_normal": "https://cdn.v2ex.com/avatar/dd7e/9941/637707_normal.png?m=1688892385", "avatar_large": "https://cdn.v2ex.com/avatar/dd7e/9941/637707_large.png?m=1688892385", "avatar_xlarge": "https://cdn.v2ex.com/avatar/dd7e/9941/637707_xlarge.png?m=1688892385", "avatar_xxlarge": "https://cdn.v2ex.com/avatar/dd7e/9941/637707_xlarge.png?m=1688892385", "avatar_xxxlarge": "https://cdn.v2ex.com/avatar/dd7e/9941/637707_xlarge.png?m=1688892385", "created": 1688891874, "last_modified": 1688892385}, "last_reply_by": "mezi04", "last_touched": 1726965902, "title": "马来西亚吉隆坡面试通过了，要不要去", "url": "https://www.v2ex.com/t/1074675", "created": 1726918623, "deleted": 0, "content": "最近在 boss 求职到泰国吉隆坡蕉赖区的上海某个公司的海外项目，他们那边要我去那边上班，现在求助各位大佬，怎么样查一下是不是正规公司。而且怎么样判断能不能去，之前一直在国内公司上班，不懂这方面的解决手段，还有他注册地址在广州越秀区，有点稀里糊涂的，求助各位大佬分析下，麻烦了", "content_rendered": "<p>最近在 boss 求职到泰国吉隆坡蕉赖区的上海某个公司的海外项目，他们那边要我去那边上班，现在求助各位大佬，怎么样查一下是不是正规公司。而且怎么样判断能不能去，之前一直在国内公司上班，不懂这方面的解决手段，还有他注册地址在广州越秀区，有点稀里糊涂的，求助各位大佬分析下，麻烦了</p>\n", "last_modified": 1726919723, "replies": 23, "id": 1074675}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_large.png?m=1691642161", "name": "bb", "avatar_normal": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_normal.png?m=1691642161", "title": "宽带症候群", "url": "https://www.v2ex.com/go/bb", "topics": 16221, "footer": "", "header": "网速很重要。比快更快。", "title_alternative": "Broadband Symptom Complex", "avatar_mini": "https://cdn.v2ex.com/navatar/a3c6/5c29/108_mini.png?m=1691642161", "stars": 7549, "aliases": [], "root": false, "id": 108, "parent_node_name": "geek"}, "member": {"id": 645343, "username": "dhuzbb", "url": "https://www.v2ex.com/u/dhuzbb", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/2db25ba9c4c1bf0405030b34cab72219?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/2db25ba9c4c1bf0405030b34cab72219?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/2db25ba9c4c1bf0405030b34cab72219?s=73&d=retro", "created": 1692929299, "last_modified": 1692929299}, "last_reply_by": "EdmondGUO", "last_touched": 1726995545, "title": "局域网内优雅的访问家庭内网服务", "url": "https://www.v2ex.com/t/1074771", "created": 1726973851, "deleted": 0, "content": "# 局域网内优雅的访问家庭内网服务\r\n\r\n\r\n## 前情提要\r\n\r\n[《低成本家庭万兆内网搭建指北》]( https://www.v2ex.com/t/1057803)  \r\n[《个人家庭网络布局分享》]( https://www.v2ex.com/t/1074592)  \r\n[《家庭内网服务分享》]( https://www.v2ex.com/t/1074688)  \r\n\r\n## 缘起\r\n\r\n自从有了 NAS ，烦恼似乎开始变得多了。\r\n\r\n当家庭部署的内网服务多了之后，例如笔记、DNS 、影音、Wiki 等等各种各样的服务，记忆和管理这些内网服务就成了一个问题。\r\n\r\n直接在浏览器中输入内网服务的 IP:端口号，又面临记忆的负担，似乎不是一个优雅的方案。\r\n\r\n如何在局域网优雅的访问这些内网服务，减少心智负担成了一个不得不解决的问题。\r\n\r\n+ 恰好域名可以用来替代 IP+端口号，方便记忆。\r\n+ 服务较多，个人服务导航页可以方便的集中化管理。\r\n\r\n2 者结合可以完美的解决上面的问题，下面开始详细描述如何实现上面的需求。\r\n\r\n\r\n## 子域名规划\r\n\r\n根据内网服务的实际用途规划子域名如下，大家可以根据自己的实际情况自由发挥。\r\n\r\n|  域名 | 后端服务 | 说明 |\r\n| --- | --- | --- |\r\n| https://binhome.cn | http://192.168.0.4:3002 | 极空间 Docker 部署的 Sun-Panel 导航页服务 |\r\n| https://note.binhome.cn | http://192.168.0.4:28080 | 极空间 Docker 部署的笔记服务 Flatnotes |\r\n| https://book.binhome.cn | http://192.168.0.4:8083 | 极空间 Docker 部署的阅读服务 Calibre-Web |\r\n| https://dns.binhome.cn | http://192.168.0.10:80 | PVE CT 容器部署的 DNS 服务 Adguard Home |\r\n| https://git.binhome.cn | http://192.168.0.88:80 | PVE CT 容器部署的 GitLab 服务 |\r\n| 以下省略 20 条 | 以下省略 20 条 | 以下省略 20 条 |\r\n\r\n想要实现的需求是：在局域网内部浏览器中输入 `https://note.binhome.cn` 这样的子域名，就能访问到局域网内部部署的笔记服务 `http://192.168.0.4:28080`。\r\n\r\n## 反向代理\r\n\r\n上面子域名规划中的不同子域名映射到不同的后端 IP:端口，其实就是反向代理 Nginx 等服务需要做的事情。\r\n\r\n**由于 Nginx 需要绑定 80 和 443 端口，推荐使用 PVE 的 CT 容器来部署 Nginx Proxy Manager 。**\r\n\r\nNginx Proxy Manager 非常的简单易用。无需编写复杂的 Nginx 配置就可以设置域名到后端服务的映射关系，非常适合小白用户。\r\n\r\n![NPM]( https://img.binhome.cn/access_local_service/npm.png)\r\n\r\n除了反向代理之外，NPM 还支持泛域名 SSL 证书的申请，简单易操作。前提是事先购买域名并设置好 DNS 解析到主路由的公网 IP ，如果不介意浏览器中的红色安全提醒，也可以忽略。\r\n\r\n![NPM SSL]( https://img.binhome.cn/home_service/npm_ssl.png)\r\n\r\n\r\n## 内网 DNS 重写\r\n\r\n完成了反向代理之后，还需要做的一步操作就是将所有 `*.binhome.cn` 的请求都指向 Nginx Proxy Manager 的机器 IP （假如是 192.168.0.8 ）。\r\n\r\n修改主路由或旁路由的 Hosts 文件可以简单的达到目的：\r\n\r\n```\r\n192.168.0.8 binhome.cn\r\n192.168.0.8 note.binhome.cn\r\n192.168.0.8 book.binhome.cn\r\n192.168.0.8 dns.binhome.cn\r\n192.168.0.8 git.binhome.cn\r\n以下省略 20 条...\r\n```\r\n\r\n上面的做法不是不行，但还是太繁琐了，需要 一条一条的添加，实现上不够优雅。能不能只需要 1 条记录就实现呢？类似下面这种：\r\n```\r\n192.168.0.8 *.binhome.cn\r\n```\r\n\r\nDNS 重写可以完美实现上面的诉求。\r\n\r\nAdGuard Home 这款 DNS 服务支持泛域名重写功能。\r\n\r\n![DNS Rewrite]( https://img.binhome.cn/home_service/dns_rewrite.png)\r\n\r\n如果使用的是 OpenWRT 内置的 DNS 服务 Dnsmasq ，也能非常简单的设置泛域名重写功能。\r\n\r\n```java\r\n# 编辑 dnsmasq 的配置文件\r\nvim /etc/dnsmasq.conf\r\n\r\n# 在最后添加一行以下配置\r\naddress = /binhome.cn/192.168.0.8\r\n\r\n# 重启 dnsmasq 服务\r\nservice dnsmasq restart\r\n```\r\n\r\n完成了以上设置，这样在局域网环境下，所有访问 `*.binhome.cn` 的请求都会解析到内网的 NPM 机器 192.168.0.8 上。\r\n\r\n\r\n## 原理解析\r\n\r\n下面针对上面所讲的内容进行原理解析：\r\n\r\n```java\r\nhttps://note.binhome.cn -> 192.168.0.2(内网 DNS 服务器) -> 192.168.0.8(NPM) -> http://192.168.0.4:28080\r\n```\r\n\r\n局域网环境下整个访问流程如下:\r\n\r\n+ 访问 `https://note.binhome.cn` 时，会先请求内网的 DNS 服务器 (192.168.0.2) 进行内网 DNS 解析\r\n+ 内网 DNS 服务器会将所有 `*.binhome.cn` 的请求都指向 NPM 的机器 IP （ 192.168.0.8 ）\r\n+ NPM 相当于 Nginx ，会在内部将请求根据域名匹配到真正的后端服务 `http://192.168.0.4:28080`\r\n\r\n由此，就完成了请求不同的子域名，实际请求的是不同后端服务的需求。\r\n\r\n## 个人服务导航页\r\n\r\n集中化管理个人内网服务就需要导航页服务来实现了，推荐使用 Sun-Panel 。\r\n\r\n之前的文章有介绍过 Sun-Panel 是一个漂亮的服务器、NAS 导航面板、Homepage 、浏览器首页。\r\n\r\n```curl\r\nGithub: https://github.com/hslr-s/sun-panel\r\n```\r\n\r\n部署效果如下：\r\n\r\n![sunpanel]( https://img.binhome.cn/home_service/sunpanel.png)\r\n\r\n类似比较出名的个人导航页还有 Heimdall 。( https://github.com/linuxserver/Heimdall) \r\n\r\nSun-Panel 支持局域网和互联网 2 种模式，UI 更加简洁美观，个人更加倾向于使用 Sun-Panel 。\r\n\r\n\r\n## 后续\r\n\r\n完成上述操作之后，在局域网环境下，既可以直接在浏览器中输入 `https://note.binhome.cn` 这样的子域名来访问家庭内网服务。也可以设置浏览器的主页为个人导航页服务`https://binhome.cn`，一键点击访问对应的内网服务。\r\n\r\n解决完了内网环境下的访问之后，如何在外优雅安全的访问局域网内的服务呢？\r\n\r\n详见后续系列文章：《在外优雅访问家庭内网服务的姿势》。", "content_rendered": "<h1>局域网内优雅的访问家庭内网服务</h1>\n<h2>前情提要</h2>\n<p><a href=\"https://www.v2ex.com/t/1057803\" rel=\"nofollow\">《低成本家庭万兆内网搭建指北》</a><br/>\n<a href=\"https://www.v2ex.com/t/1074592\" rel=\"nofollow\">《个人家庭网络布局分享》</a><br/>\n<a href=\"https://www.v2ex.com/t/1074688\" rel=\"nofollow\">《家庭内网服务分享》</a> </p>\n<h2>缘起</h2>\n<p>自从有了 NAS ，烦恼似乎开始变得多了。</p>\n<p>当家庭部署的内网服务多了之后，例如笔记、DNS 、影音、Wiki 等等各种各样的服务，记忆和管理这些内网服务就成了一个问题。</p>\n<p>直接在浏览器中输入内网服务的 IP:端口号，又面临记忆的负担，似乎不是一个优雅的方案。</p>\n<p>如何在局域网优雅的访问这些内网服务，减少心智负担成了一个不得不解决的问题。</p>\n<ul>\n<li>恰好域名可以用来替代 IP+端口号，方便记忆。</li>\n<li>服务较多，个人服务导航页可以方便的集中化管理。</li>\n</ul>\n<p>2 者结合可以完美的解决上面的问题，下面开始详细描述如何实现上面的需求。</p>\n<h2>子域名规划</h2>\n<p>根据内网服务的实际用途规划子域名如下，大家可以根据自己的实际情况自由发挥。</p>\n<table>\n<thead>\n<tr>\n<th>域名</th>\n<th>后端服务</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://binhome.cn\" rel=\"nofollow\">https://binhome.cn</a></td>\n<td><a href=\"http://192.168.0.4:3002\" rel=\"nofollow\">http://192.168.0.4:3002</a></td>\n<td>极空间 Docker 部署的 Sun-Panel 导航页服务</td>\n</tr>\n<tr>\n<td><a href=\"https://note.binhome.cn\" rel=\"nofollow\">https://note.binhome.cn</a></td>\n<td><a href=\"http://192.168.0.4:28080\" rel=\"nofollow\">http://192.168.0.4:28080</a></td>\n<td>极空间 Docker 部署的笔记服务 Flatnotes</td>\n</tr>\n<tr>\n<td><a href=\"https://book.binhome.cn\" rel=\"nofollow\">https://book.binhome.cn</a></td>\n<td><a href=\"http://192.168.0.4:8083\" rel=\"nofollow\">http://192.168.0.4:8083</a></td>\n<td>极空间 Docker 部署的阅读服务 Calibre-Web</td>\n</tr>\n<tr>\n<td><a href=\"https://dns.binhome.cn\" rel=\"nofollow\">https://dns.binhome.cn</a></td>\n<td><a href=\"http://192.168.0.10:80\" rel=\"nofollow\">http://192.168.0.10:80</a></td>\n<td>PVE CT 容器部署的 DNS 服务 Adguard Home</td>\n</tr>\n<tr>\n<td><a href=\"https://git.binhome.cn\" rel=\"nofollow\">https://git.binhome.cn</a></td>\n<td><a href=\"http://192.168.0.88:80\" rel=\"nofollow\">http://192.168.0.88:80</a></td>\n<td>PVE CT 容器部署的 GitLab 服务</td>\n</tr>\n<tr>\n<td>以下省略 20 条</td>\n<td>以下省略 20 条</td>\n<td>以下省略 20 条</td>\n</tr>\n</tbody></table><p>想要实现的需求是：在局域网内部浏览器中输入 <code><a href=\"https://note.binhome.cn\" rel=\"nofollow\">https://note.binhome.cn</a></code> 这样的子域名，就能访问到局域网内部部署的笔记服务 <code>http://192.168.0.4:28080</code>。</p>\n<h2>反向代理</h2>\n<p>上面子域名规划中的不同子域名映射到不同的后端 IP:端口，其实就是反向代理 Nginx 等服务需要做的事情。</p>\n<p><strong>由于 Nginx 需要绑定 80 和 443 端口，推荐使用 PVE 的 CT 容器来部署 Nginx Proxy Manager 。</strong></p>\n<p>Nginx Proxy Manager 非常的简单易用。无需编写复杂的 Nginx 配置就可以设置域名到后端服务的映射关系，非常适合小白用户。</p>\n<p><img alt=\"NPM\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.binhome.cn/access_local_service/npm.png\"/></p>\n<p>除了反向代理之外，NPM 还支持泛域名 SSL 证书的申请，简单易操作。前提是事先购买域名并设置好 DNS 解析到主路由的公网 IP ，如果不介意浏览器中的红色安全提醒，也可以忽略。</p>\n<p><img alt=\"NPM SSL\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.binhome.cn/home_service/npm_ssl.png\"/></p>\n<h2>内网 DNS 重写</h2>\n<p>完成了反向代理之后，还需要做的一步操作就是将所有 <code>*.binhome.cn</code> 的请求都指向 Nginx Proxy Manager 的机器 IP （假如是 192.168.0.8 ）。</p>\n<p>修改主路由或旁路由的 Hosts 文件可以简单的达到目的：</p>\n<pre><code>192.168.0.8 binhome.cn\n192.168.0.8 note.binhome.cn\n192.168.0.8 book.binhome.cn\n192.168.0.8 dns.binhome.cn\n192.168.0.8 git.binhome.cn\n以下省略 20 条...\n</code></pre>\n<p>上面的做法不是不行，但还是太繁琐了，需要 一条一条的添加，实现上不够优雅。能不能只需要 1 条记录就实现呢？类似下面这种：</p>\n<pre><code>192.168.0.8 *.binhome.cn\n</code></pre>\n<p>DNS 重写可以完美实现上面的诉求。</p>\n<p>AdGuard Home 这款 DNS 服务支持泛域名重写功能。</p>\n<p><img alt=\"DNS Rewrite\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.binhome.cn/home_service/dns_rewrite.png\"/></p>\n<p>如果使用的是 OpenWRT 内置的 DNS 服务 Dnsmasq ，也能非常简单的设置泛域名重写功能。</p>\n<pre><code class=\"language-java\"># 编辑 dnsmasq 的配置文件\nvim /etc/dnsmasq.conf\n\n# 在最后添加一行以下配置\naddress = /binhome.cn/192.168.0.8\n\n# 重启 dnsmasq 服务\nservice dnsmasq restart\n</code></pre>\n<p>完成了以上设置，这样在局域网环境下，所有访问 <code>*.binhome.cn</code> 的请求都会解析到内网的 NPM 机器 192.168.0.8 上。</p>\n<h2>原理解析</h2>\n<p>下面针对上面所讲的内容进行原理解析：</p>\n<pre><code class=\"language-java\">https://note.binhome.cn -&gt; 192.168.0.2(内网 DNS 服务器) -&gt; 192.168.0.8(NPM) -&gt; http://192.168.0.4:28080\n</code></pre>\n<p>局域网环境下整个访问流程如下:</p>\n<ul>\n<li>访问 <code><a href=\"https://note.binhome.cn\" rel=\"nofollow\">https://note.binhome.cn</a></code> 时，会先请求内网的 DNS 服务器 (192.168.0.2) 进行内网 DNS 解析</li>\n<li>内网 DNS 服务器会将所有 <code>*.binhome.cn</code> 的请求都指向 NPM 的机器 IP （ 192.168.0.8 ）</li>\n<li>NPM 相当于 Nginx ，会在内部将请求根据域名匹配到真正的后端服务 <code>http://192.168.0.4:28080</code></li>\n</ul>\n<p>由此，就完成了请求不同的子域名，实际请求的是不同后端服务的需求。</p>\n<h2>个人服务导航页</h2>\n<p>集中化管理个人内网服务就需要导航页服务来实现了，推荐使用 Sun-Panel 。</p>\n<p>之前的文章有介绍过 Sun-Panel 是一个漂亮的服务器、NAS 导航面板、Homepage 、浏览器首页。</p>\n<pre><code class=\"language-curl\">Github: https://github.com/hslr-s/sun-panel\n</code></pre>\n<p>部署效果如下：</p>\n<p><img alt=\"sunpanel\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.binhome.cn/home_service/sunpanel.png\"/></p>\n<p>类似比较出名的个人导航页还有 Heimdall 。( <a href=\"https://github.com/linuxserver/Heimdall\" rel=\"nofollow\">https://github.com/linuxserver/Heimdall</a>) </p>\n<p>Sun-Panel 支持局域网和互联网 2 种模式，UI 更加简洁美观，个人更加倾向于使用 Sun-Panel 。</p>\n<h2>后续</h2>\n<p>完成上述操作之后，在局域网环境下，既可以直接在浏览器中输入 <code><a href=\"https://note.binhome.cn\" rel=\"nofollow\">https://note.binhome.cn</a></code> 这样的子域名来访问家庭内网服务。也可以设置浏览器的主页为个人导航页服务<code><a href=\"https://binhome.cn\" rel=\"nofollow\">https://binhome.cn</a></code>，一键点击访问对应的内网服务。</p>\n<p>解决完了内网环境下的访问之后，如何在外优雅安全的访问局域网内的服务呢？</p>\n<p>详见后续系列文章：《在外优雅访问家庭内网服务的姿势》。</p>\n", "last_modified": 1726973851, "replies": 22, "id": 1074771}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_large.png?m=1695370146", "name": "career", "avatar_normal": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_normal.png?m=1695370146", "title": "职场话题", "url": "https://www.v2ex.com/go/career", "topics": 18146, "footer": "", "header": "这里，我们聊聊那些工作中遇到的开心和不开心的事。", "title_alternative": "Career", "avatar_mini": "https://cdn.v2ex.com/navatar/4ea0/6fbc/770_mini.png?m=1695370146", "stars": 3238, "aliases": [], "root": false, "id": 770, "parent_node_name": "work"}, "member": {"id": 572019, "username": "Dottt", "url": "https://www.v2ex.com/u/Dottt", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "", "avatar_mini": "https://cdn.v2ex.com/gravatar/ffa9f4a74794c5089694f2e7bdaa4618?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/ffa9f4a74794c5089694f2e7bdaa4618?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/ffa9f4a74794c5089694f2e7bdaa4618?s=73&d=retro", "created": 1644234775, "last_modified": 1644234775}, "last_reply_by": "Znemo", "last_touched": 1726994934, "title": "年龄 35， gap 一年，二本，没在大厂待过，在深圳还能找得到开发的工作吗？", "url": "https://www.v2ex.com/t/1074780", "created": 1726977381, "deleted": 0, "content": "", "content_rendered": "", "last_modified": 1726978010, "replies": 22, "id": 1074780}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_large.png?m=1630643913", "name": "apple", "avatar_normal": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_normal.png?m=1630643913", "title": "Apple", "url": "https://www.v2ex.com/go/apple", "topics": 26580, "footer": "", "header": "设计了 <a href=\"/go/watch\">Apple Watch</a>，<a href=\"/go/ipad\">iPad</a>，<a href=\"/go/iphone\">iPhone</a>，<a href=\"/go/imac\">iMac</a> 及 <a href=\"/go/mbp\">MacBook Pro</a> 等电子产品的美国公司。", "title_alternative": "Apple", "avatar_mini": "https://cdn.v2ex.com/navatar/6cdd/60ea/184_mini.png?m=1630643913", "stars": 3013, "aliases": [], "root": false, "id": 184, "parent_node_name": "hardware"}, "member": {"id": 288786, "username": "enjoy1224", "url": "https://www.v2ex.com/u/enjoy1224", "website": null, "twitter": null, "psn": null, "github": null, "btc": null, "location": null, "tagline": null, "bio": null, "avatar_mini": "https://cdn.v2ex.com/gravatar/e574e733dc9ff0028843fccda4f68357?s=24&d=retro", "avatar_normal": "https://cdn.v2ex.com/gravatar/e574e733dc9ff0028843fccda4f68357?s=48&d=retro", "avatar_large": "https://cdn.v2ex.com/gravatar/e574e733dc9ff0028843fccda4f68357?s=73&d=retro", "created": 1517479552, "last_modified": 1726913549}, "last_reply_by": "dingwen07", "last_touched": 1726941986, "title": "哪些国家的 App Store 支持 Apple Pay 直接付款？", "url": "https://www.v2ex.com/t/1074659", "created": 1726913764, "deleted": 0, "content": "最近一直切区下载软件，结果封号了，打给台湾妹子说无法解决，态度倒是很好。\r\n\r\n切区过程中偶尔发现有些国家支持用 Apple pay 直接购买 app\r\n\r\n所以就想问下到底有哪些国家支持，有无支持文档看，打算重新注册了\r\n\r\n所有 app 都要重新下载，付费的永久订阅都没了，有点伤\r\n\r\n讨论范围仅限苹果商店", "content_rendered": "<p>最近一直切区下载软件，结果封号了，打给台湾妹子说无法解决，态度倒是很好。</p>\n<p>切区过程中偶尔发现有些国家支持用 Apple pay 直接购买 app</p>\n<p>所以就想问下到底有哪些国家支持，有无支持文档看，打算重新注册了</p>\n<p>所有 app 都要重新下载，付费的永久订阅都没了，有点伤</p>\n<p>讨论范围仅限苹果商店</p>\n", "last_modified": 1726913840, "replies": 20, "id": 1074659}, {"node": {"avatar_large": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340", "name": "qna", "avatar_normal": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340", "title": "问与答", "url": "https://www.v2ex.com/go/qna", "topics": 223278, "footer": "", "header": "一个更好的世界需要你持续地提出好问题。", "title_alternative": "Questions and Answers", "avatar_mini": "https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340", "stars": 4237, "aliases": [], "root": false, "id": 12, "parent_node_name": "v2ex"}, "member": {"id": 706477, "username": "XinPingQiHe", "url": "https://www.v2ex.com/u/XinPingQiHe", "website": "", "twitter": null, "psn": null, "github": null, "btc": null, "location": "", "tagline": "", "bio": "佛系码农，我心自由", "avatar_mini": "https://cdn.v2ex.com/avatar/e710/5906/706477_mini.png?m=1724141103", "avatar_normal": "https://cdn.v2ex.com/avatar/e710/5906/706477_normal.png?m=1724141103", "avatar_large": "https://cdn.v2ex.com/avatar/e710/5906/706477_large.png?m=1724141103", "avatar_xlarge": "https://cdn.v2ex.com/avatar/e710/5906/706477_xlarge.png?m=1724141103", "avatar_xxlarge": "https://cdn.v2ex.com/avatar/e710/5906/706477_xlarge.png?m=1724141103", "avatar_xxxlarge": "https://cdn.v2ex.com/avatar/e710/5906/706477_xlarge.png?m=1724141103", "created": 1724050334, "last_modified": 1724141103}, "last_reply_by": "RanShunliu", "last_touched": 1726949077, "title": "大学校门口的奇怪经历", "url": "https://www.v2ex.com/t/1074671", "created": 1726917502, "deleted": 0, "content": "前几天晚上 9 点半左右，天下着小雨，在某非常知名大学的西南侧小门口，恰巧里面走出来一位穿旗袍女生、中等身高，化着淡妆，在旗袍衬托下，有些优雅且高贵的形象，她直视的看着我，一种诡异的微笑，欲言又止的样子。。。\r\n我也不认识她，就转过头去了，\r\n于是，她明白我不是她要见的人，\r\n她又走向 10 米处的另外一人。（注：此时 这个侧门口 只有我们 3 个人）\r\n走到那人的身边，她没有直接说话，而是，在那人的身边，转过 90 度，侧面对着那人，拨打微信语音，然后看到他拿起手机接听，于是确认是他。很显然，她也是第一次见到他。\r\n两人并无说任何其他言语，男子略前一点点，女生跟着他，他们俩走向漆黑的街道另外一头。。。\r\n好奇，这是什么关系的呢（描述的为亲眼所见）", "content_rendered": "<p>前几天晚上 9 点半左右，天下着小雨，在某非常知名大学的西南侧小门口，恰巧里面走出来一位穿旗袍女生、中等身高，化着淡妆，在旗袍衬托下，有些优雅且高贵的形象，她直视的看着我，一种诡异的微笑，欲言又止的样子。。。\n我也不认识她，就转过头去了，\n于是，她明白我不是她要见的人，\n她又走向 10 米处的另外一人。（注：此时 这个侧门口 只有我们 3 个人）\n走到那人的身边，她没有直接说话，而是，在那人的身边，转过 90 度，侧面对着那人，拨打微信语音，然后看到他拿起手机接听，于是确认是他。很显然，她也是第一次见到他。\n两人并无说任何其他言语，男子略前一点点，女生跟着他，他们俩走向漆黑的街道另外一头。。。\n好奇，这是什么关系的呢（描述的为亲眼所见）</p>\n", "last_modified": 1726917502, "replies": 20, "id": 1074671}]